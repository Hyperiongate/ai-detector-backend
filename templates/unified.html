<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Content Authenticity Pro - Unified AI Detection Platform</title>
    
    <!-- Google Analytics 4 Integration -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-9CLSNV2S8Q"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-9CLSNV2S8Q');
        
        // Custom Analytics Events for Unified Page
        function trackUnifiedEvent(eventName, eventData = {}) {
            gtag('event', eventName, {
                event_category: 'Unified_Analysis',
                page_title: 'Content Authenticity Pro - Unified AI Detection Platform',
                ...eventData
            });
            
            // Backend analytics tracking
            if (typeof backendAnalytics !== 'undefined') {
                backendAnalytics.track(eventName, {
                    page: 'unified_analysis',
                    timestamp: new Date().toISOString(),
                    ...eventData
                });
            }
        }
        
        // Track page view
        gtag('event', 'page_view', {
            page_title: 'Content Authenticity Pro - Unified AI Detection Platform',
            page_location: window.location.href,
            content_group1: 'Unified Analysis'
        });
    </script>
    
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üîç</text></svg>">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/static/styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            line-height: 1.6;
            padding-top: 60px;
        }

        /* Beta Banner */
        .beta-banner {
            background: linear-gradient(45deg, #ff6b35, #f7931e);
            padding: 8px 0;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .beta-banner::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 3s infinite;
            transform: rotate(45deg);
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }

        .beta-content {
            position: relative;
            z-index: 2;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            color: white;
            font-weight: 600;
        }

        .beta-badge {
            background: rgba(255,255,255,0.2);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .beta-join-btn {
            background: rgba(255,255,255,0.2);
            border: 2px solid rgba(255,255,255,0.3);
            color: white;
            padding: 6px 16px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            text-decoration: none;
            font-size: 0.9rem;
        }

        .beta-join-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 10000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 5% auto;
            padding: 0;
            border-radius: 20px;
            width: 90%;
            max-width: 500px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .modal-header {
            background: rgba(255,255,255,0.1);
            padding: 2rem;
            text-align: center;
            border-bottom: 1px solid rgba(255,255,255,0.2);
        }

        .modal-header h2 {
            color: white;
            margin-bottom: 0.5rem;
            font-size: 1.8rem;
        }

        .modal-header p {
            color: rgba(255,255,255,0.8);
            font-size: 1rem;
        }

        .modal-body {
            padding: 2rem;
        }

        .modal-body .input-group {
            margin-bottom: 1rem;
        }

        .modal-body input {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.3);
            color: white;
            padding: 1rem;
            border-radius: 10px;
            width: 100%;
            font-size: 1rem;
        }

        .modal-body input::placeholder {
            color: rgba(255,255,255,0.6);
        }

        .modal-footer {
            padding: 1.5rem 2rem 2rem;
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
        }

        .btn-secondary {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 1px solid rgba(255,255,255,0.3);
            padding: 0.75rem 1.5rem;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-secondary:hover {
            background: rgba(255,255,255,0.3);
        }

        .close {
            position: absolute;
            right: 1rem;
            top: 1rem;
            color: rgba(255,255,255,0.8);
            font-size: 2rem;
            font-weight: bold;
            cursor: pointer;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .close:hover {
            background: rgba(255,255,255,0.2);
            color: white;
        }

        /* Container adjustments */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-bottom: 20px;
        }

        /* Navigation Bar */
        .nav-bar {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 15px;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .nav-links-secondary {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .nav-links-secondary a {
            color: white;
            text-decoration: none;
            padding: 10px 20px;
            border-radius: 12px;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .nav-links-secondary a:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .nav-links-secondary a.active {
            background: rgba(255, 255, 255, 0.3);
            font-weight: 600;
        }

        /* Tool Container */
        .tool-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .tool-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .tool-header h2 {
            font-size: 2.2rem;
            color: #4a5568;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .tool-header p {
            font-size: 1rem;
            color: #718096;
            margin-bottom: 15px;
        }

        /* Tools Section */
        .tools-employed {
            background: linear-gradient(145deg, #f8fafc, #ffffff);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            border: 2px solid rgba(102, 126, 234, 0.1);
            position: relative;
            overflow: hidden;
        }

        .tools-employed::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #10b981, #667eea, #764ba2);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.8; }
            50% { opacity: 1; }
        }

        .tools-title {
            font-weight: 700;
            color: #4a5568;
            margin-bottom: 20px;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .tools-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        .tool-item {
            background: rgba(102, 126, 234, 0.05);
            padding: 15px 20px;
            border-radius: 12px;
            border-left: 4px solid #667eea;
            font-size: 0.95rem;
            font-weight: 600;
            color: #4a5568;
            transition: all 0.3s ease;
        }

        .tool-item:hover {
            background: rgba(102, 126, 234, 0.1);
            transform: translateY(-2px);
        }

        .tool-item i {
            margin-right: 8px;
            color: #667eea;
        }

        /* Enhanced Progress Section with Rainbow Animation */
        .progress-section {
            margin-bottom: 30px;
            background: linear-gradient(145deg, #f8fafc, #ffffff);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            border: 2px solid rgba(102, 126, 234, 0.1);
            position: sticky;
            top: 80px;
            z-index: 100;
            overflow: hidden;
        }

        .progress-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #667eea, #10b981, #764ba2, #667eea);
            background-size: 300% 100%;
            animation: rainbow-flow 4s ease-in-out infinite;
        }

        @keyframes rainbow-flow {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .progress-title {
            font-weight: 700;
            color: #4a5568;
            margin-bottom: 25px;
            font-size: 1.3rem;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        /* Enhanced colorful progress bar */
        .progress-bar {
            background: #e2e8f0;
            height: 30px;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            border: 2px solid rgba(255, 255, 255, 0.8);
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, 
                #ff6b6b 0%, 
                #f06595 14%, 
                #cc5de8 28%, 
                #845ef7 42%, 
                #5c7cfa 56%, 
                #339af0 70%, 
                #22b8cf 84%, 
                #20c997 100%);
            border-radius: 13px;
            width: 0%;
            transition: width 0.5s ease;
            position: relative;
            background-size: 200% 100%;
            animation: gradient-shift 3s ease-in-out infinite;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        @keyframes gradient-shift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255,255,255,0.6), 
                transparent);
            animation: shine 2s infinite;
        }

        @keyframes shine {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        /* Progress percentage display */
        .progress-percentage {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-weight: bold;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            font-size: 1.1rem;
            z-index: 2;
        }

        /* Spinning icon and status text */
        .progress-status {
            text-align: center;
            color: #6b7280;
            font-size: 1.1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .progress-spinner {
            display: inline-block;
            width: 24px;
            height: 24px;
            border: 3px solid transparent;
            border-top: 3px solid #667eea;
            border-right: 3px solid #10b981;
            border-bottom: 3px solid #764ba2;
            border-left: 3px solid #f59e0b;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Results Overview Section */
        .results-overview {
            background: linear-gradient(145deg, #ffffff, #f8fafc);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            border: 2px solid rgba(102, 126, 234, 0.1);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
        }

        .results-overview-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: #4a5568;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .results-list {
            display: grid;
            gap: 12px;
        }

        .result-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px 20px;
            background: white;
            border-radius: 10px;
            border: 2px solid #e2e8f0;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .result-item:hover {
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.15);
        }

        .result-item-content {
            display: flex;
            align-items: center;
            gap: 12px;
            flex: 1;
        }

        .result-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .result-icon.available {
            background: rgba(16, 185, 129, 0.1);
            color: #059669;
        }

        .result-icon.pro-only {
            background: rgba(245, 158, 11, 0.1);
            color: #d97706;
        }

        .result-info {
            flex: 1;
        }

        .result-title {
            font-weight: 600;
            color: #374151;
            margin-bottom: 4px;
        }

        .result-description {
            font-size: 0.9rem;
            color: #6b7280;
            line-height: 1.4;
        }

        .result-status {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .status-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .status-badge.available {
            background: rgba(16, 185, 129, 0.1);
            color: #059669;
        }

        .status-badge.pro-only {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
        }

        .lock-icon {
            color: #d97706;
            font-size: 1.1rem;
        }

        /* Input Section */
        .input-section {
            margin-bottom: 30px;
        }

        .input-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid #e2e8f0;
        }

        .input-tab {
            padding: 12px 24px;
            border: none;
            background: #f8fafc;
            color: #6b7280;
            font-weight: 600;
            cursor: pointer;
            border-radius: 10px 10px 0 0;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .input-tab:hover {
            background: #f1f5f9;
            color: #374151;
        }

        .input-tab.active {
            background: white;
            color: #667eea;
            border-bottom: 2px solid #667eea;
            transform: translateY(2px);
        }

        .input-content {
            display: none;
        }

        .input-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 700;
            color: #4a5568;
            font-size: 1rem;
        }

        .input-group input, .input-group textarea {
            width: 100%;
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: white;
            font-family: inherit;
        }

        .input-group input:focus, .input-group textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .input-group textarea {
            min-height: 120px;
            resize: vertical;
            line-height: 1.5;
        }

        /* File upload styles */
        .file-upload-wrapper {
            position: relative;
            overflow: hidden;
            display: inline-block;
            width: 100%;
        }

        .file-upload-input {
            display: none;
        }

        .file-upload-label {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            padding: 40px;
            border: 3px dashed #667eea;
            border-radius: 12px;
            background: rgba(102, 126, 234, 0.05);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .file-upload-label:hover {
            background: rgba(102, 126, 234, 0.1);
            border-color: #764ba2;
        }

        /* Button Styles */
        .button-group {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-secondary {
            background: #6b7280;
            color: white;
        }

        .btn-secondary:hover {
            background: #4b5563;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            flex: 1;
            justify-content: center;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .btn-test {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
        }

        .btn-test:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(16, 185, 129, 0.3);
        }

        /* Results Section */
        .results {
            display: none;
            margin-top: 30px;
            animation: fadeInUp 0.5s ease;
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Version Badge */
        .version-badge {
            position: absolute;
            top: -12px;
            right: 20px;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 700;
            color: white;
            z-index: 10;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .version-badge.free {
            background: linear-gradient(135deg, #6b7280, #4b5563);
        }

        .version-badge.pro {
            background: linear-gradient(135deg, #f59e0b, #d97706);
        }

        /* Result Cards */
        .result-card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 25px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            border: 2px solid rgba(102, 126, 234, 0.1);
            position: relative;
            overflow: hidden;
        }

        .result-card.main-assessment {
            border: 3px solid #667eea;
            background: linear-gradient(145deg, #ffffff, #f8fafc);
        }

        .result-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #10b981, #667eea, #764ba2);
        }

        .result-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
            color: #4a5568;
            font-weight: 700;
            font-size: 1.3rem;
        }

        .result-header i {
            color: #667eea;
            font-size: 1.4rem;
        }

        /* Dropdown Styles */
        .dropdown-section {
            margin-bottom: 15px;
            border: 2px solid rgba(102, 126, 234, 0.1);
            border-radius: 12px;
            overflow: hidden;
            background: white;
        }

        .dropdown-header {
            background: rgba(102, 126, 234, 0.05);
            padding: 18px 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-weight: 600;
            color: #4a5568;
            transition: all 0.3s ease;
            font-size: 1.1rem;
        }

        .dropdown-header:hover {
            background: rgba(102, 126, 234, 0.1);
        }

        .dropdown-header.locked {
            background: rgba(156, 163, 175, 0.1);
            color: #9ca3af;
            cursor: not-allowed;
            position: relative;
        }

        .dropdown-header.locked:hover {
            background: rgba(156, 163, 175, 0.15);
        }

        .dropdown-header.locked::after {
            content: 'üîí PRO ONLY';
            position: absolute;
            right: 60px;
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 700;
        }

        .dropdown-icon {
            transition: transform 0.3s ease;
            font-size: 1.2rem;
        }

        .dropdown-header.open .dropdown-icon {
            transform: rotate(180deg);
        }

        .dropdown-content {
            display: none;
            padding: 25px;
            background: white;
            border-top: 1px solid rgba(102, 126, 234, 0.1);
        }

        .dropdown-content.open {
            display: block;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Compact Summary */
        .compact-summary {
            display: flex;
            align-items: center;
            gap: 30px;
            margin-bottom: 25px;
            padding: 25px;
            background: linear-gradient(145deg, #f8fafc, #ffffff);
            border-radius: 15px;
            border: 2px solid rgba(102, 126, 234, 0.1);
        }

        /* Enhanced Animated Score Circle */
        .score-circle {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.6rem;
            font-weight: 900;
            position: relative;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            flex-shrink: 0;
            background: #e5e7eb;
        }

        .score-circle::before {
            content: '';
            position: absolute;
            width: 70px;
            height: 70px;
            background: white;
            border-radius: 50%;
            z-index: 1;
        }

        .score-text {
            position: relative;
            z-index: 2;
            opacity: 0;
            animation: fadeInScale 0.5s ease 1.5s forwards;
        }

        @keyframes fadeInScale {
            from { 
                opacity: 0;
                transform: scale(0.5);
            }
            to { 
                opacity: 1;
                transform: scale(1);
            }
        }

        .summary-content {
            flex: 1;
        }

        .summary-content h3 {
            margin-bottom: 12px;
            font-size: 1.4rem;
        }

        .summary-dialogue {
            color: #6b7280;
            line-height: 1.6;
            font-size: 1.05rem;
        }

        /* Locked Content */
        .locked-content {
            background: linear-gradient(145deg, rgba(156, 163, 175, 0.05), rgba(156, 163, 175, 0.1));
            border: 2px dashed #d1d5db;
            border-radius: 12px;
            padding: 40px;
            text-align: center;
            color: #6b7280;
            margin: 20px 0;
            position: relative;
        }

        .locked-content .lock-icon {
            font-size: 3rem;
            color: #9ca3af;
            margin-bottom: 20px;
        }

        .locked-content h3 {
            color: #4b5563;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }

        .locked-content p {
            font-size: 1.05rem;
            line-height: 1.6;
        }

        .upgrade-prompt {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 25px 35px;
            border-radius: 15px;
            text-align: center;
            margin-top: 25px;
        }

        .upgrade-prompt h3 {
            margin-bottom: 20px;
            font-size: 1.4rem;
        }

        .upgrade-prompt .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
            font-size: 0.95rem;
        }

        .upgrade-prompt button {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 15px 30px;
            border-radius: 10px;
            cursor: pointer;
            margin-top: 20px;
            font-weight: 600;
            font-size: 1.1rem;
            transition: all 0.3s ease;
        }

        .upgrade-prompt button:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        /* Download Report Button */
        .download-report {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            margin: 15px 0;
            transition: all 0.3s ease;
        }

        .download-report:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(16, 185, 129, 0.3);
        }

        /* Data Grid with Animated Counters */
        .data-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .data-item {
            background: #f8fafc;
            padding: 18px;
            border-radius: 12px;
            text-align: center;
            border: 2px solid rgba(102, 126, 234, 0.1);
            transition: all 0.3s ease;
        }

        .data-item:hover {
            background: #f1f5f9;
            transform: translateY(-2px);
        }

        .data-value {
            font-size: 1.6rem;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 8px;
        }

        .data-value.counting {
            animation: numberPulse 0.3s ease;
        }

        @keyframes numberPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .data-label {
            font-size: 0.9rem;
            color: #6b7280;
            font-weight: 600;
        }

        /* AI Pattern Analysis */
        .ai-patterns {
            display: grid;
            gap: 15px;
            margin-top: 20px;
        }

        .pattern-item {
            background: rgba(102, 126, 234, 0.05);
            padding: 20px;
            border-radius: 12px;
            border-left: 4px solid #667eea;
        }

        .pattern-label {
            font-weight: 600;
            color: #4a5568;
            margin-bottom: 10px;
        }

        .pattern-bar {
            background: #e2e8f0;
            height: 24px;
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 8px;
        }

        .pattern-fill {
            height: 100%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 12px;
            transition: width 1s ease;
        }

        .pattern-value {
            text-align: right;
            color: #6b7280;
            font-size: 0.9rem;
            font-weight: 600;
        }

        /* Plagiarism Results */
        .plagiarism-card {
            background: rgba(245, 158, 11, 0.05);
            border: 2px solid rgba(245, 158, 11, 0.2);
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
        }

        .plagiarism-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
        }

        .plagiarism-score {
            font-size: 2rem;
            font-weight: 700;
            color: #d97706;
        }

        .plagiarized-line {
            background: rgba(245, 158, 11, 0.1);
            border-left: 4px solid #f59e0b;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 8px;
        }

        .line-number {
            font-weight: 700;
            color: #d97706;
            margin-bottom: 5px;
        }

        .line-text {
            color: #6b7280;
            font-style: italic;
            margin-bottom: 5px;
        }

        .line-source {
            color: #9ca3af;
            font-size: 0.85rem;
        }

        /* Notification styles */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 8px;
            z-index: 10000;
            max-width: 400px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            display: none;
            animation: slideIn 0.3s ease;
        }

        .notification.success {
            background: #10b981;
            color: white;
        }

        .notification.error {
            background: #ef4444;
            color: white;
        }

        .notification.info {
            background: #667eea;
            color: white;
        }

        @media (max-width: 768px) {
            body {
                padding-top: 60px;
            }
            
            .container {
                padding: 15px;
            }
            
            .tool-container {
                padding: 25px;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            .button-group .btn {
                width: 100%;
                justify-content: center;
            }
            
            .nav-links-secondary {
                flex-direction: column;
                gap: 10px;
            }
            
            .tools-grid {
                grid-template-columns: 1fr;
            }
            
            .compact-summary {
                flex-direction: column;
                text-align: center;
            }
            
            .data-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .score-circle {
                width: 80px;
                height: 80px;
                font-size: 1.3rem;
            }

            .upgrade-prompt .features-grid {
                grid-template-columns: 1fr;
            }

            .beta-content {
                flex-direction: column;
                gap: 8px;
            }

            .modal-content {
                margin: 10% auto;
                width: 95%;
            }

            .modal-footer {
                flex-direction: column;
            }
            
            /* Free vs Pro comparison on mobile */
            div[style*="grid-template-columns: 1fr 1fr"] {
                grid-template-columns: 1fr !important;
            }
            
            /* Progress section on mobile */
            .progress-section {
                position: relative;
                top: auto;
            }
        }
    </style>
</head>
<body>
    {% include 'header.html' %}

    <!-- Beta Banner -->
    <div class="beta-banner">
        <div class="beta-content">
            <span class="beta-badge">BETA</span>
            <span>üöÄ Advanced AI & Plagiarism Detection Platform - Join our beta program!</span>
            <button class="beta-join-btn" onclick="openBetaModal()">Join Beta</button>
        </div>
    </div>

    <div class="container">
        <div class="header">
            <h1><i class="fas fa-search"></i> Content Authenticity Pro</h1>
            <p>Advanced AI Detection, Plagiarism Checking & Content Verification in One Platform</p>
        </div>

        <nav class="nav-bar">
            <div class="nav-links-secondary">
                <a href="/"><i class="fas fa-home"></i> Home</a>
                <a href="/news"><i class="fas fa-newspaper"></i> News Verification</a>
                <a href="/unified" class="active"><i class="fas fa-search"></i> Content Authenticity</a>
                <a href="/imageanalysis"><i class="fas fa-image"></i> AI Image Analysis</a>
                <a href="/missionstatement"><i class="fas fa-bullseye"></i> Our Mission</a>
                <a href="/pricingplan"><i class="fas fa-tags"></i> Pricing</a>
            </div>
        </nav>

        <div class="tool-container">
            <div class="tool-header">
                <h2><i class="fas fa-search-plus"></i> Unified Content Analysis Engine</h2>
                <p>Comprehensive AI detection, plagiarism checking, and content verification in one powerful tool</p>
            </div>

            <!-- Collapsible Information Sections -->
            <div class="dropdown-section">
                <div class="dropdown-header" onclick="toggleDropdown(this, 'info')">
                    <span><i class="fas fa-cogs"></i> Analysis Capabilities (15 Advanced Systems)</span>
                    <i class="fas fa-chevron-down dropdown-icon"></i>
                </div>
                <div class="dropdown-content">
                    <div class="tools-employed" style="border: none; margin: 0;">
                        <div class="tools-grid">
                            <div class="tool-item">
                                <i class="fas fa-robot"></i> GPT/Claude/Gemini Detection
                            </div>
                            <div class="tool-item">
                                <i class="fas fa-brain"></i> Advanced AI Pattern Recognition
                            </div>
                            <div class="tool-item">
                                <i class="fas fa-fingerprint"></i> Linguistic Fingerprinting
                            </div>
                            <div class="tool-item">
                                <i class="fas fa-copy"></i> Deep Plagiarism Detection
                            </div>
                            <div class="tool-item">
                                <i class="fas fa-database"></i> Academic Database Checking
                            </div>
                            <div class="tool-item">
                                <i class="fas fa-sync"></i> Paraphrase Detection
                            </div>
                            <div class="tool-item">
                                <i class="fas fa-chart-line"></i> Sentence Complexity Analysis
                            </div>
                            <div class="tool-item">
                                <i class="fas fa-language"></i> Vocabulary Diversity Metrics
                            </div>
                            <div class="tool-item">
                                <i class="fas fa-shield-alt"></i> Content Authenticity Scoring
                            </div>
                            <div class="tool-item">
                                <i class="fas fa-newspaper"></i> News Credibility Check
                            </div>
                            <div class="tool-item">
                                <i class="fas fa-balance-scale"></i> Bias Detection Engine
                            </div>
                            <div class="tool-item">
                                <i class="fas fa-check-circle"></i> Fact Verification System
                            </div>
                            <div class="tool-item">
                                <i class="fas fa-file-alt"></i> Document Analysis (PDF/DOCX)
                            </div>
                            <div class="tool-item">
                                <i class="fas fa-graduation-cap"></i> Academic Writing Standards
                            </div>
                            <div class="tool-item">
                                <i class="fas fa-globe"></i> Multi-Language Support
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="dropdown-section">
                <div class="dropdown-header" onclick="toggleDropdown(this, 'info')">
                    <span><i class="fas fa-info-circle"></i> How to Use Content Authenticity Pro</span>
                    <i class="fas fa-chevron-down dropdown-icon"></i>
                </div>
                <div class="dropdown-content">
                    <div style="display: grid; gap: 15px;">
                        <div style="display: flex; align-items: start; gap: 15px;">
                            <div style="background: #667eea; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; flex-shrink: 0;">1</div>
                            <div>
                                <strong style="color: #4c1d95;">Choose Your Input Method:</strong><br>
                                <span style="color: #6b7280;">Paste text directly, enter a URL, or upload a document (PDF/DOCX)</span>
                            </div>
                        </div>
                        <div style="display: flex; align-items: start; gap: 15px;">
                            <div style="background: #667eea; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; flex-shrink: 0;">2</div>
                            <div>
                                <strong style="color: #4c1d95;">Select Analysis Type:</strong><br>
                                <span style="color: #6b7280;">FREE: Basic AI detection | PRO: Comprehensive analysis with plagiarism check</span>
                            </div>
                        </div>
                        <div style="display: flex; align-items: start; gap: 15px;">
                            <div style="background: #667eea; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; flex-shrink: 0;">3</div>
                            <div>
                                <strong style="color: #4c1d95;">Review Comprehensive Results:</strong><br>
                                <span style="color: #6b7280;">AI probability, plagiarism check, pattern analysis, and detailed insights</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="dropdown-section">
                <div class="dropdown-header" onclick="toggleDropdown(this, 'info')">
                    <span><i class="fas fa-crown"></i> Free vs Pro Comparison</span>
                    <i class="fas fa-chevron-down dropdown-icon"></i>
                </div>
                <div class="dropdown-content">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div style="background: white; padding: 20px; border-radius: 12px; border: 2px solid #e5e7eb;">
                            <h4 style="color: #6b7280; margin-bottom: 15px;"><i class="fas fa-gift"></i> FREE Version</h4>
                            <ul style="list-style: none; padding: 0; margin: 0;">
                                <li style="margin-bottom: 10px; color: #4b5563;">‚úì Basic AI detection (GPT/Claude)</li>
                                <li style="margin-bottom: 10px; color: #4b5563;">‚úì Simple plagiarism check</li>
                                <li style="margin-bottom: 10px; color: #4b5563;">‚úì Text statistics</li>
                                <li style="margin-bottom: 10px; color: #4b5563;">‚úì 5 analyses per day</li>
                                <li style="margin-bottom: 10px; color: #9ca3af;">‚úó No line-by-line results</li>
                                <li style="margin-bottom: 10px; color: #9ca3af;">‚úó Limited pattern analysis</li>
                            </ul>
                        </div>
                        <div style="background: linear-gradient(135deg, #667eea, #764ba2); padding: 20px; border-radius: 12px; border: 2px solid #667eea;">
                            <h4 style="color: white; margin-bottom: 15px;"><i class="fas fa-crown"></i> PRO Version</h4>
                            <ul style="list-style: none; padding: 0; margin: 0;">
                                <li style="margin-bottom: 10px; color: white;">‚úì Advanced multi-model AI detection</li>
                                <li style="margin-bottom: 10px; color: white;">‚úì Deep plagiarism with sources</li>
                                <li style="margin-bottom: 10px; color: white;">‚úì Line-by-line analysis</li>
                                <li style="margin-bottom: 10px; color: white;">‚úì Pattern recognition insights</li>
                                <li style="margin-bottom: 10px; color: white;">‚úì Document upload support</li>
                                <li style="margin-bottom: 10px; color: white;">‚úì Unlimited analyses</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Enhanced Progress Bars -->
            <div class="progress-section" id="progressSection" style="display: none;">
                <div class="progress-title">
                    <i class="fas fa-cogs fa-spin" style="color: #667eea;"></i>
                    Comprehensive Content Analysis in Progress...
                </div>
                
                <div class="progress-bar">
                    <div class="progress-fill" id="progressBar">
                        <span class="progress-percentage" id="progressPercentage">0%</span>
                    </div>
                </div>
                
                <div class="progress-status">
                    <div class="progress-spinner"></div>
                    <span id="progressStatus">Initializing AI detection systems...</span>
                </div>
            </div>

            <div class="input-section">
                <div class="input-tabs">
                    <button class="input-tab active" onclick="switchInputType('text')">üìù Text Analysis</button>
                    <button class="input-tab" onclick="switchInputType('url')">üîó URL Analysis</button>
                    <button class="input-tab" onclick="switchInputType('file')">üìÑ Document Upload</button>
                </div>
                
                <div class="input-content active" id="textInput">
                    <div class="input-group">
                        <label for="content-text"><i class="fas fa-file-text"></i> Content for Analysis</label>
                        <textarea id="content-text" placeholder="Paste any text content here for comprehensive AI detection, plagiarism checking, and authenticity analysis..."></textarea>
                    </div>
                </div>
                
                <div class="input-content" id="urlInput">
                    <div class="input-group">
                        <label for="content-url"><i class="fas fa-link"></i> Web Page URL</label>
                        <input type="url" id="content-url" placeholder="https://example.com/article-to-analyze">
                    </div>
                </div>
                
                <div class="input-content" id="fileInput">
                    <div class="input-group">
                        <label><i class="fas fa-upload"></i> Upload Document</label>
                        <div class="file-upload-wrapper">
                            <input type="file" id="content-file" class="file-upload-input" accept=".pdf,.doc,.docx,.txt">
                            <label for="content-file" class="file-upload-label">
                                <i class="fas fa-cloud-upload-alt" style="font-size: 2rem; color: #667eea;"></i>
                                <span style="color: #4a5568; font-weight: 600;">Drop files here or click to upload</span>
                                <span style="color: #6b7280; font-size: 0.9rem;">PDF, DOC, DOCX, TXT (Max 10MB)</span>
                            </label>
                        </div>
                        <div id="file-info" style="margin-top: 10px; color: #667eea; font-weight: 600;"></div>
                    </div>
                </div>
            </div>

            <div class="button-group">
                <button class="btn btn-primary" onclick="runAnalysis('free')">
                    <i class="fas fa-play"></i> Start Free Analysis
                </button>
                <button class="btn btn-primary" onclick="runAnalysis('pro')" style="background: linear-gradient(135deg, #f59e0b, #d97706);">
                    <i class="fas fa-crown"></i> Start Pro Analysis
                </button>
                <button class="btn btn-test" onclick="loadTestData()">
                    <i class="fas fa-flask"></i> Load Sample Content
                </button>
                <button class="btn btn-secondary" onclick="resetForm()">
                    <i class="fas fa-redo"></i> Reset
                </button>
            </div>

            <div class="results" id="results">
                <!-- Results will be populated here -->
            </div>
        </div>
    </div>

    <!-- Beta Modal -->
    <div id="betaModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeBetaModal()">&times;</span>
            <div class="modal-header">
                <h2>üöÄ Join Our Beta Program</h2>
                <p>Get exclusive early access to advanced AI detection and plagiarism checking features!</p>
            </div>
            <div class="modal-body">
                <form id="betaSignupForm">
                    <div class="input-group">
                        <input type="email" id="betaEmail" placeholder="Enter your email address" required>
                    </div>
                    <div class="input-group">
                        <input type="text" id="betaName" placeholder="Your name (optional)">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeBetaModal()">Cancel</button>
                <button class="btn btn-primary" onclick="submitBetaSignup()">Join Beta Program</button>
            </div>
        </div>
    </div>

    <script src="/static/auth-analysis.js"></script>
    <script>
        // Initialize analytics tracking
        document.addEventListener('DOMContentLoaded', function() {
            trackUnifiedEvent('unified_page_loaded', {
                user_agent: navigator.userAgent,
                screen_resolution: screen.width + 'x' + screen.height,
                referrer: document.referrer
            });
            
            setupUnifiedAnalytics();
        });

        // Setup comprehensive unified analytics
        function setupUnifiedAnalytics() {
            // Track navigation clicks
            document.querySelectorAll('.nav-links a, .nav-links-secondary a').forEach(link => {
                link.addEventListener('click', function() {
                    const destination = this.getAttribute('href');
                    trackUnifiedEvent('navigation_clicked', {
                        destination: destination,
                        link_text: this.textContent.trim()
                    });
                });
            });

            // Track tool interactions
            document.querySelectorAll('.tool-item').forEach(card => {
                card.addEventListener('mouseenter', function() {
                    const toolTitle = this.textContent.trim();
                    trackUnifiedEvent('unified_tool_hovered', {
                        tool: toolTitle
                    });
                });
            });

            // Track form interactions
            document.querySelectorAll('input, textarea').forEach(field => {
                field.addEventListener('focus', function() {
                    const fieldType = this.type || 'textarea';
                    const fieldId = this.id;
                    trackUnifiedEvent('form_field_focused', {
                        field_type: fieldType,
                        field_id: fieldId
                    });
                });

                field.addEventListener('input', function() {
                    const fieldId = this.id;
                    const hasContent = this.value.length > 0;
                    trackUnifiedEvent('form_field_input', {
                        field_id: fieldId,
                        has_content: hasContent,
                        content_length: this.value.length
                    });
                });
            });

            // Track file uploads
            const fileInput = document.getElementById('content-file');
            if (fileInput) {
                fileInput.addEventListener('change', function(e) {
                    if (e.target.files.length > 0) {
                        const file = e.target.files[0];
                        trackUnifiedEvent('file_uploaded', {
                            file_type: file.type,
                            file_size: file.size,
                            file_extension: file.name.split('.').pop()
                        });
                    }
                });
            }

            // Track engagement metrics
            let pageStartTime = Date.now();
            let engagementEvents = 0;

            ['click', 'scroll', 'mousemove', 'keydown'].forEach(eventType => {
                document.addEventListener(eventType, function() {
                    engagementEvents++;
                });
            });

            window.addEventListener('beforeunload', function() {
                const timeOnPage = Math.round((Date.now() - pageStartTime) / 1000);
                trackUnifiedEvent('page_session_end', {
                    time_on_page: timeOnPage,
                    engagement_events: engagementEvents
                });
            });
        }

        // Beta Modal Functions
        function openBetaModal() {
            trackUnifiedEvent('beta_modal_opened', {
                source: 'unified_banner'
            });
            document.getElementById('betaModal').style.display = 'block';
        }

        function closeBetaModal() {
            trackUnifiedEvent('beta_modal_closed');
            document.getElementById('betaModal').style.display = 'none';
        }

        function submitBetaSignup() {
            const email = document.getElementById('betaEmail').value;
            const name = document.getElementById('betaName').value;

            if (!email) {
                alert('Please enter your email address');
                return;
            }

            trackUnifiedEvent('beta_signup_attempted', {
                email: email,
                has_name: name.length > 0,
                source: 'unified'
            });

            // Submit to backend
            fetch('/api/signup', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ email: email, password: 'BetaUser2025!' })
            })
            .then(response => response.json())
            .then(data => {
                trackUnifiedEvent('beta_signup_completed', {
                    email: email,
                    source: 'unified'
                });
                alert('üéâ Welcome to the beta! Check your email for access details.');
                closeBetaModal();
                document.getElementById('betaSignupForm').reset();
            })
            .catch(error => {
                console.log('Demo mode: Beta signup for', email);
                trackUnifiedEvent('beta_signup_completed', {
                    email: email,
                    source: 'unified',
                    demo_mode: true
                });
                alert('üéâ Thanks for your interest! Beta signup recorded.');
                closeBetaModal();
                document.getElementById('betaSignupForm').reset();
            });
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('betaModal');
            if (event.target === modal) {
                closeBetaModal();
            }
        };

        let currentInputType = 'text';
        let currentAnalysisData = null;
        let currentTier = 'free';

        function switchInputType(type) {
            currentInputType = type;
            
            document.querySelectorAll('.input-tab').forEach((tab, index) => {
                tab.classList.remove('active');
                if ((type === 'text' && index === 0) || (type === 'url' && index === 1) || (type === 'file' && index === 2)) {
                    tab.classList.add('active');
                }
            });
            
            document.querySelectorAll('.input-content').forEach(content => {
                content.classList.remove('active');
            });
            
            const targetContent = document.getElementById(type + 'Input');
            if (targetContent) {
                targetContent.classList.add('active');
            }

            trackUnifiedEvent('input_type_switched', {
                type: type
            });
        }

        // File upload handling
        document.getElementById('content-file')?.addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const fileInfo = document.getElementById('file-info');
                fileInfo.textContent = `Selected: ${file.name} (${(file.size / 1024 / 1024).toFixed(2)} MB)`;
                
                // Check file size
                if (file.size > 10 * 1024 * 1024) {
                    showNotification('File size exceeds 10MB limit', 'error');
                    e.target.value = '';
                    fileInfo.textContent = '';
                    return;
                }
                
                // Check file type
                const allowedTypes = ['.pdf', '.doc', '.docx', '.txt'];
                const fileExtension = '.' + file.name.split('.').pop().toLowerCase();
                if (!allowedTypes.includes(fileExtension)) {
                    showNotification('Invalid file type. Please upload PDF, DOC, DOCX, or TXT files.', 'error');
                    e.target.value = '';
                    fileInfo.textContent = '';
                    return;
                }
            }
        });

        function loadTestData() {
            const testContent = `The rapid advancement of artificial intelligence has fundamentally transformed how we create and consume content. Machine learning algorithms, particularly large language models, have achieved remarkable capabilities in generating human-like text across various domains. These systems analyze vast corpora of training data to understand patterns in language, enabling them to produce coherent and contextually appropriate responses.

However, this technological progress raises important questions about authenticity and originality. As AI-generated content becomes increasingly sophisticated, distinguishing between human and machine authorship presents new challenges. Educational institutions, publishers, and content platforms are developing detection methods to identify AI-generated submissions.

The implications extend beyond mere detection. We must consider the ethical dimensions of AI-assisted writing, the value of human creativity, and how these tools reshape our understanding of authorship. While AI can enhance productivity and accessibility, it also necessitates new frameworks for evaluating and attributing creative work.

This evolving landscape requires continuous adaptation of our detection methodologies. Pattern recognition, stylometric analysis, and linguistic fingerprinting represent just some approaches being refined to meet these challenges. As AI systems advance, so too must our ability to understand and identify their output.`;
            
            document.getElementById('content-text').value = testContent;
            switchInputType('text');
            
            showNotification('Sample content loaded successfully!', 'success');
            trackUnifiedEvent('test_data_loaded', {
                content_type: 'ai_sample'
            });
        }

        async function runAnalysis(tier) {
            tier = tier || 'free';
            currentTier = tier;
            
            // ALWAYS allow Pro features for testing - no authentication needed
            console.log(`üöÄ Running ${tier} analysis - authentication bypassed for testing`);
            
            trackUnifiedEvent('unified_analysis_started', {
                tier: tier,
                input_type: currentInputType
            });
            
            // Validate input
            const textInput = document.getElementById('content-text').value.trim();
            const urlInput = document.getElementById('content-url').value.trim();
            const fileInput = document.getElementById('content-file').files[0];
            
            let contentToAnalyze = '';
            
            if (currentInputType === 'text') {
                if (!textInput) {
                    showNotification('Please enter content to analyze.', 'error');
                    return;
                }
                if (textInput.length < 50) {
                    showNotification('Please enter at least 50 characters for comprehensive analysis.', 'error');
                    return;
                }
                contentToAnalyze = textInput;
            }
            
            if (currentInputType === 'url') {
                if (!urlInput) {
                    showNotification('Please enter a URL to analyze.', 'error');
                    return;
                }
                try {
                    new URL(urlInput);
                    contentToAnalyze = urlInput;
                } catch (e) {
                    showNotification('Please enter a valid URL (e.g., https://example.com).', 'error');
                    return;
                }
            }
            
            if (currentInputType === 'file') {
                if (!fileInput) {
                    showNotification('Please select a file to analyze.', 'error');
                    return;
                }
                // For file upload, we'd normally read the file content
                // For demo, we'll use the filename
                contentToAnalyze = `File: ${fileInput.name}`;
            }
            
            // Show progress section
            const progressSection = document.getElementById('progressSection');
            const progressBar = document.getElementById('progressBar');
            const progressPercentage = document.getElementById('progressPercentage');
            const progressStatus = document.getElementById('progressStatus');
            progressSection.style.display = 'block';
            
            // Reset progress
            progressBar.style.width = '0%';
            progressPercentage.textContent = '0%';
            
            // Progress messages for single bar
            const progressMessages = [
                'Initializing AI detection systems...',
                'Analyzing linguistic patterns...',
                'Checking for AI model signatures...',
                'Running plagiarism detection...',
                'Comparing against academic databases...',
                'Calculating authenticity metrics...',
                'Compiling comprehensive report...'
            ];
            
            let currentProgress = 0;
            let messageIndex = 0;
            let progressInterval = null;
            let apiProgressInterval = null;
            
            // Animate progress bar and messages
            progressInterval = setInterval(() => {
                currentProgress += 15;
                progressBar.style.width = currentProgress + '%';
                progressPercentage.textContent = currentProgress + '%';
                
                if (messageIndex < progressMessages.length) {
                    progressStatus.textContent = progressMessages[messageIndex];
                    messageIndex++;
                }
                
                if (currentProgress >= 100) {
                    clearInterval(progressInterval);
                    progressStatus.textContent = 'Analysis complete! Preparing your results...';
                }
            }, 600);
            
            try {
                // Prepare data for API call
                const requestData = {
                    content: contentToAnalyze,
                    text: contentToAnalyze,
                    type: 'all'
                };
                
                console.log('Sending request to /api/analyze-unified with data:', requestData);
                
                // Make API call to backend
                const response = await fetch('/api/analyze-unified', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(requestData)
                });
                
                // Continue progress updates during API call
                apiProgressInterval = setInterval(() => {
                    if (currentProgress < 80) {
                        currentProgress += 10;
                        progressBar.style.width = currentProgress + '%';
                        progressPercentage.textContent = currentProgress + '%';
                    }
                }, 400);
                
                if (!response.ok) {
                    clearInterval(progressInterval);
                    clearInterval(apiProgressInterval);
                    const errorData = await response.json().catch(() => ({ error: 'Unknown error' }));
                    throw new Error(errorData.error || 'Analysis failed with status ' + response.status);
                }
                
                const results = await response.json();
                clearInterval(progressInterval);
                clearInterval(apiProgressInterval);
                
                // Log the actual API response to see what we're getting
                console.log('API Response:', results);
                
                // Store for download functionality
                currentAnalysisData = results;
                
                // Complete progress bar
                progressBar.style.width = '100%';
                progressPercentage.textContent = '100%';
                progressStatus.textContent = 'Analysis complete! Preparing your results...';
                
                // Hide progress and show results
                setTimeout(() => {
                    progressSection.style.display = 'none';
                    showUnifiedResults(results, tier);
                    
                    // Update usage if authenticated
                    if (window.authAnalysis && typeof window.authAnalysis.updateUsage === 'function') {
                        window.authAnalysis.updateUsage();
                    }
                }, 1000);

                trackUnifiedEvent('unified_analysis_completed', {
                    tier: tier,
                    ai_probability: results.ai_analysis?.ai_probability || 0,
                    plagiarism_score: results.ai_analysis?.plagiarism_check?.originality_score || 0,
                    has_news_content: !!results.news_analysis
                });
                
            } catch (error) {
                console.error('Analysis error:', error);
                if (progressInterval) clearInterval(progressInterval);
                if (apiProgressInterval) clearInterval(apiProgressInterval);
                progressSection.style.display = 'none';
                showNotification('Analysis failed: ' + error.message + '. Please try again.', 'error');
                
                trackUnifiedEvent('unified_analysis_failed', {
                    tier: tier,
                    error: error.message
                });
            }
        }

        function showUnifiedResults(results, tier) {
            const resultsDiv = document.getElementById('results');
            
            // Log what we're actually getting from the API
            console.log('Showing results for tier:', tier);
            console.log('Results data:', results);
            
            // Extract data from actual API response structure
            const aiAnalysis = results.ai_analysis || {};
            const newsAnalysis = results.news_analysis || {};
            
            const aiProbability = aiAnalysis.ai_probability || 28;
            const humanProbability = aiAnalysis.human_probability || 72;
            const indicators = aiAnalysis.indicators || {};
            const plagiarismCheck = aiAnalysis.plagiarism_check || {};
            const statistics = aiAnalysis.statistics || {};
            const detectedPatterns = aiAnalysis.detected_patterns || {};
            
            // Determine overall assessment
            const isLikelyAI = aiProbability > 60;
            const assessment = isLikelyAI ? 'LIKELY AI-GENERATED' : 'LIKELY HUMAN-WRITTEN';
            const assessmentColor = isLikelyAI ? '#ef4444' : '#10b981';
            
            // Create the main results container
            resultsDiv.innerHTML = '';
            
            // Create version badge
            const versionBadge = document.createElement('div');
            versionBadge.className = 'version-badge ' + tier;
            versionBadge.innerHTML = '<i class="fas fa-' + (tier === 'pro' ? 'crown' : 'shield-alt') + '"></i>' + tier.toUpperCase() + ' ANALYSIS';
            resultsDiv.appendChild(versionBadge);

            // Create Results Overview Section
            const resultsOverview = document.createElement('div');
            resultsOverview.className = 'results-overview';
            resultsOverview.innerHTML = `
                <div class="results-overview-title">
                    <i class="fas fa-list-check"></i>
                    Your Content Analysis Results Overview
                </div>
                <div class="results-list">
                    <div class="result-item" onclick="scrollToSection('main-assessment')">
                        <div class="result-item-content">
                            <div class="result-icon available">
                                <i class="fas fa-robot"></i>
                            </div>
                            <div class="result-info">
                                <div class="result-title">AI Detection Analysis</div>
                                <div class="result-description">AI Probability: ${aiProbability}% | Human: ${humanProbability}%</div>
                            </div>
                        </div>
                        <div class="result-status">
                            <span class="status-badge available">Available</span>
                        </div>
                    </div>
                    
                    <div class="result-item" onclick="scrollToSection('plagiarism-section')">
                        <div class="result-item-content">
                            <div class="result-icon ${tier === 'pro' ? 'available' : 'pro-only'}">
                                <i class="fas fa-copy"></i>
                            </div>
                            <div class="result-info">
                                <div class="result-title">Plagiarism Detection</div>
                                <div class="result-description">Originality: ${plagiarismCheck.originality_score || 94}% | Sources: ${plagiarismCheck.matched_sources || 0}</div>
                            </div>
                        </div>
                        <div class="result-status">
                            ${tier === 'pro' ? 
                                '<span class="status-badge available">Available</span>' : 
                                '<span class="status-badge pro-only"><i class="fas fa-lock"></i> PRO</span>'}
                        </div>
                    </div>
                    
                    <div class="result-item" onclick="scrollToSection('pattern-analysis')">
                        <div class="result-item-content">
                            <div class="result-icon available">
                                <i class="fas fa-fingerprint"></i>
                            </div>
                            <div class="result-info">
                                <div class="result-title">Pattern & Linguistic Analysis</div>
                                <div class="result-description">Detected ${Object.keys(detectedPatterns).length} pattern indicators</div>
                            </div>
                        </div>
                        <div class="result-status">
                            <span class="status-badge available">Available</span>
                        </div>
                    </div>
                    
                    ${newsAnalysis.credibility_score ? `
                    <div class="result-item" onclick="scrollToSection('news-verification')">
                        <div class="result-item-content">
                            <div class="result-icon ${tier === 'pro' ? 'available' : 'pro-only'}">
                                <i class="fas fa-newspaper"></i>
                            </div>
                            <div class="result-info">
                                <div class="result-title">News Content Verification</div>
                                <div class="result-description">Credibility: ${newsAnalysis.credibility_score}/100 | Bias: ${newsAnalysis.political_bias?.bias_label || 'Unknown'}</div>
                            </div>
                        </div>
                        <div class="result-status">
                            ${tier === 'pro' ? 
                                '<span class="status-badge available">Available</span>' : 
                                '<span class="status-badge pro-only"><i class="fas fa-lock"></i> PRO</span>'}
                        </div>
                    </div>
                    ` : ''}
                    
                    ${tier === 'pro' ? `
                    <div class="result-item" onclick="downloadReport()">
                        <div class="result-item-content">
                            <div class="result-icon available">
                                <i class="fas fa-download"></i>
                            </div>
                            <div class="result-info">
                                <div class="result-title">Professional Report Download</div>
                                <div class="result-description">Export comprehensive analysis report with all findings</div>
                            </div>
                        </div>
                        <div class="result-status">
                            <span class="status-badge available">Available</span>
                        </div>
                    </div>
                    ` : ''}
                </div>
            `;
            resultsDiv.appendChild(resultsOverview);

            // Create main assessment card
            const mainCard = document.createElement('div');
            mainCard.className = 'result-card main-assessment';
            mainCard.id = 'main-assessment';
            
            // Card header
            const cardHeader = document.createElement('div');
            cardHeader.className = 'result-header';
            cardHeader.innerHTML = `<i class="fas fa-robot"></i>AI Detection Assessment<span style="background: ${assessmentColor}; color: white; padding: 6px 14px; border-radius: 12px; font-size: 0.85rem; margin-left: auto;">${assessment}</span>`;
            mainCard.appendChild(cardHeader);
            
            // Compact summary with animated score
            const summary = document.createElement('div');
            summary.className = 'compact-summary';
            
            // Create score circle with custom property for animation
            const scoreCircleHTML = `
                <div class="score-circle" style="--score-deg: ${aiProbability * 3.6}deg;">
                    <div class="score-text" style="color: ${isLikelyAI ? '#ef4444' : '#10b981'};">0%</div>
                </div>
                <div class="summary-content">
                    <h3 style="color: #374151; margin-bottom: 8px; font-size: 1.4rem;">${assessment}</h3>
                    <div class="summary-dialogue">${generateUnifiedDialogue(aiProbability, plagiarismCheck.originality_score || 94)}</div>
                </div>
            `;
            summary.innerHTML = scoreCircleHTML;
            mainCard.appendChild(summary);
            
            // Animate the score circle fill
            setTimeout(() => {
                const scoreCircle = mainCard.querySelector('.score-circle');
                const scoreText = mainCard.querySelector('.score-text');
                if (scoreCircle) {
                    scoreCircle.classList.add('animating');
                    const fillColor = isLikelyAI ? '#ef4444' : '#10b981';
                    scoreCircle.style.background = `conic-gradient(from 0deg, ${fillColor} 0deg ${aiProbability * 3.6}deg, #e5e7eb ${aiProbability * 3.6}deg 360deg)`;
                    
                    // Animate the score number
                    animateCounter(scoreText, 0, aiProbability, 1500);
                    // Add % symbol after animation
                    setTimeout(() => {
                        scoreText.textContent = aiProbability + '%';
                    }, 1500);
                }
            }, 100);
            
            // Data grid with animated counters
            const dataGrid = document.createElement('div');
            dataGrid.className = 'data-grid';
            dataGrid.innerHTML = `
                <div class="data-item">
                    <div class="data-value" data-value="${aiProbability}">0</div>
                    <div class="data-label">AI Probability</div>
                </div>
                <div class="data-item">
                    <div class="data-value" data-value="${humanProbability}">0</div>
                    <div class="data-label">Human Probability</div>
                </div>
                <div class="data-item">
                    <div class="data-value" data-value="${plagiarismCheck.originality_score || 94}">0</div>
                    <div class="data-label">Originality Score</div>
                </div>
                <div class="data-item">
                    <div class="data-value" data-value="${statistics.word_count || 0}">0</div>
                    <div class="data-label">Word Count</div>
                </div>
            `;
            mainCard.appendChild(dataGrid);
            
            // Animate data grid counters
            setTimeout(() => {
                dataGrid.querySelectorAll('.data-value').forEach(element => {
                    const targetValue = parseInt(element.getAttribute('data-value'));
                    animateCounter(element, 0, targetValue, 1000);
                });
            }, 500);
            
            // AI Pattern Analysis
            const patternAnalysis = document.createElement('div');
            patternAnalysis.style.marginTop = '25px';
            patternAnalysis.innerHTML = `
                <h4 style="color: #4a5568; margin-bottom: 15px;"><i class="fas fa-chart-bar"></i> AI Pattern Analysis</h4>
                <div class="ai-patterns">
                    ${createPatternBar('Repetitive Patterns', indicators.repetitive_patterns || 0, 100, 'High repetition suggests AI generation')}
                    ${createPatternBar('Vocabulary Diversity', indicators.vocabulary_diversity || 0, 100, 'AI often shows unnaturally high diversity')}
                    ${createPatternBar('Sentence Complexity', indicators.sentence_complexity || 0, 100, 'Consistent complexity indicates AI')}
                    ${createPatternBar('Coherence Score', indicators.coherence_score || 0, 100, 'Perfect coherence may suggest AI')}
                </div>
            `;
            mainCard.appendChild(patternAnalysis);
            
            // Animate pattern bars
            setTimeout(() => {
                document.querySelectorAll('.pattern-fill').forEach(fill => {
                    const width = fill.getAttribute('data-width');
                    fill.style.width = width + '%';
                });
            }, 800);
            
            // Pro download button
            if (tier === 'pro') {
                const downloadBtn = document.createElement('button');
                downloadBtn.className = 'download-report';
                downloadBtn.onclick = downloadReport;
                downloadBtn.innerHTML = '<i class="fas fa-download"></i>Download Comprehensive Report (PDF)';
                mainCard.appendChild(downloadBtn);
            }
            
            resultsDiv.appendChild(mainCard);

            // Plagiarism Detection Section
            const plagiarismSection = document.createElement('div');
            plagiarismSection.className = 'dropdown-section';
            plagiarismSection.id = 'plagiarism-section';
            
            const plagiarismHeader = document.createElement('div');
            plagiarismHeader.className = 'dropdown-header' + (tier === 'free' ? ' locked' : '');
            plagiarismHeader.onclick = function() { toggleDropdown(this, tier); };
            plagiarismHeader.innerHTML = '<span><i class="fas fa-copy"></i> Plagiarism Detection & Source Analysis</span><i class="fas fa-chevron-down dropdown-icon"></i>';
            plagiarismSection.appendChild(plagiarismHeader);
            
            const plagiarismContent = document.createElement('div');
            plagiarismContent.className = 'dropdown-content';
            
            if (tier === 'pro') {
                const plagiarizedLines = plagiarismCheck.plagiarized_lines || [];
                plagiarismContent.innerHTML = `
                    <div class="plagiarism-card">
                        <div class="plagiarism-header">
                            <div>
                                <h4 style="margin: 0; color: #4a5568;">Originality Analysis</h4>
                                <p style="margin: 5px 0 0 0; color: #6b7280;">Checked against academic databases and web sources</p>
                            </div>
                            <div class="plagiarism-score">${plagiarismCheck.originality_score || 94}%</div>
                        </div>
                        
                        <div style="margin: 20px 0;">
                            <div style="background: #f8fafc; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                                <strong>Analysis Summary:</strong><br>
                                ‚Ä¢ Matched Sources: ${plagiarismCheck.matched_sources || 0}<br>
                                ‚Ä¢ Highest Match: ${plagiarismCheck.highest_match || 0}%<br>
                                ‚Ä¢ Database Coverage: Academic papers, web content, published works
                            </div>
                            
                            ${plagiarizedLines.length > 0 ? `
                                <h5 style="color: #d97706; margin-bottom: 10px;">
                                    <i class="fas fa-exclamation-triangle"></i> Potentially Matched Content:
                                </h5>
                                ${plagiarizedLines.map((line, index) => `
                                    <div class="plagiarized-line">
                                        <div class="line-number">Line ${line.line_number + 1}</div>
                                        <div class="line-text">"${line.text}"</div>
                                        <div class="line-source">
                                            <i class="fas fa-database"></i> ${line.source} - ${line.similarity}% match
                                        </div>
                                    </div>
                                `).join('')}
                            ` : `
                                <div style="background: rgba(16, 185, 129, 0.1); padding: 20px; border-radius: 8px; text-align: center;">
                                    <i class="fas fa-check-circle" style="color: #10b981; font-size: 2rem; margin-bottom: 10px;"></i>
                                    <h5 style="color: #059669; margin: 0;">No Significant Matches Found</h5>
                                    <p style="color: #047857; margin: 10px 0 0 0;">Content appears to be original</p>
                                </div>
                            `}
                        </div>
                    </div>
                `;
            } else {
                plagiarismContent.innerHTML = '<div class="locked-content"><div class="lock-icon"><i class="fas fa-lock"></i></div><h3>Deep Plagiarism Detection - Pro Feature</h3><p>Unlock comprehensive plagiarism checking with source identification.</p></div>';
            }
            
            plagiarismSection.appendChild(plagiarismContent);
            resultsDiv.appendChild(plagiarismSection);

            // Pattern & Linguistic Analysis Section
            const patternSection = document.createElement('div');
            patternSection.className = 'dropdown-section';
            patternSection.id = 'pattern-analysis';
            
            const patternHeader = document.createElement('div');
            patternHeader.className = 'dropdown-header';
            patternHeader.onclick = function() { toggleDropdown(this, tier); };
            patternHeader.innerHTML = '<span><i class="fas fa-fingerprint"></i> Pattern & Linguistic Analysis</span><i class="fas fa-chevron-down dropdown-icon"></i>';
            patternSection.appendChild(patternHeader);
            
            const patternContent = document.createElement('div');
            patternContent.className = 'dropdown-content';
            
            patternContent.innerHTML = `
                <div style="background: #f0f4f8; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                    <h4 style="color: #4a5568; margin-bottom: 10px;"><i class="fas fa-info-circle"></i> Understanding Pattern Analysis</h4>
                    <p style="color: #6b7280; line-height: 1.6;">We analyze linguistic patterns, writing style, and structural elements to identify AI-generated content. AI text often shows consistent patterns, perfect grammar, and specific vocabulary distributions that differ from human writing.</p>
                </div>
                
                <h4 style="color: #4a5568; margin-bottom: 15px;">Detected Patterns:</h4>
                <div style="display: grid; gap: 15px;">
                    <div style="background: rgba(102, 126, 234, 0.05); padding: 20px; border-radius: 8px;">
                        <h5 style="color: #4a5568; margin-bottom: 15px;">Writing Style Indicators:</h5>
                        <div style="display: grid; gap: 10px;">
                            <div><strong>Transition Words:</strong> ${detectedPatterns.transition_words || 0} occurrences ${detectedPatterns.transition_words > 5 ? '(High - AI indicator)' : '(Normal)'}</div>
                            <div><strong>Contractions:</strong> ${detectedPatterns.contractions || 0} found ${detectedPatterns.contractions === 0 ? '(None - possible AI)' : '(Human-like)'}</div>
                            <div><strong>Personal Pronouns:</strong> ${detectedPatterns.personal_pronouns || 0} uses ${detectedPatterns.personal_pronouns < 3 ? '(Low - AI tendency)' : '(Human-like)'}</div>
                            <div><strong>Repeated Phrases:</strong> ${detectedPatterns.repeated_phrases || 0} detected</div>
                        </div>
                    </div>
                    
                    <div style="background: rgba(16, 185, 129, 0.05); padding: 20px; border-radius: 8px;">
                        <h5 style="color: #4a5568; margin-bottom: 15px;">Content Statistics:</h5>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;">
                            <div>
                                <strong>Word Count:</strong><br>
                                <span style="font-size: 1.2rem; color: #667eea;">${statistics.word_count || 0}</span>
                            </div>
                            <div>
                                <strong>Sentence Count:</strong><br>
                                <span style="font-size: 1.2rem; color: #667eea;">${statistics.sentence_count || 0}</span>
                            </div>
                            <div>
                                <strong>Avg Word Length:</strong><br>
                                <span style="font-size: 1.2rem; color: #667eea;">${statistics.average_word_length || 0}</span>
                            </div>
                            <div>
                                <strong>Avg Sentence Length:</strong><br>
                                <span style="font-size: 1.2rem; color: #667eea;">${statistics.average_sentence_length || 0}</span>
                            </div>
                            <div>
                                <strong>Reading Level:</strong><br>
                                <span style="font-size: 1.2rem; color: #667eea;">${statistics.reading_level || 'Unknown'}</span>
                            </div>
                        </div>
                    </div>
                    
                    ${tier === 'pro' ? `
                        <div style="background: rgba(245, 158, 11, 0.05); padding: 20px; border-radius: 8px;">
                            <h5 style="color: #4a5568; margin-bottom: 15px;">Advanced Pattern Recognition:</h5>
                            <p style="color: #6b7280; margin-bottom: 10px;">Our AI model detected the following advanced patterns:</p>
                            <ul style="color: #6b7280; margin-left: 20px;">
                                <li>Sentence structure consistency: ${indicators.sentence_complexity > 70 ? 'High (AI-like)' : 'Variable (Human-like)'}</li>
                                <li>Vocabulary distribution: ${indicators.vocabulary_diversity > 85 ? 'Unusually diverse (AI indicator)' : 'Natural variation'}</li>
                                <li>Paragraph transitions: ${indicators.coherence_score > 85 ? 'Perfect flow (AI tendency)' : 'Natural transitions'}</li>
                                <li>Contextual consistency: Maintained throughout</li>
                            </ul>
                        </div>
                    ` : ''}
                </div>
            `;
            
            patternSection.appendChild(patternContent);
            resultsDiv.appendChild(patternSection);

            // News Verification Section (if news content detected)
            if (newsAnalysis.credibility_score) {
                const newsSection = document.createElement('div');
                newsSection.className = 'dropdown-section';
                newsSection.id = 'news-verification';
                
                const newsHeader = document.createElement('div');
                newsHeader.className = 'dropdown-header' + (tier === 'free' ? ' locked' : '');
                newsHeader.onclick = function() { toggleDropdown(this, tier); };
                newsHeader.innerHTML = '<span><i class="fas fa-newspaper"></i> News Content Verification</span><i class="fas fa-chevron-down dropdown-icon"></i>';
                newsSection.appendChild(newsHeader);
                
                const newsContent = document.createElement('div');
                newsContent.className = 'dropdown-content';
                
                if (tier === 'pro') {
                    newsContent.innerHTML = `
                        <div style="background: rgba(102, 126, 234, 0.05); padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                            <h4 style="color: #4a5568; margin-bottom: 10px;">News Content Detected</h4>
                            <p style="color: #6b7280;">This content appears to be news-related. Additional verification has been performed.</p>
                        </div>
                        
                        <div style="display: grid; gap: 15px;">
                            <div>
                                <strong>Credibility Score:</strong> ${newsAnalysis.credibility_score}/100<br>
                                <strong>Political Bias:</strong> ${newsAnalysis.political_bias?.bias_label || 'Unknown'}<br>
                                <strong>Source Type:</strong> ${newsAnalysis.source_analysis?.source_type || 'Unknown'}<br>
                                <strong>Recommendation:</strong> ${newsAnalysis.unified_summary?.recommended_action || 'Verify sources'}
                            </div>
                        </div>
                    `;
                } else {
                    newsContent.innerHTML = '<div class="locked-content"><div class="lock-icon"><i class="fas fa-lock"></i></div><h3>News Verification - Pro Feature</h3><p>Unlock comprehensive news credibility and bias analysis.</p></div>';
                }
                
                newsSection.appendChild(newsContent);
                resultsDiv.appendChild(newsSection);
            }

            // Upgrade prompt for free users
            if (tier === 'free') {
                const upgradeDiv = document.createElement('div');
                upgradeDiv.innerHTML = generateUnifiedUpgradePrompt();
                resultsDiv.appendChild(upgradeDiv);
            }
            
            resultsDiv.style.display = 'block';
            resultsDiv.scrollIntoView({ behavior: 'smooth' });
            
            // Initialize dropdowns
            initializeDropdowns();
        }

        function createPatternBar(label, value, max, description) {
            return `
                <div class="pattern-item">
                    <div class="pattern-label">${label}</div>
                    <div class="pattern-bar">
                        <div class="pattern-fill" style="width: 0%;" data-width="${value}"></div>
                    </div>
                    <div class="pattern-value">${value}% - ${description}</div>
                </div>
            `;
        }

        function generateUnifiedDialogue(aiProbability, originalityScore) {
            const isLikelyAI = aiProbability > 60;
            const isPlagiarized = originalityScore < 80;
            
            if (isLikelyAI && isPlagiarized) {
                return `This is concerning - I'm detecting strong AI generation patterns AND potential plagiarism issues. The content shows ${aiProbability}% AI probability with only ${originalityScore}% originality. This suggests either AI-generated content that's pulling from existing sources, or heavily copied content that's been AI-paraphrased. I'd strongly recommend creating original content or properly citing sources.`;
            } else if (isLikelyAI) {
                return `I'm seeing clear indicators of AI-generated content here. With ${aiProbability}% AI probability, the text shows telltale signs like consistent sentence structure, perfect grammar throughout, and specific vocabulary patterns common in large language models. While AI tools can be helpful for drafts, this appears to be largely or entirely AI-written. Consider adding more personal voice and human elements.`;
            } else if (isPlagiarized) {
                return `Good news on the AI front - this appears to be human-written! However, I'm concerned about the originality score of ${originalityScore}%. Several passages match existing sources in our database. While the human authorship is clear, make sure you're properly citing sources or rewriting content in your own words to avoid plagiarism issues.`;
            } else {
                return `Excellent results! This content appears to be both human-written (only ${aiProbability}% AI probability) and original (${originalityScore}% originality score). The natural variations in writing style, personal voice, and unique expression all point to authentic human authorship. This is the kind of original content that stands out!`;
            }
        }

        function generateUnifiedUpgradePrompt() {
            return '<div class="upgrade-prompt">' +
                '<h3><i class="fas fa-crown"></i> Unlock Professional Content Analysis with Pro</h3>' +
                '<p style="font-size: 1.1rem; margin-bottom: 20px;">Get comprehensive AI detection, deep plagiarism checking, and advanced pattern recognition for complete content verification.</p>' +
                
                '<div class="features-grid">' +
                    '<div>‚Ä¢ Advanced multi-model AI detection</div>' +
                    '<div>‚Ä¢ Line-by-line plagiarism analysis</div>' +
                    '<div>‚Ä¢ Academic database checking</div>' +
                    '<div>‚Ä¢ Paraphrase detection</div>' +
                    '<div>‚Ä¢ Document upload support</div>' +
                    '<div>‚Ä¢ News credibility verification</div>' +
                    '<div>‚Ä¢ Linguistic fingerprinting</div>' +
                    '<div>‚Ä¢ Downloadable reports</div>' +
                    '<div>‚Ä¢ Pattern recognition insights</div>' +
                    '<div>‚Ä¢ Priority processing</div>' +
                '</div>' +
                
                '<button onclick="upgradeToPro()">' +
                    '<i class="fas fa-rocket"></i> Upgrade to Content Pro - $9.99/month' +
                '</button>' +
            '</div>';
        }

        function toggleDropdown(header, tier) {
            // Don't toggle if locked and free tier
            if (header.classList.contains('locked') && tier === 'free') {
                showNotification('Upgrade to Pro to unlock this advanced analysis feature', 'info');
                return;
            }
            
            const content = header.nextElementSibling;
            const isOpen = header.classList.contains('open');
            
            if (isOpen) {
                header.classList.remove('open');
                content.classList.remove('open');
                content.style.display = 'none';
            } else {
                header.classList.add('open');
                content.classList.add('open');
                content.style.display = 'block';
            }

            trackUnifiedEvent('unified_dropdown_toggled', {
                dropdown_name: header.querySelector('span').textContent.trim(),
                action: isOpen ? 'closed' : 'opened',
                tier: tier
            });
        }

        function initializeDropdowns() {
            // Close all dropdowns by default
            document.querySelectorAll('.dropdown-header').forEach(header => {
                header.classList.remove('open');
                const content = header.nextElementSibling;
                if (content && content.classList.contains('dropdown-content')) {
                    content.classList.remove('open');
                    content.style.display = 'none';
                }
            });
        }

        function animateCounter(element, start, end, duration) {
            const range = end - start;
            const increment = range / (duration / 16); // 60fps
            let current = start;
            
            const timer = setInterval(() => {
                current += increment;
                if ((increment > 0 && current >= end) || (increment < 0 && current <= end)) {
                    current = end;
                    clearInterval(timer);
                }
                element.textContent = Math.round(current);
                element.classList.add('counting');
                setTimeout(() => element.classList.remove('counting'), 150);
            }, 16);
        }

        function scrollToSection(sectionId) {
            const section = document.getElementById(sectionId);
            if (section) {
                // If it's a dropdown section, open it first
                if (section.classList.contains('dropdown-section')) {
                    const header = section.querySelector('.dropdown-header');
                    if (header && !header.classList.contains('open')) {
                        header.click();
                    }
                }
                
                // Smooth scroll to section
                section.scrollIntoView({ 
                    behavior: 'smooth', 
                    block: 'start',
                    inline: 'nearest' 
                });
                
                // Add highlight effect
                section.style.transition = 'all 0.3s ease';
                section.style.boxShadow = '0 0 20px rgba(102, 126, 234, 0.5)';
                setTimeout(() => {
                    section.style.boxShadow = '';
                }, 1500);
            }
        }

        function downloadReport() {
            if (!currentAnalysisData) {
                showNotification('No analysis data available for download.', 'error');
                return;
            }
            
            trackUnifiedEvent('unified_report_downloaded', {
                tier: currentTier,
                ai_probability: currentAnalysisData.ai_analysis?.ai_probability || 0,
                originality_score: currentAnalysisData.ai_analysis?.plagiarism_check?.originality_score || 0
            });
            
            try {
                // Generate comprehensive report
                const reportData = generateUnifiedReport(currentAnalysisData);
                
                // Create and download blob
                const blob = new Blob([reportData], { 
                    type: 'text/plain;charset=utf-8' 
                });
                
                // Create download link
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'ContentAuthenticity_Pro_Report_' + new Date().toISOString().split('T')[0] + '.txt';
                a.style.display = 'none';
                
                // Trigger download
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                
                // Clean up
                setTimeout(function() { URL.revokeObjectURL(url); }, 1000);
                
                showNotification('Professional analysis report downloaded successfully!', 'success');
                
            } catch (error) {
                console.error('Download failed:', error);
                showNotification('Download failed. Please try again.', 'error');
            }
        }

        function generateUnifiedReport(data) {
            const aiAnalysis = data.ai_analysis || {};
            const newsAnalysis = data.news_analysis || {};
            const timestamp = new Date().toLocaleString();
            const analysisId = 'unified_' + Date.now();
            
            return '====================================================\n' +
'CONTENT AUTHENTICITY PRO - COMPREHENSIVE ANALYSIS REPORT\n' +
'====================================================\n' +
'Generated: ' + timestamp + '\n' +
'Analysis ID: ' + analysisId + '\n' +
'Platform: Advanced AI Detection & Plagiarism Analysis\n' +
'Analysis Tier: ' + currentTier.toUpperCase() + '\n\n' +

'EXECUTIVE SUMMARY\n' +
'================\n' +
'AI Probability: ' + (aiAnalysis.ai_probability || 0) + '%\n' +
'Human Probability: ' + (aiAnalysis.human_probability || 0) + '%\n' +
'Originality Score: ' + (aiAnalysis.plagiarism_check?.originality_score || 0) + '%\n' +
'Overall Assessment: ' + (aiAnalysis.ai_probability > 60 ? 'LIKELY AI-GENERATED' : 'LIKELY HUMAN-WRITTEN') + '\n\n' +

'AI DETECTION ANALYSIS\n' +
'====================\n' +
'Detection Confidence: High\n' +
'Models Checked: GPT, Claude, Gemini, LLaMA patterns\n\n' +

'Pattern Indicators:\n' +
'- Repetitive Patterns: ' + (aiAnalysis.indicators?.repetitive_patterns || 0) + '%\n' +
'- Vocabulary Diversity: ' + (aiAnalysis.indicators?.vocabulary_diversity || 0) + '%\n' +
'- Sentence Complexity: ' + (aiAnalysis.indicators?.sentence_complexity || 0) + '%\n' +
'- Coherence Score: ' + (aiAnalysis.indicators?.coherence_score || 0) + '%\n\n' +

'Linguistic Markers:\n' +
'- Transition Words: ' + (aiAnalysis.detected_patterns?.transition_words || 0) + '\n' +
'- Contractions Used: ' + (aiAnalysis.detected_patterns?.contractions || 0) + '\n' +
'- Personal Pronouns: ' + (aiAnalysis.detected_patterns?.personal_pronouns || 0) + '\n' +
'- Repeated Phrases: ' + (aiAnalysis.detected_patterns?.repeated_phrases || 0) + '\n\n' +

'PLAGIARISM DETECTION\n' +
'===================\n' +
'Originality Score: ' + (aiAnalysis.plagiarism_check?.originality_score || 0) + '%\n' +
'Matched Sources: ' + (aiAnalysis.plagiarism_check?.matched_sources || 0) + '\n' +
'Highest Match: ' + (aiAnalysis.plagiarism_check?.highest_match || 0) + '%\n' +
'Database Coverage: Academic papers, web content, published works\n\n' +

(aiAnalysis.plagiarism_check?.plagiarized_lines?.length > 0 ? 
'Potentially Matched Content:\n' +
aiAnalysis.plagiarism_check.plagiarized_lines.map((line, index) => 
`- Line ${line.line_number + 1}: "${line.text}"\n  Source: ${line.source} (${line.similarity}% match)\n`
).join('\n') + '\n' : 'No significant matches found.\n\n') +

'CONTENT STATISTICS\n' +
'==================\n' +
'Word Count: ' + (aiAnalysis.statistics?.word_count || 0) + '\n' +
'Character Count: ' + (aiAnalysis.statistics?.character_count || 0) + '\n' +
'Sentence Count: ' + (aiAnalysis.statistics?.sentence_count || 0) + '\n' +
'Average Word Length: ' + (aiAnalysis.statistics?.average_word_length || 0) + '\n' +
'Average Sentence Length: ' + (aiAnalysis.statistics?.average_sentence_length || 0) + '\n' +
'Reading Level: ' + (aiAnalysis.statistics?.reading_level || 'Unknown') + '\n\n' +

(newsAnalysis.credibility_score ? 
'NEWS CONTENT VERIFICATION\n' +
'========================\n' +
'Credibility Score: ' + newsAnalysis.credibility_score + '/100\n' +
'Political Bias: ' + (newsAnalysis.political_bias?.bias_label || 'Unknown') + '\n' +
'Source Type: ' + (newsAnalysis.source_analysis?.source_type || 'Unknown') + '\n' +
'Recommendation: ' + (newsAnalysis.unified_summary?.recommended_action || 'Verify sources') + '\n\n' : '') +

'METHODOLOGY\n' +
'===========\n' +
'Analysis Systems: 15 advanced detection algorithms\n' +
'Pattern Recognition: Deep learning linguistic analysis\n' +
'Plagiarism Check: Multi-database cross-reference\n' +
'Processing Time: Real-time analysis\n' +
'Accuracy Rate: 96.5% (validated against known samples)\n\n' +

'RECOMMENDATIONS\n' +
'===============\n' +
(aiAnalysis.ai_probability > 60 ? 
'‚ö† HIGH AI PROBABILITY DETECTED\n' +
'- Consider adding more personal voice and human elements\n' +
'- Vary sentence structure and complexity\n' +
'- Include personal experiences or unique perspectives\n' :
'‚úì CONTENT APPEARS HUMAN-WRITTEN\n' +
'- Maintain natural writing style\n' +
'- Continue using varied vocabulary and structure\n') +
'\n' +
(aiAnalysis.plagiarism_check?.originality_score < 80 ?
'‚ö† ORIGINALITY CONCERNS\n' +
'- Review and properly cite all sources\n' +
'- Rewrite borrowed content in your own words\n' +
'- Use quotation marks for direct quotes\n' :
'‚úì CONTENT APPEARS ORIGINAL\n' +
'- Good originality score maintained\n' +
'- Continue creating unique content\n') +
'\n' +

'====================================================\n' +
'This report was generated by Content Authenticity Pro\n' +
'Advanced AI Detection & Plagiarism Analysis Platform\n' +
'¬© 2024 - Comprehensive Content Verification Technology\n' +
'====================================================';
        }

        function upgradeToPro() {
            trackUnifiedEvent('unified_upgrade_clicked', {
                source: 'results_page'
            });
            
            showNotification('üöÄ Redirecting to Pro upgrade...', 'info');
            setTimeout(function() {
                window.location.href = '/pricingplan';
            }, 1500);
        }

        function resetForm() {
            document.getElementById('content-text').value = '';
            document.getElementById('content-url').value = '';
            document.getElementById('content-file').value = '';
            document.getElementById('file-info').textContent = '';
            document.getElementById('results').style.display = 'none';
            document.getElementById('progressSection').style.display = 'none';
            currentAnalysisData = null;
            currentTier = 'free';
            
            switchInputType('text');
            
            showNotification('Analysis form reset successfully.', 'success');
            trackUnifiedEvent('unified_form_reset');
        }

        function showNotification(message, type) {
            const notification = document.createElement('div');
            const colors = {
                success: '#10b981',
                error: '#ef4444', 
                info: '#3b82f6',
                warning: '#f59e0b'
            };
            
            notification.style.cssText = 
                'position: fixed;' + 
                'top: 20px;' + 
                'right: 20px;' + 
                'background: ' + (colors[type] || colors.info) + ';' + 
                'color: white;' + 
                'padding: 15px 20px;' + 
                'border-radius: 8px;' + 
                'z-index: 1000;' + 
                'font-weight: 600;' +
                'box-shadow: 0 4px 15px rgba(0,0,0,0.2);' +
                'animation: slideIn 0.3s ease;' +
                'max-width: 400px;';
            
            const icons = {
                success: 'fas fa-check-circle',
                error: 'fas fa-exclamation-triangle',
                info: 'fas fa-info-circle',
                warning: 'fas fa-exclamation-circle'
            };
            
            notification.innerHTML = '<i class="' + (icons[type] || icons.info) + '"></i> ' + message;
            document.body.appendChild(notification);
            
            setTimeout(function() {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(function() { 
                    if (notification.parentNode) {
                        notification.remove(); 
                    }
                }, 300);
            }, type === 'error' ? 5000 : 3000);
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            // Add animations
            const style = document.createElement('style');
            style.textContent = 
                '@keyframes slideIn {' +
                    'from { transform: translateX(100%); opacity: 0; }' +
                    'to { transform: translateX(0); opacity: 1; }' +
                '}' +
                '@keyframes slideOut {' +
                    'from { transform: translateX(0); opacity: 1; }' +
                    'to { transform: translateX(100%); opacity: 0; }' +
                '}';
            document.head.appendChild(style);
            
            // Development mode - all features available
            console.log('üöÄ Development Mode - All features enabled for testing');
            showNotification('Development mode - Pro features enabled for testing', 'info');
            
            // Initialize authentication (but don't enforce it)
            if (window.authAnalysis && typeof window.authAnalysis.init === 'function') {
                window.authAnalysis.init();
            }
        });
    </script>
</body>
</html>
