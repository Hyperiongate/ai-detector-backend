<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Detection & Content Analysis - Facts & Fakes AI</title>
    
    <!-- STEP 1: Add Google Analytics (with proper ID or commented out) -->
    <!-- 
    <script async src="https://www.googletagmanager.com/gtag/js?id=YOUR_ACTUAL_GA_ID"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'YOUR_ACTUAL_GA_ID');
    </script>
    -->
    
    <!-- For now, use stub gtag function to prevent errors -->
    <script>
        function gtag() {
            console.log('Analytics event:', arguments);
        }
    </script>
    
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiByeD0iOCIgZmlsbD0iIzAwN2JmZiIvPgo8cGF0aCBkPSJNOCAxMmg4djJIOHYtMnptMCA0aDEydjJIOHYtMnptMCA0aDZ2Mkg4di0yeiIgZmlsbD0id2hpdGUiLz4KPC9zdmc+">
    
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        /* Keep all the original styles from the working version */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            padding-bottom: 2rem;
        }
        
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            color: #667eea;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .nav-links {
            display: flex;
            gap: 2rem;
            align-items: center;
        }
        
        .nav-link {
            color: #4a5568;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s ease;
        }
        
        .nav-link:hover {
            color: #667eea;
        }
        
        .nav-link.active {
            color: #667eea;
            font-weight: 600;
        }
        
        .container {
            max-width: 1400px;
            margin: 2rem auto;
            padding: 0 2rem;
        }
        
        .hero-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 3rem;
            margin-bottom: 2rem;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
            text-align: center;
        }
        
        .hero-title {
            font-size: 3rem;
            font-weight: 800;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .hero-subtitle {
            font-size: 1.3rem;
            color: #666;
            margin-bottom: 2rem;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            line-height: 1.6;
        }
        
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }
        
        .feature-card {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 2rem;
            text-align: center;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
        }
        
        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.15);
        }
        
        .feature-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            display: block;
        }
        
        .feature-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 1rem;
        }
        
        .feature-desc {
            color: #666;
            line-height: 1.6;
        }
        
        .analysis-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 3rem;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
        }
        
        .input-section {
            margin-bottom: 2rem;
        }
        
        .input-group {
            margin-bottom: 1.5rem;
        }
        
        .input-label {
            display: block;
            font-weight: 600;
            color: #333;
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }
        
        .text-input {
            width: 100%;
            min-height: 200px;
            padding: 1rem;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-family: inherit;
            font-size: 1rem;
            resize: vertical;
            transition: border-color 0.3s ease;
            background: rgba(255, 255, 255, 0.9);
        }
        
        .text-input:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.1);
        }
        
        .sample-buttons {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }
        
        .sample-btn {
            padding: 0.5rem 1rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 25px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        
        .sample-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .file-upload-section {
            border: 2px dashed #007bff;
            border-radius: 10px;
            padding: 2rem;
            text-align: center;
            margin-bottom: 1.5rem;
            transition: all 0.3s ease;
            background: rgba(0, 123, 255, 0.05);
        }
        
        .file-upload-section:hover {
            border-color: #0056b3;
            background: rgba(0, 123, 255, 0.1);
        }
        
        .file-upload-section.dragover {
            border-color: #28a745;
            background: rgba(40, 167, 69, 0.1);
        }
        
        .file-input {
            display: none;
        }
        
        .file-upload-label {
            display: inline-block;
            padding: 1rem 2rem;
            background: linear-gradient(135deg, #007bff, #0056b3);
            color: white;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .file-upload-label:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .analyze-btn {
            width: 100%;
            padding: 1.2rem;
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 2rem;
        }
        
        .analyze-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(40, 167, 69, 0.3);
        }
        
        .analyze-btn:disabled {
            background: #6c757d;
            cursor: not-allowed;
            transform: none;
        }
        
        .results-section {
            display: none;
        }
        
        .result-card {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        
        .result-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .result-content {
            color: #555;
            line-height: 1.8;
        }
        
        .score-bar {
            height: 30px;
            background: #e9ecef;
            border-radius: 15px;
            overflow: hidden;
            margin: 1rem 0;
        }
        
        .score-fill {
            height: 100%;
            background: linear-gradient(90deg, #28a745, #ffc107, #dc3545);
            transition: width 1s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
        }
        
        .action-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 2rem;
            flex-wrap: wrap;
        }
        
        .action-btn {
            padding: 1rem 2rem;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #007bff, #0056b3);
            color: white;
        }
        
        .btn-success {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
        }
        
        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 2rem;
        }
        
        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #007bff;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .footer {
            text-align: center;
            padding: 2rem;
            color: white;
            margin-top: 3rem;
        }
        
        @media (max-width: 768px) {
            .hero-title {
                font-size: 2rem;
            }
            
            .hero-subtitle {
                font-size: 1.1rem;
            }
            
            .container {
                padding: 0 1rem;
            }
            
            .hero-section,
            .analysis-container {
                padding: 2rem 1.5rem;
            }
            
            .nav-links {
                display: none;
            }
            
            .features-grid {
                grid-template-columns: 1fr;
            }
            
            .sample-buttons {
                flex-direction: column;
            }
            
            .sample-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <header class="header">
        <nav class="nav-container">
            <a href="/" class="logo">
                <i class="fas fa-shield-alt"></i>
                Facts & Fakes AI
            </a>
            <div class="nav-links">
                <a href="/" class="nav-link">Home</a>
                <a href="/news" class="nav-link">News Analysis</a>
                <a href="/unified" class="nav-link active">AI Detection</a>
                <a href="/imageanalysis" class="nav-link">Image Analysis</a>
                <a href="/contact" class="nav-link">Contact</a>
            </div>
        </nav>
    </header>

    <div class="container">
        <!-- Hero Section -->
        <section class="hero-section">
            <h1 class="hero-title">AI Content Detection & Analysis</h1>
            <p class="hero-subtitle">
                Advanced AI detection technology to identify generated content, check for plagiarism, 
                and analyze writing patterns with detailed insights and explanations.
            </p>
            
            <!-- Features Grid -->
            <div class="features-grid">
                <div class="feature-card">
                    <span class="feature-icon">ü§ñ</span>
                    <h3 class="feature-title">AI Detection</h3>
                    <p class="feature-desc">Identify AI-generated content with advanced pattern recognition</p>
                </div>
                <div class="feature-card">
                    <span class="feature-icon">üìã</span>
                    <h3 class="feature-title">Plagiarism Check</h3>
                    <p class="feature-desc">Compare against billions of sources to detect copied content</p>
                </div>
                <div class="feature-card">
                    <span class="feature-icon">üìä</span>
                    <h3 class="feature-title">Writing Analysis</h3>
                    <p class="feature-desc">Detailed breakdown of writing style, readability, and quality</p>
                </div>
            </div>
        </section>

        <!-- Analysis Container -->
        <section class="analysis-container">
            <!-- Input Section -->
            <div class="input-section">
                <div class="input-group">
                    <label for="textInput" class="input-label">Enter Your Text</label>
                    <textarea 
                        id="textInput" 
                        class="text-input" 
                        placeholder="Paste your text here for analysis..."
                    ></textarea>
                    
                    <!-- Sample Text Buttons -->
                    <div class="sample-buttons">
                        <button class="sample-btn" onclick="loadSampleText('ai')">ü§ñ AI Sample</button>
                        <button class="sample-btn" onclick="loadSampleText('human')">üë§ Human Sample</button>
                        <button class="sample-btn" onclick="loadSampleText('mixed')">üîÄ Mixed Sample</button>
                    </div>
                </div>

                <!-- File Upload Section -->
                <div class="file-upload-section" id="fileUploadSection">
                    <input type="file" id="fileInput" class="file-input" accept=".txt,.pdf,.doc,.docx">
                    <label for="fileInput" class="file-upload-label">
                        üìÅ Choose File or Drag & Drop
                    </label>
                    <p style="margin-top: 1rem; color: #666; font-size: 0.9rem;">
                        Supported formats: TXT, PDF, DOC, DOCX (Max 10MB)
                    </p>
                </div>

                <!-- Analyze Button -->
                <button class="analyze-btn" id="analyzeBtn" onclick="startAnalysis()">
                    üîç Analyze Content
                </button>
            </div>

            <!-- Loading Section -->
            <div class="loading" id="loadingSection">
                <div class="spinner"></div>
                <p>Analyzing your content...</p>
            </div>

            <!-- Results Section -->
            <div class="results-section" id="resultsSection">
                <!-- AI Detection Result -->
                <div class="result-card">
                    <h2 class="result-title">
                        <span>ü§ñ</span>
                        AI Detection Results
                    </h2>
                    <div class="result-content" id="aiResults">
                        <!-- Results will be populated here -->
                    </div>
                </div>

                <!-- Plagiarism Result -->
                <div class="result-card">
                    <h2 class="result-title">
                        <span>üìã</span>
                        Plagiarism Check Results
                    </h2>
                    <div class="result-content" id="plagiarismResults">
                        <!-- Results will be populated here -->
                    </div>
                </div>

                <!-- Writing Analysis Result -->
                <div class="result-card">
                    <h2 class="result-title">
                        <span>üìä</span>
                        Writing Analysis
                    </h2>
                    <div class="result-content" id="writingResults">
                        <!-- Results will be populated here -->
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="action-buttons">
                    <button class="action-btn btn-primary" onclick="downloadReport()">
                        üìÑ Download Report
                    </button>
                    <button class="action-btn btn-success" onclick="analyzeNew()">
                        üîÑ New Analysis
                    </button>
                </div>
            </div>
        </section>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <p>&copy; 2024 Facts & Fakes AI. Professional AI Detection & Analysis.</p>
    </footer>

    <script>
        // Sample texts
        const sampleTexts = {
            ai: "The implementation of artificial intelligence in modern healthcare systems represents a paradigm shift in medical diagnostics and treatment protocols. Through sophisticated machine learning algorithms, healthcare providers can now analyze vast datasets with unprecedented accuracy, leading to improved patient outcomes and more efficient resource allocation. This technological advancement demonstrates the transformative potential of AI across various sectors of the medical industry.",
            human: "I went to the doctor yesterday and honestly, it was such a weird experience. They had this new AI thing that was supposed to help diagnose stuff, but the nurse seemed confused about how to use it. I'm not sure if it actually helped or just made things take longer. Still got my prescription though, so I guess it worked out okay in the end.",
            mixed: "Recent studies have shown that AI integration in healthcare can significantly improve diagnostic accuracy. However, many practitioners express concerns about the technology's reliability. Dr. Smith noted, 'While the AI system helps with initial screening, nothing replaces human judgment.' These mixed reactions highlight the ongoing debate about AI's role in medicine."
        };

        // Load sample text
        function loadSampleText(type) {
            document.getElementById('textInput').value = sampleTexts[type];
            // Simple analytics tracking
            gtag('event', 'sample_loaded', {
                event_category: 'interaction',
                event_label: type
            });
        }

        // File upload handling
        document.getElementById('fileInput').addEventListener('change', handleFileUpload);

        // Drag and drop
        const uploadSection = document.getElementById('fileUploadSection');
        uploadSection.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadSection.classList.add('dragover');
        });

        uploadSection.addEventListener('dragleave', () => {
            uploadSection.classList.remove('dragover');
        });

        uploadSection.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadSection.classList.remove('dragover');
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                handleFileUpload({ target: { files: files } });
            }
        });

        function handleFileUpload(event) {
            const file = event.target.files[0];
            if (!file) return;

            if (file.size > 10 * 1024 * 1024) {
                alert('File too large. Maximum size is 10MB.');
                return;
            }

            // For demo, just show file info
            alert(`File "${file.name}" selected. In production, this would extract text for analysis.`);
        }

        // Start analysis
        async function startAnalysis() {
            const text = document.getElementById('textInput').value.trim();
            
            if (!text) {
                alert('Please enter some text to analyze.');
                return;
            }

            if (text.length < 50) {
                alert('Please enter at least 50 characters for meaningful analysis.');
                return;
            }

            // Show loading
            document.getElementById('loadingSection').style.display = 'block';
            document.getElementById('resultsSection').style.display = 'none';
            document.getElementById('analyzeBtn').disabled = true;

            try {
                // Call the API
                const response = await fetch('/api/analyze-unified', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        content: text,
                        text: text,  // Support both field names
                        type: 'all'
                    })
                });

                if (!response.ok) {
                    throw new Error(`Server error: ${response.status}`);
                }

                const data = await response.json();
                displayResults(data);

            } catch (error) {
                console.error('Analysis error:', error);
                alert('Analysis failed. Please try again.');
            } finally {
                document.getElementById('loadingSection').style.display = 'none';
                document.getElementById('analyzeBtn').disabled = false;
            }
        }

        // Display results
        function displayResults(data) {
            // AI Detection Results
            if (data.ai_analysis) {
                const aiResults = `
                    <div class="score-bar">
                        <div class="score-fill" style="width: ${data.ai_analysis.ai_probability}%">
                            AI Probability: ${data.ai_analysis.ai_probability}%
                        </div>
                    </div>
                    <p><strong>Human Probability:</strong> ${data.ai_analysis.human_probability}%</p>
                    <p><strong>Confidence:</strong> High</p>
                    <h4>Key Indicators:</h4>
                    <ul>
                        <li>Vocabulary Diversity: ${data.ai_analysis.indicators.vocabulary_diversity}%</li>
                        <li>Sentence Complexity: ${data.ai_analysis.indicators.sentence_complexity}%</li>
                        <li>Coherence Score: ${data.ai_analysis.indicators.coherence_score}%</li>
                    </ul>
                `;
                document.getElementById('aiResults').innerHTML = aiResults;
            }

            // Plagiarism Results
            if (data.ai_analysis && data.ai_analysis.plagiarism_check) {
                const plagResults = `
                    <p><strong>Originality Score:</strong> ${data.ai_analysis.plagiarism_check.originality_score}%</p>
                    <p><strong>Matched Sources:</strong> ${data.ai_analysis.plagiarism_check.matched_sources}</p>
                    <p><strong>Status:</strong> ${data.ai_analysis.plagiarism_check.originality_score > 90 ? 'Original Content' : 'Some Matches Found'}</p>
                `;
                document.getElementById('plagiarismResults').innerHTML = plagResults;
            }

            // Writing Analysis Results
            if (data.ai_analysis && data.ai_analysis.statistics) {
                const writingResults = `
                    <p><strong>Word Count:</strong> ${data.ai_analysis.statistics.word_count}</p>
                    <p><strong>Character Count:</strong> ${data.ai_analysis.statistics.character_count}</p>
                    <p><strong>Average Word Length:</strong> ${data.ai_analysis.statistics.average_word_length}</p>
                    <p><strong>Reading Level:</strong> ${data.ai_analysis.statistics.reading_level}</p>
                `;
                document.getElementById('writingResults').innerHTML = writingResults;
            }

            // Show results section
            document.getElementById('resultsSection').style.display = 'block';
            document.getElementById('resultsSection').scrollIntoView({ behavior: 'smooth' });
        }

        // Download report
        function downloadReport() {
            alert('Report download feature coming soon!');
        }

        // New analysis
        function analyzeNew() {
            document.getElementById('textInput').value = '';
            document.getElementById('resultsSection').style.display = 'none';
            window.scrollTo(0, 0);
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Unified Analysis Page Ready');
        });
    </script>
</body>
</html>
