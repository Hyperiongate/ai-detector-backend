<!DOCTYPE html>
<html lang="en">  
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
    <title>NewsVerify Pro - News Verification Platform</title>
    
    <!-- Google Analytics 4 Integration -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-9CLSNV2S8Q"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-9CLSNV2S8Q');
        
        // Custom Analytics Events for News Verification Page
        function trackNewsEvent(eventName, eventData = {}) {
            gtag('event', eventName, {
                event_category: 'News_Verification',
                page_title: 'NewsVerify Pro - News Verification Platform',
                ...eventData
            });
            
            // Backend analytics tracking
            if (typeof backendAnalytics !== 'undefined') {
                backendAnalytics.track(eventName, {
                    page: 'news_verification',
                    timestamp: new Date().toISOString(),
                    ...eventData
                });
            }
        }
        
        // Track page view
        gtag('event', 'page_view', {
            page_title: 'NewsVerify Pro - News Verification Platform',
            page_location: window.location.href,
            content_group1: 'News Verification'
        });
    </script>
    
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸ“°</text></svg>">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/static/styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            line-height: 1.6;
            padding-top: 60px;
        }

        /* Beta Banner */
        .beta-banner {
            background: linear-gradient(45deg, #ff6b35, #f7931e);
            padding: 8px 0;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .beta-banner::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 3s infinite;
            transform: rotate(45deg);
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }

        .beta-content {
            position: relative;
            z-index: 2;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            color: white;
            font-weight: 600;
        }

        .beta-badge {
            background: rgba(255,255,255,0.2);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .beta-join-btn {
            background: rgba(255,255,255,0.2);
            border: 2px solid rgba(255,255,255,0.3);
            color: white;
            padding: 6px 16px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            text-decoration: none;
            font-size: 0.9rem;
        }

        .beta-join-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 10000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 5% auto;
            padding: 0;
            border-radius: 20px;
            width: 90%;
            max-width: 500px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .modal-header {
            background: rgba(255,255,255,0.1);
            padding: 2rem;
            text-align: center;
            border-bottom: 1px solid rgba(255,255,255,0.2);
        }

        .modal-header h2 {
            color: white;
            margin-bottom: 0.5rem;
            font-size: 1.8rem;
        }

        .modal-header p {
            color: rgba(255,255,255,0.8);
            font-size: 1rem;
        }

        .modal-body {
            padding: 2rem;
        }

        .modal-body .input-group {
            margin-bottom: 1rem;
        }

        .modal-body input {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.3);
            color: white;
            padding: 1rem;
            border-radius: 10px;
            width: 100%;
            font-size: 1rem;
        }

        .modal-body input::placeholder {
            color: rgba(255,255,255,0.6);
        }

        .modal-footer {
            padding: 1.5rem 2rem 2rem;
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
        }

        .btn-secondary {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 1px solid rgba(255,255,255,0.3);
            padding: 0.75rem 1.5rem;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-secondary:hover {
            background: rgba(255,255,255,0.3);
        }

        .close {
            position: absolute;
            right: 1rem;
            top: 1rem;
            color: rgba(255,255,255,0.8);
            font-size: 2rem;
            font-weight: bold;
            cursor: pointer;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .close:hover {
            background: rgba(255,255,255,0.2);
            color: white;
        }

        /* Container adjustments */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-bottom: 20px;
        }

        /* Navigation Bar */
        .nav-bar {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 15px;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .nav-links-secondary {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .nav-links-secondary a {
            color: white;
            text-decoration: none;
            padding: 10px 20px;
            border-radius: 12px;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .nav-links-secondary a:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .nav-links-secondary a.active {
            background: rgba(255, 255, 255, 0.3);
            font-weight: 600;
        }

        /* Tool Container */
        .tool-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        /* Grid layout for info sections */
        .info-sections-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }

        /* Compact dropdown sections */
        .dropdown-section.compact {
            border: 2px solid rgba(102, 126, 234, 0.15);
            border-radius: 12px;
            overflow: hidden;
            background: rgba(249, 250, 251, 0.5);
            transition: all 0.3s ease;
        }

        .dropdown-section.compact:hover {
            border-color: rgba(102, 126, 234, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.1);
        }

        .dropdown-section.compact.active {
            border-color: #667eea;
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.15);
        }

        /* Compact header styling */
        .compact-header {
            background: rgba(102, 126, 234, 0.05);
            padding: 15px 18px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: all 0.3s ease;
        }

        .compact-header:hover {
            background: rgba(102, 126, 234, 0.08);
        }

        .compact-header.open {
            background: rgba(102, 126, 234, 0.12);
            border-bottom: 2px solid rgba(102, 126, 234, 0.2);
        }

        .compact-header-content {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .compact-header-content i {
            font-size: 1.3rem;
            color: #667eea;
        }

        .compact-header-text {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .compact-title {
            font-weight: 700;
            color: #4a5568;
            font-size: 1rem;
        }

        .compact-subtitle {
            font-size: 0.85rem;
            color: #6b7280;
            font-weight: 400;
        }

        .compact-header .dropdown-icon {
            font-size: 1rem;
            color: #6b7280;
            transition: transform 0.3s ease;
        }

        .compact-header.open .dropdown-icon {
            transform: rotate(180deg);
            color: #667eea;
        }

        /* Adjust dropdown content for better visibility when opened */
        .dropdown-section.compact .dropdown-content {
            max-height: 0;
            overflow: hidden;
            padding: 0;
            background: white;
            border-top: 1px solid rgba(102, 126, 234, 0.1);
            transition: all 0.5s ease;
        }

        .dropdown-section.compact .dropdown-content.open {
            max-height: 600px;
            padding: 25px;
            overflow-y: auto;
        }

        /* Special styling for usage section */
        #usage-section .compact-header-content i {
            color: #10b981;
        }

        /* Tools Section */
        .tools-employed {
            background: linear-gradient(145deg, #f8fafc, #ffffff);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            border: 2px solid rgba(102, 126, 234, 0.1);
            position: relative;
            overflow: hidden;
        }

        .tools-employed::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #10b981, #667eea, #764ba2);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.8; }
            50% { opacity: 1; }
        }

        .tools-title {
            font-weight: 700;
            color: #4a5568;
            margin-bottom: 20px;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .tools-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        .tool-item {
            background: rgba(102, 126, 234, 0.05);
            padding: 15px 20px;
            border-radius: 12px;
            border-left: 4px solid #667eea;
            font-size: 0.95rem;
            font-weight: 600;
            color: #4a5568;
            transition: all 0.3s ease;
        }

        .tool-item:hover {
            background: rgba(102, 126, 234, 0.1);
            transform: translateY(-2px);
        }

        .tool-item i {
            margin-right: 8px;
            color: #667eea;
        }

        /* Enhanced Progress Section with Multi-stage */
        .progress-section {
            margin-bottom: 30px;
            background: linear-gradient(145deg, #f8fafc, #ffffff);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            border: 2px solid rgba(102, 126, 234, 0.1);
            position: sticky;
            top: 80px;
            z-index: 100;
            overflow: hidden;
        }

        .progress-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #667eea, #10b981, #764ba2, #667eea);
            background-size: 300% 100%;
            animation: rainbow-flow 4s ease-in-out infinite;
        }

        @keyframes rainbow-flow {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .progress-title {
            font-weight: 700;
            color: #4a5568;
            margin-bottom: 25px;
            font-size: 1.3rem;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        /* Multi-stage progress indicators */
        .progress-stages {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            padding: 0 20px;
        }

        .progress-stage {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
            position: relative;
        }

        .progress-stage:not(:last-child)::after {
            content: '';
            position: absolute;
            top: 20px;
            left: 60%;
            width: 80%;
            height: 2px;
            background: #e2e8f0;
            z-index: -1;
        }

        .progress-stage.active::after {
            background: linear-gradient(90deg, #667eea, #10b981);
        }

        .progress-stage.completed::after {
            background: #10b981;
        }

        .stage-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #e2e8f0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            margin-bottom: 8px;
            transition: all 0.3s ease;
        }

        .progress-stage.active .stage-icon {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            animation: stagePulse 1s ease-in-out infinite;
        }

        .progress-stage.completed .stage-icon {
            background: #10b981;
            color: white;
        }

        @keyframes stagePulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .stage-label {
            font-size: 0.8rem;
            color: #6b7280;
            text-align: center;
            max-width: 100px;
        }

        .progress-stage.active .stage-label {
            color: #667eea;
            font-weight: 600;
        }

        .progress-stage.completed .stage-label {
            color: #10b981;
        }

        /* Enhanced colorful progress bar */
        .progress-bar {
            background: #e2e8f0;
            height: 30px;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            border: 2px solid rgba(255, 255, 255, 0.8);
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, 
                #ff6b6b 0%, 
                #f06595 14%, 
                #cc5de8 28%, 
                #845ef7 42%, 
                #5c7cfa 56%, 
                #339af0 70%, 
                #22b8cf 84%, 
                #20c997 100%);
            border-radius: 13px;
            width: 0%;
            transition: width 0.5s ease;
            position: relative;
            background-size: 200% 100%;
            animation: gradient-shift 3s ease-in-out infinite;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
        }

        @keyframes gradient-shift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255,255,255,0.6), 
                transparent);
            animation: shine 2s infinite;
        }

        @keyframes shine {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        /* Progress percentage display */
        .progress-percentage {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-weight: bold;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            font-size: 1.1rem;
            z-index: 2;
        }

        /* Spinning icon and status text */
        .progress-status {
            text-align: center;
            color: #6b7280;
            font-size: 1.1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .progress-spinner {
            display: inline-block;
            width: 24px;
            height: 24px;
            border: 3px solid transparent;
            border-top: 3px solid #667eea;
            border-right: 3px solid #10b981;
            border-bottom: 3px solid #764ba2;
            border-left: 3px solid #f59e0b;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Input Section */
        .input-section {
            margin-bottom: 30px;
        }

        .input-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid #e2e8f0;
        }

        .input-tab {
            padding: 12px 24px;
            border: none;
            background: #f8fafc;
            color: #6b7280;
            font-weight: 600;
            cursor: pointer;
            border-radius: 10px 10px 0 0;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .input-tab:hover {
            background: #f1f5f9;
            color: #374151;
        }

        .input-tab.active {
            background: white;
            color: #667eea;
            border-bottom: 2px solid #667eea;
            transform: translateY(2px);
        }

        .input-content {
            display: none;
        }

        .input-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Enhanced Tab Explanations */
        .tab-explanation {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.05), rgba(102, 126, 234, 0.08));
            border: 2px solid rgba(102, 126, 234, 0.2);
            border-radius: 15px;
            padding: 20px 25px;
            margin-bottom: 25px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.1);
        }

        .tab-explanation::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 5px;
            height: 100%;
            background: linear-gradient(180deg, #667eea, #764ba2);
        }

        .tab-explanation h3 {
            color: #667eea;
            font-size: 1.3rem;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 700;
        }

        .tab-explanation p {
            color: #4b5563;
            font-size: 0.95rem;
            margin-bottom: 10px;
            line-height: 1.6;
        }

        .tab-explanation p strong {
            color: #1f2937;
            font-weight: 700;
        }

        .tab-explanation ul {
            list-style: none;
            padding-left: 0;
            margin-top: 15px;
        }

        .tab-explanation li {
            color: #4b5563;
            margin-bottom: 8px;
            padding-left: 25px;
            position: relative;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .tab-explanation li::before {
            content: 'â†’';
            position: absolute;
            left: 0;
            color: #667eea;
            font-weight: bold;
            font-size: 1.1rem;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 700;
            color: #4a5568;
            font-size: 1rem;
        }

        .input-group input, .input-group textarea {
            width: 100%;
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: white;
            font-family: inherit;
        }

        .input-group input:focus, .input-group textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .input-group textarea {
            min-height: 120px;
            resize: vertical;
            line-height: 1.5;
        }

        /* Button Styles */
        .button-group {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-secondary {
            background: #6b7280;
            color: white;
        }

        .btn-secondary:hover {
            background: #4b5563;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            flex: 1;
            justify-content: center;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .btn-test {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
        }

        .btn-test:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(16, 185, 129, 0.3);
        }

        /* Results Section */
        .results {
            display: none;
            margin-top: 30px;
            animation: fadeInUp 0.5s ease;
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Summary Banner Styles */
        .summary-banner {
            background: linear-gradient(135deg, #ffffff, #f8fafc);
            border-radius: 20px;
            padding: 35px;
            margin-bottom: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border: 2px solid rgba(102, 126, 234, 0.15);
            position: relative;
            overflow: hidden;
        }

        .summary-banner::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, #10b981, #667eea, #764ba2);
            animation: pulse 3s infinite;
        }

        .credibility-header {
            display: flex;
            align-items: center;
            gap: 30px;
            margin-bottom: 25px;
        }

        /* Enhanced Credibility Score Container */
        .credibility-score-container {
            flex-shrink: 0;
            position: relative;
        }

        /* Enhanced Credibility Score Circle */
        .credibility-score-circle {
            width: 180px;
            height: 180px;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            flex-shrink: 0;
            background: conic-gradient(
                from 0deg,
                #ff6b6b 0deg,
                #feca57 90deg,
                #48dbfb 180deg,
                #1dd1a1 270deg,
                #ff6b6b 360deg
            );
            animation: rotateGradient 10s linear infinite;
        }

        @keyframes rotateGradient {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .credibility-score-circle::before {
            content: '';
            position: absolute;
            width: 150px;
            height: 150px;
            background: white;
            border-radius: 50%;
            z-index: 1;
        }

        .score-number {
            font-size: 3.5rem;
            font-weight: 900;
            color: #1f2937;
            z-index: 2;
            text-shadow: 0 0 20px rgba(102, 126, 234, 0.8);
        }

        .score-label {
            font-size: 0.9rem;
            color: #6b7280;
            font-weight: 600;
            z-index: 2;
        }

        /* Score Indicator Needle */
        .score-indicator {
            position: absolute;
            width: 100%;
            height: 100%;
            z-index: 3;
            pointer-events: none;
        }

        .score-indicator::after {
            content: '';
            position: absolute;
            top: 10px;
            left: 50%;
            width: 4px;
            height: 30px;
            background: #1f2937;
            transform-origin: center 80px;
            transform: translateX(-50%) rotate(var(--score-rotation));
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.8);
        }

        /* Quick Action Links */
        .quick-actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 2rem;
        }

        .quick-action {
            padding: 0.5rem 1rem;
            background: rgba(102, 126, 234, 0.1);
            border: 1px solid rgba(102, 126, 234, 0.3);
            border-radius: 8px;
            color: #667eea;
            text-decoration: none;
            font-size: 0.875rem;
            transition: all 0.3s ease;
        }

        .quick-action:hover {
            background: rgba(102, 126, 234, 0.2);
            transform: translateY(-2px);
        }

        .credibility-details {
            flex: 1;
        }

        .credibility-title {
            font-size: 1.8rem;
            font-weight: 800;
            color: #1f2937;
            margin-bottom: 10px;
        }

        .credibility-subtitle {
            font-size: 1.1rem;
            color: #6b7280;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .methodology-note {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: rgba(102, 126, 234, 0.1);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            color: #667eea;
            font-weight: 600;
        }

        .pro-upgrade-note {
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), rgba(217, 119, 6, 0.1));
            border: 2px solid rgba(245, 158, 11, 0.3);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            text-align: center;
        }

        .pro-upgrade-note p {
            color: #d97706;
            font-weight: 600;
            font-size: 1.05rem;
            margin-bottom: 12px;
        }

        .pro-upgrade-note button {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .pro-upgrade-note button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(245, 158, 11, 0.4);
        }

        /* Analysis Section Styles */
        .analysis-section {
            background: white;
            border-radius: 15px;
            margin-bottom: 20px;
            overflow: hidden;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
            border: 2px solid rgba(102, 126, 234, 0.1);
            transition: all 0.3s ease;
        }

        .analysis-section.expanded {
            border-color: #667eea;
            box-shadow: 0 8px 30px rgba(102, 126, 234, 0.15);
        }

        .analysis-header {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.05), rgba(102, 126, 234, 0.1));
            padding: 25px 30px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: all 0.3s ease;
        }

        .analysis-header:hover {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.08), rgba(102, 126, 234, 0.15));
        }

        .analysis-header.expanded {
            border-bottom: 2px solid rgba(102, 126, 234, 0.2);
        }

        .analysis-header-content {
            display: flex;
            align-items: center;
            gap: 20px;
            flex: 1;
        }

        .analysis-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            background: white;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        }

        .analysis-title-group {
            flex: 1;
        }

        .analysis-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 5px;
        }

        .analysis-summary {
            font-size: 0.95rem;
            color: #6b7280;
        }

        .expand-icon {
            font-size: 1.2rem;
            color: #667eea;
            transition: transform 0.3s ease;
        }

        .analysis-header.expanded .expand-icon {
            transform: rotate(180deg);
        }

        .analysis-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease;
        }

        .analysis-content.expanded {
            max-height: 2000px;
        }

        .analysis-body {
            padding: 30px;
        }

        /* Analysis explanation box styles */
        .analysis-explanation {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.05), rgba(99, 102, 241, 0.1));
            border: 2px solid rgba(99, 102, 241, 0.2);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
            position: relative;
            overflow: hidden;
        }

        .analysis-explanation::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 5px;
            height: 100%;
            background: linear-gradient(180deg, #6366f1, #8b5cf6);
        }

        .analysis-explanation-icon {
            font-size: 1.3rem;
            color: #6366f1;
            margin-right: 10px;
        }

        .analysis-explanation-text {
            color: #4b5563;
            font-size: 1.05rem;
            line-height: 1.6;
            font-weight: 500;
        }

        /* NEW Political Bias Compass Design */
        .bias-compass-container {
            margin: 30px 0;
            padding: 20px;
            text-align: center;
        }

        .bias-compass-title {
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 30px;
            font-size: 1.4rem;
            text-align: center;
        }

        .bias-compass {
            position: relative;
            width: 300px;
            height: 300px;
            margin: 0 auto;
        }

        .compass-circle {
            position: absolute;
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .compass-outer {
            width: 300px;
            height: 300px;
            background: linear-gradient(45deg, #3b82f6 0%, #10b981 25%, #fbbf24 50%, #f59e0b 75%, #ef4444 100%);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
        }

        .compass-inner {
            width: 200px;
            height: 200px;
            background: white;
            box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.1);
        }

        .compass-center {
            width: 80px;
            height: 80px;
            background: #f3f4f6;
            font-weight: 900;
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #1f2937;
        }

        .compass-labels {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
        }

        .compass-label {
            position: absolute;
            font-weight: 700;
            font-size: 0.9rem;
            color: #1f2937;
            background: white;
            padding: 5px 15px;
            border-radius: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .compass-label.left {
            top: 50%;
            left: -20px;
            transform: translateY(-50%);
        }

        .compass-label.right {
            top: 50%;
            right: -20px;
            transform: translateY(-50%);
        }

        .compass-label.far-left {
            top: 20%;
            left: 10%;
        }

        .compass-label.far-right {
            top: 20%;
            right: 10%;
        }

        .compass-label.center {
            bottom: -40px;
            left: 50%;
            transform: translateX(-50%);
        }

        .compass-needle {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 4px;
            height: 120px;
            background: #1f2937;
            transform-origin: center bottom;
            transform: translate(-50%, -100%) rotate(0deg);
            transition: transform 1s ease;
            z-index: 10;
        }

        .compass-needle::before {
            content: '';
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 15px solid transparent;
            border-right: 15px solid transparent;
            border-bottom: 30px solid #1f2937;
        }

        .bias-position-badge {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 12px 25px;
            border-radius: 30px;
            font-weight: 700;
            font-size: 1.2rem;
            margin-top: 30px;
            display: inline-block;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        /* Enhanced Cross-Source Comparison */
        .verification-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.05), rgba(102, 126, 234, 0.1));
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            border: 2px solid rgba(102, 126, 234, 0.2);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.2);
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 900;
            color: #667eea;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #6b7280;
            font-weight: 600;
        }

        .stat-icon {
            font-size: 2rem;
            color: #667eea;
            margin-bottom: 10px;
        }

        /* Emotional Language Meter */
        .emotion-meter-container {
            margin: 30px 0;
        }

        .emotion-meter {
            background: #e5e7eb;
            height: 40px;
            border-radius: 20px;
            overflow: hidden;
            position: relative;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .emotion-fill {
            height: 100%;
            background: linear-gradient(90deg, #10b981 0%, #fbbf24 50%, #ef4444 100%);
            border-radius: 20px;
            transition: width 1s ease;
            position: relative;
        }

        .emotion-marker {
            position: absolute;
            top: -10px;
            transform: translateX(-50%);
            width: 4px;
            height: 60px;
            background: #1f2937;
        }

        .emotion-marker::before {
            content: attr(data-value);
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            background: #1f2937;
            color: white;
            padding: 4px 12px;
            border-radius: 15px;
            font-weight: 700;
            font-size: 0.9rem;
        }

        .emotion-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            color: #6b7280;
            font-size: 0.85rem;
            font-weight: 600;
        }

        /* Smaller detail cards */
        .source-details-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .source-detail-card {
            background: rgba(249, 250, 251, 0.5);
            border: 2px solid rgba(102, 126, 234, 0.1);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .source-detail-card:hover {
            background: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        }

        .detail-icon {
            width: 30px;
            height: 30px;
            margin: 0 auto 8px;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(102, 126, 234, 0.2));
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
        }

        .detail-value {
            font-size: 1.3rem;
            font-weight: 800;
            color: #1f2937;
            margin-bottom: 5px;
        }

        .detail-label {
            font-size: 0.85rem;
            color: #6b7280;
            font-weight: 600;
        }

        /* Enhanced Transparency Explanation */
        .transparency-breakdown {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.05), rgba(16, 185, 129, 0.1));
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            border: 2px solid rgba(16, 185, 129, 0.2);
        }

        .transparency-item {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
            padding: 10px;
            background: white;
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .transparency-item:hover {
            transform: translateX(5px);
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        }

        .transparency-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            flex-shrink: 0;
        }

        .transparency-icon.positive {
            background: rgba(16, 185, 129, 0.2);
            color: #059669;
        }

        .transparency-icon.negative {
            background: rgba(239, 68, 68, 0.2);
            color: #dc2626;
        }

        .transparency-text {
            flex: 1;
        }

        .transparency-title {
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 2px;
        }

        .transparency-description {
            font-size: 0.9rem;
            color: #6b7280;
            line-height: 1.4;
        }

        /* NEW Timeline & Currency Analysis Styles */
        .timeline-visualization {
            margin: 30px 0;
            position: relative;
        }

        .timeline-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .timeline-title {
            font-size: 1.8rem;
            font-weight: 800;
            color: #1f2937;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #f97316, #ea580c);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .timeline-stats {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin-bottom: 40px;
        }

        .timeline-stat {
            text-align: center;
            position: relative;
        }

        .timeline-stat-number {
            font-size: 3rem;
            font-weight: 900;
            color: #f97316;
            display: block;
            line-height: 1;
            margin-bottom: 5px;
            animation: countUp 2s ease-out;
        }

        @keyframes countUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .timeline-stat-label {
            color: #6b7280;
            font-weight: 600;
            font-size: 1rem;
        }

        .timeline-main {
            position: relative;
            padding: 40px 0;
            background: linear-gradient(135deg, rgba(249, 115, 22, 0.05), rgba(249, 115, 22, 0.1));
            border-radius: 20px;
            border: 2px solid rgba(249, 115, 22, 0.2);
            overflow: hidden;
        }

        .timeline-line {
            position: absolute;
            top: 50%;
            left: 5%;
            right: 5%;
            height: 4px;
            background: linear-gradient(90deg, #f97316, #ea580c);
            transform: translateY(-50%);
            z-index: 1;
        }

        .timeline-events {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 5%;
            position: relative;
            z-index: 2;
        }

        .timeline-event {
            text-align: center;
            position: relative;
            animation: timelinePulse 3s ease-in-out infinite;
            animation-delay: calc(var(--index) * 0.2s);
        }

        @keyframes timelinePulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .timeline-event-icon {
            width: 80px;
            height: 80px;
            background: white;
            border: 4px solid #f97316;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            margin: 0 auto 10px;
            box-shadow: 0 5px 20px rgba(249, 115, 22, 0.3);
            position: relative;
        }

        .timeline-event-icon::before {
            content: '';
            position: absolute;
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(249, 115, 22, 0.2), transparent);
            animation: ripple 2s ease-in-out infinite;
            animation-delay: calc(var(--index) * 0.2s);
        }

        @keyframes ripple {
            0% { transform: scale(0.8); opacity: 1; }
            100% { transform: scale(1.5); opacity: 0; }
        }

        .timeline-event-date {
            font-weight: 700;
            color: #ea580c;
            font-size: 1.1rem;
            margin-bottom: 5px;
        }

        .timeline-event-label {
            color: #6b7280;
            font-size: 0.9rem;
        }

        .currency-indicator {
            margin-top: 40px;
            text-align: center;
        }

        .currency-meter {
            width: 300px;
            height: 150px;
            margin: 0 auto 20px;
            position: relative;
            background: linear-gradient(135deg, #ef4444 0%, #f59e0b 33%, #fbbf24 66%, #10b981 100%);
            border-radius: 150px 150px 0 0;
            overflow: hidden;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
        }

        .currency-needle {
            position: absolute;
            bottom: 0;
            left: 50%;
            width: 4px;
            height: 140px;
            background: #1f2937;
            transform-origin: bottom center;
            transform: translateX(-50%) rotate(0deg);
            transition: transform 1s ease;
            z-index: 10;
        }

        .currency-needle::before {
            content: '';
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            width: 30px;
            height: 30px;
            background: #1f2937;
            border-radius: 50%;
        }

        .currency-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            padding: 0 20px;
        }

        .currency-label {
            font-weight: 600;
            font-size: 0.9rem;
            color: #6b7280;
        }

        .currency-badge {
            display: inline-block;
            background: linear-gradient(135deg, #f97316, #ea580c);
            color: white;
            padding: 12px 30px;
            border-radius: 30px;
            font-weight: 700;
            font-size: 1.2rem;
            margin-top: 20px;
            box-shadow: 0 5px 20px rgba(249, 115, 22, 0.3);
        }

        .temporal-insights {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-top: 30px;
        }

        .temporal-insight {
            background: white;
            padding: 20px;
            border-radius: 15px;
            border: 2px solid rgba(249, 115, 22, 0.2);
            transition: all 0.3s ease;
        }

        .temporal-insight:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(249, 115, 22, 0.2);
        }

        .temporal-insight-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .temporal-insight-title {
            font-weight: 700;
            color: #ea580c;
            margin-bottom: 5px;
        }

        .temporal-insight-text {
            color: #6b7280;
            font-size: 0.95rem;
            line-height: 1.5;
        }

        /* Claims Section Styles */
        .claims-container {
            margin-top: 30px;
        }

        .claims-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }

        .claims-column {
            background: rgba(249, 250, 251, 0.5);
            border-radius: 12px;
            padding: 25px;
            border: 2px solid rgba(102, 126, 234, 0.1);
        }

        .claims-column.unsupported {
            border-color: rgba(239, 68, 68, 0.2);
            background: rgba(254, 242, 242, 0.3);
        }

        .claims-column.supported {
            border-color: rgba(16, 185, 129, 0.2);
            background: rgba(236, 253, 245, 0.3);
        }

        .claims-title {
            font-weight: 700;
            font-size: 1.1rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .claims-title i {
            font-size: 1.2rem;
        }

        .unsupported .claims-title {
            color: #dc2626;
        }

        .supported .claims-title {
            color: #059669;
        }

        .claims-count {
            background: white;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.85rem;
            font-weight: 700;
        }

        .claim-item {
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 12px;
            font-size: 0.95rem;
            color: #4b5563;
            border: 1px solid rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .claim-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .view-claims-btn {
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
            border: 2px solid rgba(102, 126, 234, 0.2);
            padding: 10px 20px;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin-top: 10px;
        }

        .view-claims-btn:hover {
            background: rgba(102, 126, 234, 0.2);
            transform: translateY(-2px);
        }

        /* Source Comparison Styles */
        .comparison-chart-container {
            margin: 30px 0;
        }

        .comparison-items {
            display: grid;
            gap: 15px;
            margin-top: 20px;
        }

        .comparison-item {
            background: rgba(249, 250, 251, 0.5);
            border: 2px solid rgba(102, 126, 234, 0.1);
            border-radius: 12px;
            padding: 20px;
            display: grid;
            grid-template-columns: auto 1fr auto;
            align-items: center;
            gap: 20px;
            transition: all 0.3s ease;
        }

        .comparison-item:hover {
            background: white;
            border-color: rgba(102, 126, 234, 0.2);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
        }

        .outlet-logo {
            width: 50px;
            height: 50px;
            border-radius: 10px;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.2rem;
            color: #667eea;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .outlet-info {
            flex: 1;
        }

        .outlet-name {
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 5px;
        }

        .coverage-type {
            font-size: 0.9rem;
            color: #6b7280;
        }

        .similarity-badge {
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 0.9rem;
        }

        /* Additional Findings Styles */
        .findings-grid {
            display: grid;
            gap: 20px;
            margin-top: 30px;
        }

        .finding-card {
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.05), rgba(217, 119, 6, 0.05));
            border: 2px solid rgba(245, 158, 11, 0.2);
            border-radius: 12px;
            padding: 25px;
            position: relative;
            overflow: hidden;
        }

        .finding-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 5px;
            height: 100%;
            background: linear-gradient(180deg, #f59e0b, #d97706);
        }

        .finding-title {
            font-weight: 700;
            color: #92400e;
            margin-bottom: 10px;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .finding-description {
            color: #78350f;
            line-height: 1.6;
        }

        /* Enhanced Report Summary Section */
        .report-summary {
            background: linear-gradient(135deg, #ffffff, #f8fafc);
            border-radius: 20px;
            padding: 40px;
            margin-top: 40px;
            margin-bottom: 30px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.1);
            border: 2px solid rgba(102, 126, 234, 0.15);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .report-summary::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, #667eea, #764ba2, #ec4899);
            animation: shimmer 3s infinite;
        }

        .report-summary h3 {
            font-size: 2rem;
            font-weight: 800;
            margin-bottom: 30px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .summary-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 25px;
            margin-bottom: 35px;
        }

        .summary-stat {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.05), rgba(102, 126, 234, 0.1));
            border: 2px solid rgba(102, 126, 234, 0.2);
            border-radius: 15px;
            padding: 25px;
            transition: all 0.3s ease;
        }

        .summary-stat:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.2);
        }

        .summary-stat-value {
            font-size: 2.2rem;
            font-weight: 900;
            margin-bottom: 8px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .summary-stat-label {
            color: #6b7280;
            font-size: 0.95rem;
            font-weight: 600;
        }

        .report-actions {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-top: 30px;
        }

        .report-action {
            padding: 15px 35px;
            border-radius: 15px;
            font-weight: 700;
            text-decoration: none;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            font-size: 1.05rem;
            cursor: pointer;
            border: none;
        }

        .report-action.primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.3);
        }

        .report-action.secondary {
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
            border: 2px solid rgba(102, 126, 234, 0.3);
        }

        .report-action:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }

        /* Notification styles */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 8px;
            z-index: 10000;
            max-width: 400px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            display: none;
            animation: slideIn 0.3s ease;
        }

        .notification.success {
            background: #10b981;
            color: white;
        }

        .notification.error {
            background: #ef4444;
            color: white;
        }

        .notification.info {
            background: #667eea;
            color: white;
        }

        @keyframes slideIn {
            from { transform: translateX(100px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* Claims Modal Styles */
        #claimsModal .modal-content {
            background: white;
            color: #333;
            max-width: 800px;
        }

        #claimsModal .modal-header {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        #claimsModal .modal-header h2 {
            color: white;
        }

        #claimsModal .modal-body {
            padding: 2rem;
            max-height: 500px;
            overflow-y: auto;
        }

        .claim-modal-item {
            background: rgba(249, 250, 251, 0.8);
            border-left: 4px solid #667eea;
            padding: 20px;
            margin-bottom: 15px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .claim-modal-item:hover {
            background: white;
            transform: translateX(5px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }

        .claim-number {
            color: #667eea;
            font-weight: bold;
            font-size: 1.1rem;
            margin-bottom: 8px;
        }

        .claim-text {
            color: #1f2937;
            font-size: 1.05rem;
            line-height: 1.6;
            margin-bottom: 12px;
            font-style: italic;
        }

        .claim-analysis {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-top: 10px;
            border: 1px solid rgba(102, 126, 234, 0.2);
        }

        .claim-analysis-title {
            font-weight: 700;
            color: #667eea;
            margin-bottom: 8px;
            font-size: 0.95rem;
        }

        .claim-reason {
            color: #4b5563;
            font-size: 0.95rem;
            line-height: 1.5;
        }

        /* Back to Top Button */
        .back-to-top {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.2rem;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 100;
            border: none;
        }

        .back-to-top.visible {
            opacity: 1;
            visibility: visible;
        }

        .back-to-top:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }

        /* Claim Progress Animation */
        .claim-progress {
            display: flex;
            align-items: center;
            gap: 15px;
            margin: 15px 0;
        }

        .claim-progress-bar {
            flex: 1;
            height: 8px;
            background: #e2e8f0;
            border-radius: 4px;
            overflow: hidden;
        }

        .claim-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #f59e0b, #d97706);
            width: 0%;
            transition: width 0.5s ease;
        }

        .claim-counter {
            display: inline-block;
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 1.1rem;
            margin: 20px 0;
        }

        /* Enhanced Author Card Styles */
        .author-card {
            background: linear-gradient(135deg, #ffffff, #f8fafc);
            border-radius: 20px;
            padding: 30px;
            margin: 20px 0;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border: 2px solid rgba(102, 126, 234, 0.15);
            position: relative;
            overflow: hidden;
        }

        .author-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #667eea, #764ba2);
        }

        .author-header {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 25px;
        }

        .author-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            color: white;
            font-weight: bold;
            position: relative;
            flex-shrink: 0;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .verified-badge {
            position: absolute;
            bottom: -5px;
            right: -5px;
            background: #1DA1F2;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 3px solid white;
            font-size: 0.8rem;
        }

        .author-info {
            flex: 1;
        }

        .author-name {
            font-size: 1.4rem;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 5px;
        }

        .author-outlet {
            color: #6b7280;
            font-size: 1rem;
            margin-bottom: 5px;
        }

        .verified-text {
            color: #1DA1F2;
            font-size: 0.9rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .author-score {
    text-align: center;
    position: relative;
}

.score-circle {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(102, 126, 234, 0.2));
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    border: 3px solid #667eea;
    position: relative;
    cursor: help;
}

.score-circle:hover::after {
    content: attr(data-tooltip);
    position: absolute;
    bottom: -40px;
    left: 50%;
    transform: translateX(-50%);
    background: #1f2937;
    color: white;
    padding: 8px 12px;
    border-radius: 8px;
    font-size: 0.8rem;
    white-space: nowrap;
    z-index: 1000;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
}

.score-number {
    font-size: 1.6rem;
    font-weight: 900;
    color: #667eea;
    line-height: 1;
}

.score-label {
    font-size: 0.7rem;
    color: #6b7280;
    font-weight: 600;
    line-height: 1;
}
            font-size: 0.75rem;
            color: #6b7280;
            font-weight: 600;
        }

        .author-metrics {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 25px;
        }

        .author-metric {
            text-align: center;
            padding: 15px;
            background: rgba(102, 126, 234, 0.05);
            border-radius: 12px;
            transition: all 0.3s ease;
            border: 1px solid rgba(102, 126, 234, 0.1);
        }

        .author-metric:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.2);
            background: rgba(102, 126, 234, 0.1);
        }

        .metric-value {
            font-size: 1.5rem;
            font-weight: 800;
            color: #667eea;
            margin-bottom: 5px;
        }

        .metric-label {
            font-size: 0.85rem;
            color: #6b7280;
            font-weight: 600;
        }

        .author-expertise {
            margin-bottom: 25px;
        }

        .author-expertise h4 {
            color: #1f2937;
            font-weight: 700;
            margin-bottom: 15px;
        }

        .expertise-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .expertise-tag {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(102, 126, 234, 0.15));
            color: #667eea;
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            border: 1px solid rgba(102, 126, 234, 0.3);
        }

        .author-transparency {
            background: rgba(16, 185, 129, 0.05);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(16, 185, 129, 0.2);
        }
.author-links {
    margin-top: 20px;
    padding-top: 20px;
    border-top: 1px solid rgba(102, 126, 234, 0.2);
}

.author-links h4 {
    color: #1f2937;
    font-weight: 700;
    margin-bottom: 15px;
    font-size: 1rem;
}

.author-links-grid {
    display: flex;
    gap: 12px;
    flex-wrap: wrap;
}

.author-link {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    background: rgba(102, 126, 234, 0.05);
    padding: 8px 16px;
    border-radius: 25px;
    text-decoration: none;
    color: #667eea;
    font-weight: 600;
    font-size: 0.9rem;
    transition: all 0.3s ease;
    border: 1px solid rgba(102, 126, 234, 0.2);
}

.author-link:hover {
    background: rgba(102, 126, 234, 0.15);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(102, 126, 234, 0.2);
}

.author-link i {
    font-size: 1.1rem;
}
        .author-transparency h4 {
            color: #059669;
            font-weight: 700;
            margin-bottom: 15px;
        }

        .transparency-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .transparency-indicator {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            background: white;
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .transparency-indicator.disclosed {
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        .transparency-indicator.undisclosed {
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        .transparency-indicator i {
            font-size: 1.2rem;
        }

        .transparency-indicator.disclosed i {
            color: #10b981;
        }

        .transparency-indicator.undisclosed i {
            color: #ef4444;
        }

        /* Enhanced Transparency Score Section */
        .enhanced-transparency-section {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.05), rgba(16, 185, 129, 0.1));
            border-radius: 20px;
            padding: 30px;
            margin: 20px 0;
            border: 2px solid rgba(16, 185, 129, 0.2);
        }

        .transparency-overview {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .transparency-score-visual {
            text-align: center;
        }

        .transparency-meter {
            width: 180px;
            height: 180px;
            margin: 0 auto 20px;
            position: relative;
        }

        .transparency-details {
            display: grid;
            gap: 20px;
        }

        .transparency-category {
            background: white;
            padding: 20px;
            border-radius: 12px;
            border: 1px solid rgba(16, 185, 129, 0.2);
        }

        .category-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .category-title {
            font-weight: 700;
            color: #059669;
        }

        .category-score {
            background: rgba(16, 185, 129, 0.1);
            padding: 4px 12px;
            border-radius: 15px;
            font-weight: 600;
            color: #059669;
        }

        .category-items {
            display: grid;
            gap: 8px;
        }

        .category-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
            color: #4b5563;
        }

        @media (max-width: 1024px) {
            .info-sections-grid {
                grid-template-columns: 1fr;
            }
            
            .claims-grid {
                grid-template-columns: 1fr;
            }

            .verification-stats {
                grid-template-columns: 1fr;
            }

            .temporal-insights {
                grid-template-columns: 1fr;
            }
            
            .transparency-overview {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            body {
                padding-top: 60px;
            }
            
            .container {
                padding: 15px;
            }
            
            .tool-container {
                padding: 25px;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            .button-group .btn {
                width: 100%;
                justify-content: center;
            }
            
            .nav-links-secondary {
                flex-direction: column;
                gap: 10px;
            }
            
            .tools-grid {
                grid-template-columns: 1fr;
            }
            
            .data-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .credibility-header {
                flex-direction: column;
                text-align: center;
                gap: 20px;
            }

            .beta-content {
                flex-direction: column;
                gap: 8px;
            }

            .modal-content {
                margin: 10% auto;
                width: 95%;
            }

            .modal-footer {
                flex-direction: column;
            }
            
            /* Progress section on mobile */
            .progress-section {
                position: relative;
                top: auto;
            }

            .progress-stages {
                padding: 0 10px;
            }

            .stage-label {
                font-size: 0.7rem;
                max-width: 80px;
            }

            .back-to-top {
                bottom: 20px;
                right: 20px;
                width: 40px;
                height: 40px;
            }

            .info-sections-grid {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .compact-header {
                padding: 12px 15px;
            }
            
            .compact-title {
                font-size: 0.95rem;
            }
            
            .compact-subtitle {
                font-size: 0.8rem;
            }
            
            .source-details-grid {
                grid-template-columns: 1fr;
            }
            
            .comparison-items {
                gap: 10px;
            }
            
            .comparison-item {
                grid-template-columns: 1fr;
                text-align: center;
                gap: 10px;
            }

            .bias-compass {
                width: 250px;
                height: 250px;
            }

            .compass-outer {
                width: 250px;
                height: 250px;
            }

            .compass-inner {
                width: 160px;
                height: 160px;
            }

            .compass-center {
                width: 60px;
                height: 60px;
                font-size: 1.5rem;
            }

            .timeline-stats {
                flex-direction: column;
                gap: 20px;
            }

            .timeline-events {
                flex-direction: column;
                gap: 30px;
            }

            .currency-meter {
                width: 250px;
                height: 125px;
            }

            .credibility-score-circle {
                width: 140px;
                height: 140px;
            }

            .credibility-score-circle::before {
                width: 110px;
                height: 110px;
            }

            .score-number {
                font-size: 2.5rem;
            }

            .summary-stats {
                grid-template-columns: 1fr;
            }

            .report-actions {
                flex-direction: column;
                width: 100%;
            }

            .report-action {
                width: 100%;
                justify-content: center;
            }
            
            .author-header {
                flex-direction: column;
                text-align: center;
            }
            
            .author-metrics {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    {% include 'header.html' %}

    <!-- Beta Banner -->
    <div class="beta-banner">
        <div class="beta-content">
            <span class="beta-badge">BETA</span>
            <span>ðŸš€ The world's ONLY platform built specifically for news verification - Join our beta!</span>
            <button class="beta-join-btn" onclick="openBetaModal()">Join Beta</button>
        </div>
    </div>

    <div class="container">
        <div class="header">
            <h1><i class="fas fa-shield-alt"></i> NewsVerify Pro</h1>
            <p>Professional News Verification Engine â€¢ Advanced political bias detection, source credibility scoring, and cross-reference verification</p>
            <p style="font-size: 0.95rem; opacity: 0.8;">The World's First AI Platform Built Specifically for News Verification & Media Analysis</p>
        </div>

        <nav class="nav-bar">
            <div class="nav-links-secondary">
                <a href="/"><i class="fas fa-home"></i> Home</a>
                <a href="/news" class="active"><i class="fas fa-newspaper"></i> News Verification</a>
                <a href="/unified"><i class="fas fa-search"></i> Content Authenticity</a>
                <a href="/imageanalysis"><i class="fas fa-image"></i> AI Image Analysis</a>
                <a href="/missionstatement"><i class="fas fa-bullseye"></i> Our Mission</a>
                <a href="/pricingplan"><i class="fas fa-tags"></i> Pricing</a>
            </div>
        </nav>

        <div class="tool-container">
            <!-- Compact Collapsible Information Sections -->
            <div class="info-sections-grid">
                <div class="dropdown-section compact" id="methodologies-section">
                    <div class="dropdown-header compact-header" onclick="toggleDropdown(this, 'info')">
                        <div class="compact-header-content">
                            <i class="fas fa-cogs"></i>
                            <div class="compact-header-text">
                                <span class="compact-title">12 Analysis Methods</span>
                                <span class="compact-subtitle">Advanced verification systems</span>
                            </div>
                        </div>
                        <i class="fas fa-chevron-down dropdown-icon"></i>
                    </div>
                    <div class="dropdown-content">
                        <div class="tools-employed" style="border: none; margin: 0;">
                            <div class="tools-grid">
                                <div class="tool-item">
                                    <i class="fas fa-balance-scale"></i> Real-Time Political Bias Detection
                                </div>
                                <div class="tool-item">
                                    <i class="fas fa-check-circle"></i> Multi-Source Fact Verification
                                </div>
                                <div class="tool-item">
                                    <i class="fas fa-database"></i> 500+ News Source Credibility Database
                                </div>
                                <div class="tool-item">
                                    <i class="fas fa-search"></i> Cross-Source Verification Network
                                </div>
                                <div class="tool-item">
                                    <i class="fas fa-shield-alt"></i> Misinformation Pattern Recognition
                                </div>
                                <div class="tool-item">
                                    <i class="fas fa-network-wired"></i> Multi-Outlet Story Comparison
                                </div>
                                <div class="tool-item">
                                    <i class="fas fa-chart-line"></i> Journalism Quality Scoring
                                </div>
                                <div class="tool-item">
                                    <i class="fas fa-clock"></i> Timeline & Event Verification
                                </div>
                                <div class="tool-item">
                                    <i class="fas fa-fingerprint"></i> Editorial vs News Classification
                                </div>
                                <div class="tool-item">
                                    <i class="fas fa-brain"></i> Advanced AI Content Analysis
                                </div>
                                <div class="tool-item">
                                    <i class="fas fa-globe"></i> Real-Time Breaking News Verification
                                </div>
                                <div class="tool-item">
                                    <i class="fas fa-comments"></i> Social Media Echo Analysis
                                </div>
                                <div class="tool-item">
                                    <i class="fas fa-microscope"></i> Deep Linguistic Pattern Detection
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="dropdown-section compact" id="how-to-use-section">
                    <div class="dropdown-header compact-header" onclick="toggleDropdown(this, 'info')">
                        <div class="compact-header-content">
                            <i class="fas fa-info-circle"></i>
                            <div class="compact-header-text">
                                <span class="compact-title">How to Use</span>
                                <span class="compact-subtitle">3 simple steps</span>
                            </div>
                        </div>
                        <i class="fas fa-chevron-down dropdown-icon"></i>
                    </div>
                    <div class="dropdown-content">
                        <div style="display: grid; gap: 15px;">
                            <div style="display: flex; align-items: start; gap: 15px;">
                                <div style="background: #667eea; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; flex-shrink: 0;">1</div>
                                <div>
                                    <strong style="color: #4c1d95;">Choose Your Input Method:</strong><br>
                                    <span style="color: #6b7280;">Either paste news text directly or enter a news article URL</span>
                                </div>
                            </div>
                            <div style="display: flex; align-items: start; gap: 15px;">
                                <div style="background: #667eea; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; flex-shrink: 0;">2</div>
                                <div>
                                    <strong style="color: #4c1d95;">Select Analysis Type:</strong><br>
                                    <span style="color: #6b7280;">FREE: Basic credibility check | PRO: Comprehensive verification with bias analysis</span>
                                </div>
                            </div>
                            <div style="display: flex; align-items: start; gap: 15px;">
                                <div style="background: #667eea; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; flex-shrink: 0;">3</div>
                                <div>
                                    <strong style="color: #4c1d95;">Review Your Results:</strong><br>
                                    <span style="color: #6b7280;">Explore bias compass, source verification, and claim analysis</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="dropdown-section compact" id="comparison-section">
                    <div class="dropdown-header compact-header" onclick="toggleDropdown(this, 'info')">
                        <div class="compact-header-content">
                            <i class="fas fa-crown"></i>
                            <div class="compact-header-text">
                                <span class="compact-title">Free vs Pro</span>
                                <span class="compact-subtitle">Compare features</span>
                            </div>
                        </div>
                        <i class="fas fa-chevron-down dropdown-icon"></i>
                    </div>
                    <div class="dropdown-content">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                            <div style="background: white; padding: 20px; border-radius: 12px; border: 2px solid #e5e7eb;">
                                <h4 style="color: #6b7280; margin-bottom: 15px;"><i class="fas fa-gift"></i> FREE Version</h4>
                                <ul style="list-style: none; padding: 0; margin: 0;">
                                    <li style="margin-bottom: 10px; color: #4b5563;">âœ“ Basic credibility score</li>
                                    <li style="margin-bottom: 10px; color: #4b5563;">âœ“ Source verification (100+ sources)</li>
                                    <li style="margin-bottom: 10px; color: #4b5563;">âœ“ Simple bias indicator</li>
                                    <li style="margin-bottom: 10px; color: #4b5563;">âœ“ 5 analyses per day</li>
                                    <li style="margin-bottom: 10px; color: #9ca3af;">âœ— No downloadable reports</li>
                                    <li style="margin-bottom: 10px; color: #9ca3af;">âœ— Limited evidence details</li>
                                </ul>
                            </div>
                            <div style="background: linear-gradient(135deg, #667eea, #764ba2); padding: 20px; border-radius: 12px; border: 2px solid #667eea;">
                                <h4 style="color: white; margin-bottom: 15px;"><i class="fas fa-crown"></i> PRO Version</h4>
                                <ul style="list-style: none; padding: 0; margin: 0;">
                                    <li style="margin-bottom: 10px; color: white;">âœ“ Advanced credibility analysis</li>
                                    <li style="margin-bottom: 10px; color: white;">âœ“ 500+ source database</li>
                                    <li style="margin-bottom: 10px; color: white;">âœ“ Interactive bias compass</li>
                                    <li style="margin-bottom: 10px; color: white;">âœ“ Unlimited analyses</li>
                                    <li style="margin-bottom: 10px; color: white;">âœ“ Downloadable PDF reports</li>
                                    <li style="margin-bottom: 10px; color: white;">âœ“ Full claim verification</li>
                                    <li style="margin-bottom: 10px; color: white;">âœ“ All 12 analysis methodologies</li>
                                    <li style="margin-bottom: 10px; color: white;">âœ“ Priority customer support</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="dropdown-section compact" id="usage-section">
                    <div class="dropdown-header compact-header" onclick="toggleDropdown(this, 'info')">
                        <div class="compact-header-content">
                            <i class="fas fa-chart-bar"></i>
                            <div class="compact-header-text">
                                <span class="compact-title">Daily Usage</span>
                                <span class="compact-subtitle">Track your analyses</span>
                            </div>
                        </div>
                        <i class="fas fa-chevron-down dropdown-icon"></i>
                    </div>
                    <div class="dropdown-content">
                        <div id="usageCounter">
                            <!-- Usage counter content will be populated here -->
                            <div style="text-align: center; padding: 20px;">
                                <p style="color: #6b7280; font-size: 1.1rem;">Daily analyses available</p>
                                <div style="font-size: 2.5rem; font-weight: 700; color: #667eea; margin: 10px 0;">Unlimited</div>
                                <p style="color: #10b981; font-weight: 600;">Development Mode Active</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Authentication Message Area -->
            <div id="authMessageArea"></div>

            <!-- Enhanced Progress Bars -->
            <div class="progress-section" id="progressSection" style="display: none;">
                <div class="progress-title">
                    <i class="fas fa-cogs fa-spin" style="color: #667eea;"></i>
                    News Verification in Progress...
                </div>
                
                <!-- Multi-stage progress indicators -->
                <div class="progress-stages" id="progressStages">
                    <div class="progress-stage" data-stage="0">
                        <div class="stage-icon">ðŸ“„</div>
                        <div class="stage-label">Extracting Content</div>
                    </div>
                    <div class="progress-stage" data-stage="1">
                        <div class="stage-icon">âš–ï¸</div>
                        <div class="stage-label">Analyzing Bias</div>
                    </div>
                    <div class="progress-stage" data-stage="2">
                        <div class="stage-icon">ðŸ”</div>
                        <div class="stage-label">Checking Sources</div>
                    </div>
                    <div class="progress-stage" data-stage="3">
                        <div class="stage-icon">âœ“</div>
                        <div class="stage-label">Verifying Claims</div>
                    </div>
                    <div class="progress-stage" data-stage="4">
                        <div class="stage-icon">ðŸ“Š</div>
                        <div class="stage-label">Generating Report</div>
                    </div>
                </div>
                
                <div class="progress-bar">
                    <div class="progress-fill" id="progressBar">
                        <span class="progress-percentage" id="progressPercentage">0%</span>
                    </div>
                </div>
                
                <div class="progress-status">
                    <div class="progress-spinner"></div>
                    <span id="progressStatus">Initializing advanced verification systems...</span>
                </div>
                
                <!-- Claim verification progress -->
                <div class="claim-progress" style="display: none;" id="claimProgress">
                    <span style="color: #6b7280; font-weight: 600;">Claims found:</span>
                    <span class="claim-counter" id="claimCounter">0</span>
                    <div class="claim-progress-bar">
                        <div class="claim-progress-fill" id="claimProgressFill"></div>
                    </div>
                </div>
            </div>

            <div class="input-section">
                <div class="input-tabs">
                    <button class="input-tab active" onclick="switchInputType('text')">ðŸ“ News Text Analysis</button>
                    <button class="input-tab" onclick="switchInputType('url')">ðŸ”— URL Verification</button>
                </div>
                
                <div class="input-content active" id="textInput">
                    <div class="tab-explanation">
                        <h3>ðŸ“ News Text Analysis</h3>
                        <p><strong>What it's for:</strong> Social media posts, forwarded messages, copied articles</p>
                        <p><strong>What we analyze:</strong></p>
                        <ul>
                            <li>Writing style and language patterns</li>
                            <li>Bias indicators and emotional language</li>
                            <li>Fact-checking against our database</li>
                        </ul>
                        <p><strong>Key benefit:</strong> No source URL needed - perfect for viral messages</p>
                    </div>
                    <div class="input-group">
                        <label for="news-text"><i class="fas fa-file-text"></i> News Article or Social Media Content</label>
                        <textarea id="news-text" placeholder="Paste news article, social media post, or any news content for comprehensive verification and bias analysis..."></textarea>
                    </div>
                </div>
                
                <div class="input-content" id="urlInput">
                    <div class="tab-explanation">
                        <h3>ðŸ”— URL Verification</h3>
                        <p><strong>What it's for:</strong> Online news articles, blog posts, official statements</p>
                        <p><strong>What we analyze:</strong></p>
                        <ul>
                            <li>Source reputation and domain authority</li>
                            <li>Publication patterns and history</li>
                            <li>Cross-reference with fact-checking databases</li>
                        </ul>
                        <p><strong>Key benefit:</strong> Includes metadata and source verification</p>
                    </div>
                    <div class="input-group">
                        <label for="news-url"><i class="fas fa-link"></i> News Article URL</label>
                        <input type="url" id="news-url" placeholder="https://example.com/news-article-for-verification">
                    </div>
                </div>
            </div>

            <div class="button-group">
                <button class="btn btn-primary" onclick="runAnalysis('free')">
                    <i class="fas fa-play"></i> Start Free Analysis
                </button>
                <button class="btn btn-primary" onclick="runAnalysis('pro')" style="background: linear-gradient(135deg, #f59e0b, #d97706);">
                    <i class="fas fa-crown"></i> Start Pro Analysis
                </button>
                <button class="btn btn-test" onclick="loadTestData()">
                    <i class="fas fa-flask"></i> Load Sample News
                </button>
                <button class="btn btn-secondary" onclick="resetForm()">
                    <i class="fas fa-redo"></i> Reset
                </button>
            </div>

            <div class="results" id="results">
                <!-- Results will be populated here -->
            </div>
        </div>
    </div>

    <!-- Back to Top Button -->
    <button class="back-to-top" id="backToTop" onclick="scrollToTop()">
        <i class="fas fa-arrow-up"></i>
    </button>

    <!-- Beta Modal -->
    <div id="betaModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeBetaModal()">&times;</span>
            <div class="modal-header">
                <h2>ðŸš€ Join Our Beta Program</h2>
                <p>Get exclusive early access to the world's first news verification platform and help shape the future of media analysis!</p>
            </div>
            <div class="modal-body">
                <form id="betaSignupForm">
                    <div class="input-group">
                        <input type="email" id="betaEmail" placeholder="Enter your email address" required>
                    </div>
                    <div class="input-group">
                        <input type="text" id="betaName" placeholder="Your name (optional)">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeBetaModal()">Cancel</button>
                <button class="btn btn-primary" onclick="submitBetaSignup()">Join Beta Program</button>
            </div>
        </div>
    </div>

    <!-- Claims Modal -->
    <div id="claimsModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeClaimsModal()">&times;</span>
            <div class="modal-header">
                <h2><i class="fas fa-exclamation-triangle"></i> Claim Analysis</h2>
                <p>Detailed analysis of claims found in the article</p>
            </div>
            <div class="modal-body" id="claimsList">
                <!-- Claims will be dynamically inserted here -->
            </div>
        </div>
    </div>

    <script src="/static/auth-analysis.js"></script>
    <script>
        // ============================================================================
        // NOTIFICATION HELPER FUNCTION
        // ============================================================================
        function showNotification(message, type = 'info') {
            // Create notification element
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            notification.style.display = 'block'; 
            
            // Add to body
            document.body.appendChild(notification);
            
            // Remove after 3 seconds
            setTimeout(() => {
                notification.style.opacity = '0';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }

        // ============================================================================
        // GLOBAL VARIABLES
        // ============================================================================
        
        let currentInputType = 'text';
        let currentAnalysisData = null;
        let currentTier = 'free';

        // Enhanced function to generate author analysis
        function generateEnhancedAuthorAnalysis(sourceAnalysis, detailedAnalysis, textContent) {
            // Extract author information
            const authorInfo = sourceAnalysis.author || {};
            
            // Try to extract author from content if not provided
            if (!authorInfo.name || authorInfo.name === 'Not Specified') {
                const authorMatch = textContent.match(/By\s+([A-Z][a-z]+(?:\s+[A-Z][a-z]+)*?)(?:\s*[,\n]|\s+is\s+a|\s+reports)/);
                if (authorMatch) {
                    authorInfo.name = authorMatch[1];
                }
            }
            
            // Mock enhanced author data (in production, this would come from your API)
            const enhancedAuthorData = {
                verified: authorInfo.name && authorInfo.name !== 'Not Specified',
                credibilityScore: sourceAnalysis.author_credibility || Math.floor(Math.random() * 20) + 70,
                yearsExperience: authorInfo.years_experience || '5+',
                articleCount: authorInfo.article_count || '150+',
                correctionRate: authorInfo.correction_rate || '2.1%',
                expertiseMatch: calculateExpertiseMatch(textContent),
                expertise: authorInfo.expertise || ['General News', 'Politics', 'Technology'],
                hasDisclosures: true,
                hasCorrections: true,
                socialVerified: authorInfo.social_verified || false
            };
            
            const initials = authorInfo.name && authorInfo.name !== 'Not Specified' 
                ? authorInfo.name.split(' ').map(n => n[0]).join('')
                : '?';
            
            return `
                <div class="author-card">
                    <div class="author-header">
                        <div class="author-avatar">
                            ${initials}
                            ${enhancedAuthorData.verified ? '<div class="verified-badge"><i class="fas fa-check"></i></div>' : ''}
                        </div>
                        <div class="author-info">
                            <h3 class="author-name">${authorInfo.name || 'Unknown Author'}</h3>
                            <p class="author-outlet">${sourceAnalysis.domain || 'Unknown Outlet'}</p>
                            ${enhancedAuthorData.verified ? '<span class="verified-text"><i class="fas fa-check-circle"></i> Verified Journalist</span>' : ''}
                        </div>
                        <div class="author-score">
    <div class="score-circle" data-tooltip="Based on accuracy, experience & expertise">
        <span class="score-number">${enhancedAuthorData.credibilityScore}</span>
        <span class="score-label">Score</span>
    </div>
</div>
                    </div>
                    
                    <div class="author-metrics">
                        <div class="author-metric">
                            <div class="metric-value">${enhancedAuthorData.yearsExperience}</div>
                            <div class="metric-label">Years Experience</div>
                        </div>
                        <div class="author-metric">
                            <div class="metric-value">${enhancedAuthorData.articleCount}</div>
                            <div class="metric-label">Articles Written</div>
                        </div>
                        <div class="author-metric">
                            <div class="metric-value">${enhancedAuthorData.correctionRate}</div>
                            <div class="metric-label">Correction Rate</div>
                        </div>
                        <div class="author-metric">
                            <div class="metric-value">${enhancedAuthorData.expertiseMatch}%</div>
                            <div class="metric-label">Topic Match</div>
                        </div>
                    </div>
                    
                    ${enhancedAuthorData.expertise ? `
                    <div class="author-expertise">
                        <h4>Areas of Expertise</h4>
                        <div class="expertise-tags">
                            ${enhancedAuthorData.expertise.map(topic => 
                                `<span class="expertise-tag">${topic}</span>`
                            ).join('')}
                        </div>
                    </div>
                    ` : ''}
                    
                    <div class="author-transparency">
                        <h4>Transparency Indicators</h4>
                        <div class="transparency-grid">
                            <div class="transparency-indicator ${enhancedAuthorData.hasDisclosures ? 'disclosed' : 'undisclosed'}">
                                <i class="fas fa-${enhancedAuthorData.hasDisclosures ? 'check' : 'times'}"></i>
                                <span>Financial Disclosures</span>
                            </div>
                            <div class="transparency-indicator ${enhancedAuthorData.hasCorrections ? 'disclosed' : 'undisclosed'}">
                                <i class="fas fa-${enhancedAuthorData.hasCorrections ? 'check' : 'times'}"></i>
                                <span>Corrections Published</span>
                            </div>
                            <div class="transparency-indicator ${enhancedAuthorData.socialVerified ? 'disclosed' : 'undisclosed'}">
                                <i class="fas fa-${enhancedAuthorData.socialVerified ? 'check' : 'times'}"></i>
                                <span>Social Media Verified</span>
                            </div>
                        </div>
                    </div>
                ${generateAuthorLinks(authorInfo, enhancedAuthorData)}
            </div>
            `;
        }

        // Helper function to calculate expertise match
        function calculateExpertiseMatch(textContent) {
            // Simple keyword-based matching (in production, use more sophisticated NLP)
            const topicKeywords = {
                politics: /government|election|congress|senate|policy|political|democrat|republican/gi,
                technology: /tech|software|ai|artificial intelligence|computer|digital|cyber/gi,
                economics: /economy|financial|market|trade|business|commerce|gdp/gi,
                health: /health|medical|doctor|hospital|disease|treatment|covid|vaccine/gi,
                environment: /climate|environment|pollution|renewable|energy|carbon/gi
            };
            
            let maxMatch = 0;
            for (const [topic, regex] of Object.entries(topicKeywords)) {
                const matches = textContent.match(regex);
                if (matches) {
                    const matchPercentage = Math.min(95, matches.length * 5 + 70);
                    maxMatch = Math.max(maxMatch, matchPercentage);
                }
            }
            
            return maxMatch || 75; // Default to 75 if no strong topic match
        }

        // Helper function to generate author links
function generateAuthorLinks(authorInfo, enhancedAuthorData) {
    // Mock author links data (in production, this would come from your API)
    const authorLinks = {
        website: authorInfo.website || (enhancedAuthorData.verified ? 'https://example.com/author-profile' : null),
        twitter: authorInfo.twitter || (enhancedAuthorData.socialVerified ? '@journalisthandle' : null),
        linkedin: authorInfo.linkedin || null,
        email: authorInfo.email || null
    };
    
    // Check if any links exist
    const hasLinks = Object.values(authorLinks).some(link => link !== null);
    
    if (!hasLinks) {
        return '';
    }
    
    let linksHTML = '<div class="author-links"><h4>Connect with the Author</h4><div class="author-links-grid">';
    
    if (authorLinks.website) {
        linksHTML += `<a href="${authorLinks.website}" target="_blank" rel="noopener noreferrer" class="author-link">
            <i class="fas fa-globe"></i> Website
        </a>`;
    }
    
    if (authorLinks.twitter) {
        const twitterUrl = authorLinks.twitter.startsWith('@') ? 
            `https://twitter.com/${authorLinks.twitter.substring(1)}` : 
            authorLinks.twitter;
        linksHTML += `<a href="${twitterUrl}" target="_blank" rel="noopener noreferrer" class="author-link">
            <i class="fab fa-twitter"></i> Twitter
        </a>`;
    }
    
    if (authorLinks.linkedin) {
        linksHTML += `<a href="${authorLinks.linkedin}" target="_blank" rel="noopener noreferrer" class="author-link">
            <i class="fab fa-linkedin"></i> LinkedIn
        </a>`;
    }
    
    if (authorLinks.email) {
        linksHTML += `<a href="mailto:${authorLinks.email}" class="author-link">
            <i class="fas fa-envelope"></i> Email
        </a>`;
    }
    
    linksHTML += '</div></div>';
    
    return linksHTML;
}

        // Enhanced show news results function
        function showNewsResults(results, tier) {
            const resultsDiv = document.getElementById('results');
            
            // Log what we're getting from the API
            console.log('Showing results for tier:', tier);
            console.log('Results data:', results);
            
            // Extract data from API response
            const credibilityScore = Math.round(results.credibility_score || 65);
            const politicalBias = results.political_bias || {};
            const sourceAnalysis = results.source_analysis || {};
            const factCheckResults = results.fact_check_results || [];
            const crossReferences = results.cross_references || [];
            const methodology = results.methodology || {};
            const biasIndicators = results.bias_indicators || {};
            const detailedAnalysis = results.detailed_analysis || {};
            const credibilityInsights = results.credibility_insights || {};
            
            // Extract author from content if available
            const textContent = document.getElementById('news-text').value;
            const authorMatch = textContent.match(/â€”\s*([^']+)'s\s+(\w+\s+\w+)\s+contributed/i) || 
                               textContent.match(/By\s+([A-Z][a-z]+\s+[A-Z][a-z]+)/);
            if (authorMatch) {
                sourceAnalysis.author = {
                    name: authorMatch[2] || authorMatch[1],
                    outlet: authorMatch[1] || sourceAnalysis.domain
                };
            }
            
            // Calculate assessment
            const assessment = credibilityScore >= 80 ? 'HIGHLY CREDIBLE' : 
                             credibilityScore >= 60 ? 'MODERATELY CREDIBLE' : 
                             'REQUIRES VERIFICATION';
            
            const biasLabel = politicalBias.bias_label || 'center';
            const biasScore = politicalBias.bias_score || 0;
            const objectivityScore = politicalBias.objectivity_score || 75;
            
            // Clear previous results
            resultsDiv.innerHTML = '';
            resultsDiv.style.display = 'block';
            
            // Summary Banner with Enhanced Score Display
            const summaryBanner = document.createElement('div');
            summaryBanner.className = 'summary-banner';
            summaryBanner.innerHTML = `
                <div class="credibility-header">
                    <div class="credibility-score-container">
                        <div class="credibility-score-circle">
                            <div class="score-number">${credibilityScore}</div>
                            <div class="score-label">Credibility Score</div>
                            <div class="score-indicator" style="--score-rotation: ${(credibilityScore / 100) * 360}deg;"></div>
                        </div>
                    </div>
                    <div class="credibility-details">
                        <h2 class="credibility-title">Overall Assessment: ${assessment}</h2>
                        <p class="credibility-subtitle">
                            ${generateSummaryNarrative(credibilityScore, biasLabel, objectivityScore, sourceAnalysis)}
                        </p>
                        <div class="methodology-note">
                            <i class="fas fa-info-circle"></i>
                            Analyzed using ${methodology.factors_analyzed ? methodology.factors_analyzed.length : 12} advanced verification methods
                        </div>
                    </div>
                </div>
                <div class="quick-actions">
                    <a href="#political-bias" class="quick-action">View Bias Analysis</a>
                    <a href="#source-analysis" class="quick-action">Check Sources</a>
                    <a href="#reportSummary" class="quick-action">View Report</a>
                </div>
                ${tier === 'free' ? `
                <div class="pro-upgrade-note">
                    <p><i class="fas fa-crown"></i> For comprehensive results including detailed bias analysis, source verification, and downloadable reports, upgrade to Pro!</p>
                    <button onclick="window.location.href='/pricingplan'">Upgrade to Pro</button>
                </div>
                ` : ''}
            `;
            resultsDiv.appendChild(summaryBanner);
            
            // Political Bias Analysis Section - NEW COMPASS DESIGN
            const biasSection = createAnalysisSection({
                id: 'political-bias',
                icon: 'âš–ï¸',
                iconColor: '#667eea',
                title: 'Political Bias Analysis',
                summary: `${biasLabel.charAt(0).toUpperCase() + biasLabel.slice(1)} bias detected with ${objectivityScore}% objectivity`,
                content: `
                    <div class="analysis-explanation">
                        <span class="analysis-explanation-icon"><i class="fas fa-info-circle"></i></span>
                        <span class="analysis-explanation-text">
                            <strong>What this analysis shows:</strong> We examine the article's language, word choices, and framing to detect political bias. 
                            The compass shows where the content falls on the political spectrum from far-left to far-right. Higher objectivity scores indicate 
                            more balanced reporting, while lower scores suggest stronger political slant.
                        </span>
                    </div>
                    <div class="bias-compass-container">
                        <h3 class="bias-compass-title">Political Orientation Detection</h3>
                        
                        <!-- Compass Visualization -->
                        <div class="bias-compass">
                            <div class="compass-circle compass-outer"></div>
                            <div class="compass-circle compass-inner"></div>
                            <div class="compass-circle compass-center">${Math.abs(biasScore).toFixed(0)}</div>
                            
                            <!-- Labels -->
                            <div class="compass-labels">
                                <div class="compass-label far-left">Far Left</div>
                                <div class="compass-label left">Left</div>
                                <div class="compass-label center">Center</div>
                                <div class="compass-label right">Right</div>
                                <div class="compass-label far-right">Far Right</div>
                            </div>
                            
                            <!-- Needle -->
                            <div class="compass-needle" style="transform: translate(-50%, -100%) rotate(${calculateCompassRotation(biasScore)}deg);"></div>
                        </div>
                        
                        <div class="bias-position-badge">
                            ${biasLabel.toUpperCase()} BIAS DETECTED
                        </div>
                    </div>
                    
                    <div class="analysis-body">
                        <p style="color: #4b5563; line-height: 1.8; margin: 20px 0;">
                            ${generateBiasNarrative(biasLabel, biasScore, objectivityScore, politicalBias)}
                        </p>
                    </div>
                    
                    <div class="claims-container">
                        <h3 style="font-weight: 700; color: #1f2937; margin-bottom: 10px;">Factual Claims Analysis</h3>
                        <div class="claims-grid">
                            <div class="claims-column unsupported">
                                <h4 class="claims-title">
                                    <i class="fas fa-exclamation-triangle"></i>
                                    Unsupported Claims
                                    <span class="claims-count">${biasIndicators.unsupported_claims || 0}</span>
                                </h4>
                                ${generateClaimsContent('unsupported', biasIndicators.unsupported_claims || 0, factCheckResults)}
                            </div>
                            <div class="claims-column supported">
                                <h4 class="claims-title">
                                    <i class="fas fa-check-circle"></i>
                                    Verified Claims
                                    <span class="claims-count">${biasIndicators.factual_claims || 0}</span>
                                </h4>
                                ${generateClaimsContent('supported', biasIndicators.factual_claims || 0, factCheckResults)}
                            </div>
                        </div>
                    </div>
                `,
                locked: tier === 'free'
            });
            resultsDiv.appendChild(biasSection);
            
            // Enhanced Cross-Source Comparison Section
            const comparisonSection = createAnalysisSection({
                id: 'source-comparison',
                icon: 'ðŸ”„',
                iconColor: '#14b8a6',
                title: 'Cross-Source Verification',
                summary: 'Compared with major news outlets for consistency',
                content: `
                    <div class="analysis-explanation">
                        <span class="analysis-explanation-icon"><i class="fas fa-info-circle"></i></span>
                        <span class="analysis-explanation-text">
                            <strong>What this analysis shows:</strong> We search our database of 500+ news sources to find other outlets covering the same story. 
                            More sources reporting similar facts increases credibility. If few or no other sources are found, it could mean breaking news, 
                            exclusive reporting, or content requiring extra verification.
                        </span>
                    </div>
                    <div class="comparison-chart-container">
                        <!-- Verification Statistics -->
                        <div class="verification-stats">
                            <div class="stat-card">
                                <div class="stat-icon">ðŸ“°</div>
                                <div class="stat-number">500+</div>
                                <div class="stat-label">Sources Analyzed</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon">âœ…</div>
                                <div class="stat-number">${crossReferences.length}</div>
                                <div class="stat-label">Matching Reports Found</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon">ðŸŒ</div>
                                <div class="stat-number">${crossReferences.length > 0 ? Math.round(crossReferences.reduce((sum, ref) => sum + ref.relevance, 0) / crossReferences.length) : 0}%</div>
                                <div class="stat-label">Avg. Similarity</div>
                            </div>
                        </div>
                        
                        <p style="color: #4b5563; line-height: 1.8; margin: 20px 0;">
                            <strong>What this means:</strong> We analyzed our database of over 500 news sources to find corroborating reports. 
                            ${crossReferences.length > 5 ? 
                            `We found ${crossReferences.length} sources with matching coverage. This widespread reporting across multiple outlets increases confidence in the core facts.` : 
                            crossReferences.length > 0 ?
                            `We found ${crossReferences.length} source${crossReferences.length > 1 ? 's' : ''} with similar reporting. ${crossReferences.length === 1 ? 'Limited corroboration suggests this may be breaking news, regional coverage, or requires additional verification.' : 'Multiple sources provide moderate corroboration of the story.'}` :
                            `No matching coverage was found in other major outlets. This could mean: (1) Breaking news not yet reported elsewhere, (2) Exclusive or original reporting, (3) Regional/niche coverage, or (4) Content requiring additional verification.`}
                        </p>
                        
                        <div class="comparison-items">
                            ${generateComparisonItems(crossReferences)}
                        </div>
                    </div>
                `,
                locked: tier === 'free'
            });
            resultsDiv.appendChild(comparisonSection);
            
            // Source & Author Analysis Section with enhanced author card
            const sourceSection = createAnalysisSection({
                id: 'source-analysis',
                icon: 'ðŸ“Š',
                iconColor: '#f59e0b',
                title: 'Source & Author Credibility',
                summary: `Source reliability: ${sourceAnalysis.credibility_score || 70}/100`,
                content: `
                    <div class="analysis-explanation">
                        <span class="analysis-explanation-icon"><i class="fas fa-info-circle"></i></span>
                        <span class="analysis-explanation-text">
                            <strong>What this analysis shows:</strong> We evaluate both the news outlet's track record and the author's credentials. 
                            Higher scores indicate established journalists with strong fact-checking practices and transparency. We analyze correction history, 
                            journalistic standards, and expertise alignment to assess overall credibility.
                        </span>
                    </div>
                    <div class="analysis-body">
                        <p style="color: #4b5563; line-height: 1.8; margin-bottom: 20px;">
                            ${generateSourceNarrative(sourceAnalysis)}
                        </p>
                        
                        ${generateEnhancedAuthorAnalysis(sourceAnalysis, detailedAnalysis, textContent)}
                        
                        <div class="source-details-grid">
                            <div class="source-detail-card">
                                <div class="detail-icon">ðŸ¢</div>
                                <div class="detail-value">${sourceAnalysis.domain || 'Unknown'}</div>
                                <div class="detail-label">News Source</div>
                            </div>
                            <div class="source-detail-card">
                                <div class="detail-icon">ðŸ“ˆ</div>
                                <div class="detail-value">${sourceAnalysis.credibility_score || 70}/100</div>
                                <div class="detail-label">Source Credibility</div>
                            </div>
                            <div class="source-detail-card">
                                <div class="detail-icon">ðŸŽ¯</div>
                                <div class="detail-value">${sourceAnalysis.political_bias || 'Center'}</div>
                                <div class="detail-label">Known Bias</div>
                            </div>
                            <div class="source-detail-card">
                                <div class="detail-icon">ðŸ“°</div>
                                <div class="detail-value">${sourceAnalysis.source_type || 'News Outlet'}</div>
                                <div class="detail-label">Source Type</div>
                            </div>
                        </div>
                    </div>
                `,
                locked: false // Always show source analysis
            });
            resultsDiv.appendChild(sourceSection);
            
            // Enhanced Emotional Language Analysis with meter
            const emotionalSection = createAnalysisSection({
                id: 'emotional-analysis',
                icon: 'ðŸ’­',
                iconColor: '#ec4899',
                title: 'Emotional Language & Manipulation Detection',
                summary: `Emotional intensity: ${biasIndicators.emotional_language || 0}%`,
                content: `
                    <div class="analysis-explanation">
                        <span class="analysis-explanation-icon"><i class="fas fa-info-circle"></i></span>
                        <span class="analysis-explanation-text">
                            <strong>What this analysis shows:</strong> We measure how much the article uses emotional language versus factual reporting. 
                            High emotional content may indicate opinion pieces or attempts to persuade through feelings rather than facts. 
                            Professional news reporting typically maintains lower emotional intensity.
                        </span>
                    </div>
                    <div class="analysis-body">
                        <div class="emotion-meter-container">
                            <h4 style="color: #1f2937; margin-bottom: 15px; font-weight: 700;">Emotional Content Level</h4>
                            <div class="emotion-meter">
                                <div class="emotion-fill" style="width: ${biasIndicators.emotional_language || 0}%;">
                                    <div class="emotion-marker" style="left: 100%;" data-value="${biasIndicators.emotional_language || 0}%"></div>
                                </div>
                            </div>
                            <div class="emotion-labels">
                                <span>Factual</span>
                                <span>Moderate</span>
                                <span>Emotional</span>
                            </div>
                        </div>
                        
                        <p style="color: #4b5563; line-height: 1.8; margin: 20px 0;">
                            Our linguistic analysis detected ${biasIndicators.emotional_language > 50 ? 'high' : 
                            biasIndicators.emotional_language > 20 ? 'moderate' : 'low'} levels of emotional language
                            (${biasIndicators.emotional_language || 0}%). ${generateEmotionalNarrative(politicalBias, biasIndicators)}
                        </p>
                        ${politicalBias.loaded_terms && politicalBias.loaded_terms.length > 0 ? `
                        <div style="background: rgba(236, 72, 153, 0.1); padding: 20px; border-radius: 12px; margin-top: 20px;">
                            <h4 style="color: #be185d; margin-bottom: 10px;">Emotionally Charged Terms Detected:</h4>
                            <div style="display: flex; flex-wrap: wrap; gap: 10px;">
                                ${politicalBias.loaded_terms.map(term => 
                                    `<span style="background: white; padding: 6px 14px; border-radius: 20px; 
                                    border: 2px solid rgba(236, 72, 153, 0.3); color: #831843; font-weight: 600;">
                                    ${term}</span>`
                                ).join('')}
                            </div>
                        </div>
                        ` : ''}
                    </div>
                `,
                locked: tier === 'free'
            });
            resultsDiv.appendChild(emotionalSection);
            
            // Writing Style Analysis Section with smaller icons
            const styleSection = createAnalysisSection({
                id: 'style-analysis',
                icon: 'âœï¸',
                iconColor: '#8b5cf6',
                title: 'Writing Style & Authenticity Analysis',
                summary: 'Linguistic patterns and authorship verification',
                content: `
                    <div class="analysis-explanation">
                        <span class="analysis-explanation-icon"><i class="fas fa-info-circle"></i></span>
                        <span class="analysis-explanation-text">
                            <strong>What this analysis shows:</strong> We analyze writing patterns including sentence structure, vocabulary complexity, 
                            and statistical claims. Professional journalism typically shows consistent patterns like proper attribution, specific data, 
                            and varied sentence lengths. Unusual patterns may indicate AI-generated content or non-professional sources.
                        </span>
                    </div>
                    <div class="analysis-body">
                        <p style="color: #4b5563; line-height: 1.8; margin-bottom: 20px;">
                            ${generateStyleNarrative(results, detailedAnalysis)}
                        </p>
                        <div class="source-details-grid">
                            <div class="source-detail-card">
                                <div class="detail-icon">ðŸ“Š</div>
                                <div class="detail-value">${detailedAnalysis.quote_analysis?.quote_count || 0}</div>
                                <div class="detail-label">Direct Quotes</div>
                            </div>
                            <div class="source-detail-card">
                                <div class="detail-icon">ðŸ”¢</div>
                                <div class="detail-value">${detailedAnalysis.statistical_claims || 0}</div>
                                <div class="detail-label">Statistical Claims</div>
                            </div>
                            <div class="source-detail-card">
                                <div class="detail-icon">ðŸ“š</div>
                                <div class="detail-value">${detailedAnalysis.readability_score || 'Grade 10'}</div>
                                <div class="detail-label">Reading Level</div>
                            </div>
                            <div class="source-detail-card">
                                <div class="detail-icon">âœ…</div>
                                <div class="detail-value">${detailedAnalysis.journalism_indicators?.balanced_coverage ? 'Yes' : 'No'}</div>
                                <div class="detail-label">Balanced Coverage</div>
                            </div>
                        </div>
                    </div>
                `,
                locked: tier === 'free'
            });
            resultsDiv.appendChild(styleSection);
            
            // Enhanced Fact-Checking Signals Section
            const signalsSection = createAnalysisSection({
                id: 'fact-signals',
                icon: 'ðŸŽ¯',
                iconColor: '#06b6d4',
                title: 'Fact-Checking Signals & Red Flags',
                summary: 'Indicators of reliable vs questionable reporting',
                content: `
                    <div class="analysis-explanation">
                        <span class="analysis-explanation-icon"><i class="fas fa-info-circle"></i></span>
                        <span class="analysis-explanation-text">
                            <strong>What this analysis shows:</strong> We look for specific indicators that distinguish reliable journalism from questionable content. 
                            Positive signals include named sources, direct quotes, and specific data. Red flags include vague attribution ("some say"), 
                            excessive qualifying language ("allegedly"), and lack of verifiable details.
                        </span>
                    </div>
                    <div class="analysis-body">
                        <p style="color: #4b5563; line-height: 1.8; margin-bottom: 20px;">
                            <strong>How our fact-checking works:</strong> We analyze over 50 linguistic and structural indicators to identify patterns associated with reliable journalism versus potential misinformation. 
                            This includes checking for attribution phrases ("according to"), direct quotes, specific data points, and warning signs like vague sourcing or excessive qualifying language.
                        </p>
                        ${generateFactSignalsContent(results, textContent, detailedAnalysis)}
                    </div>
                `,
                locked: false
            });
            resultsDiv.appendChild(signalsSection);
            
            // NEW Enhanced Timeline & Currency Analysis Section
            const temporalSection = createAnalysisSection({
                id: 'temporal-analysis',
                icon: 'â°',
                iconColor: '#f97316',
                title: 'Timeline & Currency Analysis',
                summary: 'When events occurred vs when reported',
                content: `
                    <div class="analysis-explanation">
                        <span class="analysis-explanation-icon"><i class="fas fa-info-circle"></i></span>
                        <span class="analysis-explanation-text">
                            <strong>What this analysis shows:</strong> We identify all dates and time references to assess how current the information is. 
                            Fresh news should have recent dates and specific time markers. Lack of temporal references makes it difficult to verify 
                            when events actually occurred, which is a common tactic in misleading content.
                        </span>
                    </div>
                    ${generateEnhancedTemporalAnalysis(textContent)}`,
                locked: tier === 'free'
            });
            resultsDiv.appendChild(temporalSection);
            
            // Enhanced Transparency Score Section with author focus
            const transparencySection = createAnalysisSection({
                id: 'transparency-score',
                icon: 'ðŸ”',
                iconColor: '#10b981',
                title: 'Transparency & Attribution Score',
                summary: 'How well sources and claims are documented',
                content: `
                    <div class="analysis-explanation">
                        <span class="analysis-explanation-icon"><i class="fas fa-info-circle"></i></span>
                        <span class="analysis-explanation-text">
                            <strong>What this analysis shows:</strong> We measure transparency across four key areas: author identification, 
                            source attribution, editorial policies, and correction practices. High transparency means readers can verify claims 
                            independently and trust the reporting process. Low transparency often correlates with unreliable or biased content.
                        </span>
                    </div>
                    <div class="analysis-body">
                        ${generateTransparencyAnalysis(textContent, sourceAnalysis, detailedAnalysis)}
                    </div>
                `,
                locked: false
            });
            resultsDiv.appendChild(transparencySection);
            
            // Additional Findings Section (Pro only) - Updated to mention GPT-4
            if (tier === 'pro' && methodology.ai_enhanced) {
                const findingsSection = createAnalysisSection({
                    id: 'additional-findings',
                    icon: 'ðŸ”',
                    iconColor: '#dc2626',
                    title: 'Advanced AI Insights',
                    summary: 'Deep analysis using GPT-4 and pattern recognition',
                    content: `
                        <div class="analysis-body">
                            <p style="color: #4b5563; line-height: 1.8; margin-bottom: 25px; font-size: 1.05rem;">
                                <strong>How Our AI Works For You:</strong><br>
                                We employ cutting-edge artificial intelligence models including GPT-4 and proprietary pattern 
                                recognition algorithms to analyze this article at a depth impossible for human reviewers alone. 
                                Our AI examines linguistic patterns, identifies manipulation techniques, detects emotional 
                                manipulation, and compares writing styles against our database of millions of articles to 
                                provide insights that even experienced journalists might miss.
                            </p>
                        </div>
                        <div class="findings-grid">
                            ${generateAdditionalFindings(results, credibilityInsights)}
                        </div>
                    `,
                    locked: false
                });
                resultsDiv.appendChild(findingsSection);
            }
            
            // Enhanced Report Summary Section
            const reportSummary = document.createElement('div');
            reportSummary.className = 'report-summary';
            reportSummary.id = 'reportSummary';
            reportSummary.innerHTML = `
                <h3>Analysis Report Summary</h3>
                
                <div class="summary-stats">
                    <div class="summary-stat">
                        <div class="summary-stat-value">${credibilityScore}%</div>
                        <div class="summary-stat-label">Overall Credibility</div>
                    </div>
                    <div class="summary-stat">
                        <div class="summary-stat-value">${biasLabel.charAt(0).toUpperCase() + biasLabel.slice(1)}</div>
                        <div class="summary-stat-label">Political Bias</div>
                    </div>
                    <div class="summary-stat">
                        <div class="summary-stat-value">${objectivityScore}/100</div>
                        <div class="summary-stat-label">Objectivity Score</div>
                    </div>
                    <div class="summary-stat">
                        <div class="summary-stat-value">${crossReferences.length} of 500+</div>
                        <div class="summary-stat-label">Verified Sources</div>
                    </div>
                </div>
                
                <div class="report-actions" id="reportActions">
                    ${tier === 'pro' ? `
                        <button class="report-action primary" onclick="downloadReport()">
                            <i class="fas fa-download"></i> Download PDF Report
                        </button>
                        <button class="report-action secondary" onclick="shareReport()">
                            <i class="fas fa-share"></i> Share Report
                        </button>
                    ` : `
                        <button class="report-action primary" onclick="window.location.href='/pricingplan'">
                            <i class="fas fa-star"></i> Upgrade for Full Report
                        </button>
                        <button class="report-action secondary" onclick="copyReportLink()">
                            <i class="fas fa-copy"></i> Copy Link
                        </button>
                    `}
                </div>
            `;
            resultsDiv.appendChild(reportSummary);
            
            // Track completion
            trackNewsEvent('news_results_displayed', {
                tier: tier,
                credibility_score: credibilityScore,
                bias: biasLabel,
                sections_shown: tier === 'pro' ? 10 : 6
            });
        }

        // Report action functions
        function downloadReport() {
            showNotification('Generating PDF report...', 'info');
            // In a real implementation, this would generate and download a PDF
            setTimeout(() => {
                showNotification('PDF report downloaded successfully!', 'success');
            }, 2000);
        }

        function shareReport() {
            showNotification('Generating shareable link...', 'info');
            // In a real implementation, this would create a shareable link
            setTimeout(() => {
                showNotification('Report link copied to clipboard!', 'success');
            }, 1000);
        }

        function copyReportLink() {
            // In a real implementation, this would copy the current URL with report ID
            navigator.clipboard.writeText(window.location.href);
            showNotification('Report link copied to clipboard!', 'success');
        }

        // NEW Enhanced temporal analysis function with WOW factor
        function generateEnhancedTemporalAnalysis(text) {
            const dateMatches = text.match(/\b(January|February|March|April|May|June|July|August|September|October|November|December)\s+\d{1,2},?\s+\d{4}|\b\d{1,2}\/\d{1,2}\/\d{2,4}\b|\b(today|yesterday|last\s+week|this\s+week)\b/gi) || [];
            const timeReferences = text.match(/\b(morning|afternoon|evening|night|hours?\s+ago|minutes?\s+ago)\b/gi) || [];
            
            // Calculate currency score (0-100)
            const totalReferences = dateMatches.length + timeReferences.length;
            const currencyScore = Math.min(100, totalReferences * 20);
            
            // Determine currency level
            let currencyLevel, currencyBadgeText, needleRotation;
            if (currencyScore >= 80) {
                currencyLevel = 'highly-current';
                currencyBadgeText = 'HIGHLY CURRENT';
                needleRotation = 45; // Points to green
            } else if (currencyScore >= 60) {
                currencyLevel = 'current';
                currencyBadgeText = 'CURRENT';
                needleRotation = 15;
            } else if (currencyScore >= 40) {
                currencyLevel = 'moderately-current';
                currencyBadgeText = 'MODERATELY CURRENT';
                needleRotation = 0;
            } else if (currencyScore >= 20) {
                currencyLevel = 'dated';
                currencyBadgeText = 'POSSIBLY DATED';
                needleRotation = -15;
            } else {
                currencyLevel = 'undated';
                currencyBadgeText = 'UNDATED CONTENT';
                needleRotation = -45; // Points to red
            }
            
            // Create timeline events
            const timelineEvents = [];
            if (dateMatches.length > 0) {
                // Parse first, middle, and last dates for timeline
                const dates = dateMatches.slice(0, 5); // Maximum 5 for display
                dates.forEach((date, index) => {
                    timelineEvents.push({
                        icon: index === 0 ? 'ðŸ“…' : index === dates.length - 1 ? 'ðŸ“' : 'ðŸ“Œ',
                        date: date,
                        label: index === 0 ? 'First Reference' : index === dates.length - 1 ? 'Latest Reference' : 'Event Date'
                    });
                });
            } else {
                timelineEvents.push({
                    icon: 'â“',
                    date: 'No Dates',
                    label: 'Temporal void'
                });
            }
            
            return `
                <div class="analysis-body">
                    <div class="timeline-visualization">
                        <div class="timeline-header">
                            <h2 class="timeline-title">Temporal Intelligence Report</h2>
                        </div>
                        
                        <!-- Statistics -->
                        <div class="timeline-stats">
                            <div class="timeline-stat">
                                <span class="timeline-stat-number">${dateMatches.length}</span>
                                <span class="timeline-stat-label">Date References</span>
                            </div>
                            <div class="timeline-stat">
                                <span class="timeline-stat-number">${timeReferences.length}</span>
                                <span class="timeline-stat-label">Time Indicators</span>
                            </div>
                            <div class="timeline-stat">
                                <span class="timeline-stat-number">${totalReferences}</span>
                                <span class="timeline-stat-label">Total Markers</span>
                            </div>
                        </div>
                        
                        <!-- Timeline Visualization -->
                        ${timelineEvents.length > 1 ? `
                        <div class="timeline-main">
                            <div class="timeline-line"></div>
                            <div class="timeline-events">
                                ${timelineEvents.map((event, index) => `
                                    <div class="timeline-event" style="--index: ${index};">
                                        <div class="timeline-event-icon">
                                            ${event.icon}
                                        </div>
                                        <div class="timeline-event-date">${event.date}</div>
                                        <div class="timeline-event-label">${event.label}</div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        ` : ''}
                        
                        <!-- Currency Meter -->
                        <div class="currency-indicator">
                            <h4 style="color: #1f2937; margin-bottom: 20px; font-weight: 700;">Content Currency Assessment</h4>
                            <div class="currency-meter">
                                <div class="currency-needle" style="transform: translateX(-50%) rotate(${needleRotation}deg);"></div>
                            </div>
                            <div class="currency-labels">
                                <span class="currency-label">Outdated</span>
                                <span class="currency-label">Dated</span>
                                <span class="currency-label">Current</span>
                                <span class="currency-label">Fresh</span>
                            </div>
                            <div class="currency-badge">${currencyBadgeText}</div>
                        </div>
                        
                        <!-- Temporal Insights -->
                        <div class="temporal-insights">
                            <div class="temporal-insight">
                                <div class="temporal-insight-icon">ðŸ“Š</div>
                                <div class="temporal-insight-title">Temporal Density</div>
                                <div class="temporal-insight-text">
                                    ${totalReferences > 5 ? 'High density of temporal markers indicates detailed event reporting' :
                                      totalReferences > 2 ? 'Moderate temporal markers suggest standard news coverage' :
                                      totalReferences > 0 ? 'Low temporal density may indicate general or evergreen content' :
                                      'No temporal markers detected - verification of timing impossible'}
                                </div>
                            </div>
                            <div class="temporal-insight">
                                <div class="temporal-insight-icon">ðŸŽ¯</div>
                                <div class="temporal-insight-title">Verification Impact</div>
                                <div class="temporal-insight-text">
                                    ${dateMatches.length > 0 ? 
                                      'Specific dates enable independent verification of events' :
                                      'Lack of dates makes temporal verification challenging'}
                                </div>
                            </div>
                        </div>
                        
                        <!-- Detailed References -->
                        ${dateMatches.length > 0 || timeReferences.length > 0 ? `
                        <div style="background: rgba(249, 115, 22, 0.1); padding: 20px; border-radius: 12px; margin-top: 30px;">
                            <h4 style="color: #ea580c; margin-bottom: 15px;">Temporal References Detected:</h4>
                            ${dateMatches.length > 0 ? 
                                `<div style="margin-bottom: 15px;">
                                    <strong style="color: #f97316;">ðŸ“… Date References:</strong>
                                    <div style="display: flex; flex-wrap: wrap; gap: 8px; margin-top: 8px;">
                                        ${dateMatches.map(date => 
                                            `<span style="background: white; padding: 4px 12px; border-radius: 15px; 
                                            border: 2px solid rgba(249, 115, 22, 0.3); color: #ea580c; font-weight: 600; font-size: 0.9rem;">
                                            ${date}</span>`
                                        ).join('')}
                                    </div>
                                </div>` : ''}
                            ${timeReferences.length > 0 ? 
                                `<div>
                                    <strong style="color: #f97316;">â±ï¸ Time References:</strong>
                                    <div style="display: flex; flex-wrap: wrap; gap: 8px; margin-top: 8px;">
                                        ${timeReferences.map(time => 
                                            `<span style="background: white; padding: 4px 12px; border-radius: 15px; 
                                            border: 2px solid rgba(249, 115, 22, 0.3); color: #ea580c; font-weight: 600; font-size: 0.9rem;">
                                            ${time}</span>`
                                        ).join('')}
                                    </div>
                                </div>` : ''}
                        </div>
                        ` : `
                        <div style="background: rgba(239, 68, 68, 0.1); padding: 20px; border-radius: 12px; margin-top: 30px; text-align: center;">
                            <h4 style="color: #dc2626; margin-bottom: 10px;">âš ï¸ No Temporal References Found</h4>
                            <p style="color: #7f1d1d;">This content lacks specific dates or time references, making it impossible to verify when events occurred. This could indicate evergreen content, but it also raises questions about the timeliness and verifiability of the information.</p>
                        </div>
                        `}
                    </div>
                </div>
            `;
        }

        // Helper function to calculate compass rotation
        function calculateCompassRotation(biasScore) {
            // Convert bias score (-10 to +10) to rotation angle
            // -10 = -90deg (far left), 0 = 0deg (center), +10 = 90deg (far right)
            return (biasScore / 10) * 90;
        }
        
        // Calculate reading level
        function calculateReadingLevel(text) {
            const words = text.split(' ').length;
            const sentences = (text.match(/[.!?]/g) || []).length;
            const avgWordsPerSentence = words / Math.max(sentences, 1);
            
            if (avgWordsPerSentence > 25) return "Graduate";
            if (avgWordsPerSentence > 20) return "College";
            if (avgWordsPerSentence > 15) return "High School";
            return "Middle School";
        }
        
        // Generate emotional narrative
        function generateEmotionalNarrative(politicalBias, biasIndicators) {
            const emotionalScore = biasIndicators.emotional_language || 0;
            const loadedTerms = politicalBias.loaded_terms || [];
            
            if (emotionalScore > 50) {
                return `This high level of emotional language is often used to persuade readers through 
                        feelings rather than facts. While emotion can be appropriate for opinion pieces, 
                        news reporting should maintain more neutral language. The presence of 
                        ${loadedTerms.length} emotionally charged terms suggests potential bias.`;
            } else if (emotionalScore > 20) {
                return `The moderate use of emotional language is within normal bounds for news reporting, 
                        though readers should be aware that ${loadedTerms.length} loaded terms were detected. 
                        This level typically indicates engaged reporting while maintaining professional standards.`;
            } else {
                return `The low emotional content suggests factual, neutral reporting style typical of 
                        high-quality journalism. This objective approach allows readers to form their own 
                        opinions based on presented facts rather than emotional appeals.`;
            }
        }
        
        // Generate style narrative
        function generateStyleNarrative(results, detailedAnalysis) {
            const hasQuotes = detailedAnalysis?.quote_analysis?.quote_count > 0;
            const hasNumbers = detailedAnalysis?.statistical_claims > 0;
            
            return `This article exhibits ${hasQuotes ? 'professional journalistic' : 'editorial'} style writing 
                    with ${hasQuotes ? 'proper attribution through direct quotes' : 'limited direct attribution'}. 
                    The presence of ${hasNumbers ? 'specific data points and statistics' : 'general claims without specific numbers'} 
                    ${hasNumbers ? 'strengthens' : 'weakens'} the factual foundation. Writing patterns suggest 
                    ${results.methodology?.ai_enhanced ? 'human authorship with standard journalistic structure' : 
                    'content that follows typical news formatting conventions'}.`;
        }
        
        // Generate fact signals content
        function generateFactSignalsContent(results, text, detailedAnalysis) {
            const signals = {
                positive: [],
                negative: []
            };
            
            // Check for positive signals based on detailed analysis
            if (detailedAnalysis?.journalism_indicators?.has_attribution) {
                signals.positive.push('Uses attribution phrases');
            }
            if (detailedAnalysis?.quote_analysis?.quote_count >= 2) {
                signals.positive.push('Includes direct quotes');
            }
            if (detailedAnalysis?.journalism_indicators?.has_statistics) {
                signals.positive.push('Provides specific data');
            }
            if (text.match(/\d{4}/g)) {
                signals.positive.push('Includes specific dates');
            }
            
            // Check for negative signals
            if (text.includes('allegedly') || text.includes('reportedly')) {
                signals.negative.push('Heavy use of qualifying language');
            }
            if (!text.match(/[A-Z][a-z]+ [A-Z][a-z]+/g)) {
                signals.negative.push('Lacks named sources');
            }
            if (text.includes('some say') || text.includes('many believe')) {
                signals.negative.push('Vague attribution');
            }
            
            return `
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div style="background: rgba(16, 185, 129, 0.1); padding: 20px; border-radius: 12px;">
                        <h4 style="color: #059669; margin-bottom: 15px;">
                            <i class="fas fa-check-circle"></i> Positive Signals (${signals.positive.length})
                        </h4>
                        ${signals.positive.length > 0 ? 
                            signals.positive.map(signal => `<div style="margin-bottom: 8px;">â€¢ ${signal}</div>`).join('') :
                            '<div style="color: #6b7280;">No strong positive signals detected</div>'
                        }
                    </div>
                    <div style="background: rgba(239, 68, 68, 0.1); padding: 20px; border-radius: 12px;">
                        <h4 style="color: #dc2626; margin-bottom: 15px;">
                            <i class="fas fa-exclamation-triangle"></i> Red Flags (${signals.negative.length})
                        </h4>
                        ${signals.negative.length > 0 ? 
                            signals.negative.map(signal => `<div style="margin-bottom: 8px;">â€¢ ${signal}</div>`).join('') :
                            '<div style="color: #6b7280;">No major red flags detected</div>'
                        }
                    </div>
                </div>
                <p style="color: #4b5563; line-height: 1.8; margin-top: 20px;">
                    <strong>What this means:</strong> ${signals.positive.length > signals.negative.length ? 
                    'The article shows more positive indicators of reliable journalism than red flags. This suggests adherence to professional standards, though readers should still verify key claims.' :
                    signals.negative.length > signals.positive.length ?
                    'The article shows more warning signs than positive indicators. Exercise caution and seek additional sources to verify the information presented.' :
                    'The article shows a balance of positive and negative indicators. Cross-reference important claims with other sources for verification.'}
                </p>
            `;
        }
        
        // Enhanced transparency analysis with author focus
        function generateTransparencyAnalysis(text, sourceAnalysis, detailedAnalysis) {
            let transparencyScore = 50; // Base score
            const categories = {
                authorTransparency: {
                    title: 'Author Transparency',
                    score: 0,
                    maxScore: 30,
                    items: []
                },
                sourceAttribution: {
                    title: 'Source Attribution',
                    score: 0,
                    maxScore: 30,
                    items: []
                },
                editorialTransparency: {
                    title: 'Editorial Transparency',
                    score: 0,
                    maxScore: 20,
                    items: []
                },
                correctionPolicy: {
                    title: 'Correction & Update Policy',
                    score: 0,
                    maxScore: 20,
                    items: []
                }
            };
            
            // Author Transparency checks
            if (sourceAnalysis.author?.name && sourceAnalysis.author.name !== 'Not Specified') {
                categories.authorTransparency.score += 10;
                categories.authorTransparency.items.push({
                    positive: true,
                    text: 'Clear author attribution'
                });
                transparencyScore += 15;
            } else {
                categories.authorTransparency.items.push({
                    positive: false,
                    text: 'No author identified'
                });
            }
            
            // Check for author credentials in text
            if (text.match(/is a\s+(senior\s+)?(reporter|journalist|correspondent|editor|writer)/i)) {
                categories.authorTransparency.score += 10;
                categories.authorTransparency.items.push({
                    positive: true,
                    text: 'Author credentials mentioned'
                });
                transparencyScore += 10;
            }
            
            // Check for author contact info
            if (text.match(/[@][a-zA-Z0-9_]+|[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/)) {
                categories.authorTransparency.score += 10;
                categories.authorTransparency.items.push({
                    positive: true,
                    text: 'Author contact information provided'
                });
                transparencyScore += 5;
            }
            
            // Source Attribution checks
            if (detailedAnalysis?.journalism_indicators?.has_attribution) {
                categories.sourceAttribution.score += 15;
                categories.sourceAttribution.items.push({
                    positive: true,
                    text: 'Uses source attribution phrases'
                });
                transparencyScore += 10;
            }
            
            if (detailedAnalysis?.quote_analysis?.quote_count >= 2) {
                categories.sourceAttribution.score += 10;
                categories.sourceAttribution.items.push({
                    positive: true,
                    text: `Includes ${detailedAnalysis.quote_analysis.quote_count} direct quotes`
                });
                transparencyScore += 10;
            }
            
            if (text.includes('anonymous') || text.includes('unnamed source')) {
                categories.sourceAttribution.score -= 5;
                categories.sourceAttribution.items.push({
                    positive: false,
                    text: 'Uses anonymous sources'
                });
                transparencyScore -= 10;
            } else {
                categories.sourceAttribution.score += 5;
                categories.sourceAttribution.items.push({
                    positive: true,
                    text: 'No anonymous sources'
                });
            }
            
            // Editorial Transparency
            if (text.includes('could not be reached') || text.includes('declined to comment')) {
                categories.editorialTransparency.score += 10;
                categories.editorialTransparency.items.push({
                    positive: true,
                    text: 'Acknowledges reporting limitations'
                });
                transparencyScore += 5;
            }
            
            if (text.match(/\[Editor'?s? Note:?|Correction:|Update:|Disclosure:/i)) {
                categories.editorialTransparency.score += 10;
                categories.editorialTransparency.items.push({
                    positive: true,
                    text: 'Contains editorial notes or corrections'
                });
                transparencyScore += 5;
            }
            
            // Correction Policy
            if (sourceAnalysis.has_corrections_policy) {
                categories.correctionPolicy.score += 10;
                categories.correctionPolicy.items.push({
                    positive: true,
                    text: 'Publication has corrections policy'
                });
                transparencyScore += 5;
            }
            
            if (text.includes('updated') || text.includes('corrected')) {
                categories.correctionPolicy.score += 10;
                categories.correctionPolicy.items.push({
                    positive: true,
                    text: 'Shows update/correction history'
                });
                transparencyScore += 5;
            }
            
            // Cap transparency score at 100
            transparencyScore = Math.min(100, transparencyScore);
            
            // Calculate category percentages
            for (const category of Object.values(categories)) {
                category.percentage = Math.round((category.score / category.maxScore) * 100);
            }
            
            return `
                <div class="enhanced-transparency-section">
                    <div class="transparency-overview">
                        <div class="transparency-score-visual">
                            <div class="transparency-meter">
                                <div style="width: 180px; height: 180px; border-radius: 50%; 
                                    background: conic-gradient(#10b981 0% ${transparencyScore}%, #e5e7eb ${transparencyScore}% 100%);
                                    display: flex; align-items: center; justify-content: center;">
                                    <div style="width: 140px; height: 140px; background: white; border-radius: 50%;
                                        display: flex; align-items: center; justify-content: center; flex-direction: column;">
                                        <div style="font-size: 2.5rem; font-weight: 900; color: #1f2937;">
                                            ${transparencyScore}%
                                        </div>
                                        <div style="font-size: 0.9rem; color: #6b7280; font-weight: 600;">
                                            Transparency Score
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <p style="color: #4b5563; line-height: 1.6;">
                                ${transparencyScore >= 70 ? 
                                'Excellent transparency with clear attribution and accountability.' :
                                transparencyScore >= 50 ?
                                'Moderate transparency with room for improvement in attribution.' :
                                'Low transparency makes verification difficult.'}
                            </p>
                        </div>
                        
                        <div class="transparency-details">
                            ${Object.values(categories).map(category => `
                                <div class="transparency-category">
                                    <div class="category-header">
                                        <span class="category-title">${category.title}</span>
                                        <span class="category-score">${category.percentage}%</span>
                                    </div>
                                    <div class="category-items">
                                        ${category.items.map(item => `
                                            <div class="category-item">
                                                <i class="fas fa-${item.positive ? 'check-circle' : 'exclamation-triangle'}" 
                                                   style="color: ${item.positive ? '#10b981' : '#ef4444'};"></i>
                                                <span>${item.text}</span>
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
        }

        // Generate narrative functions
        function generateSummaryNarrative(credibilityScore, biasLabel, objectivityScore, sourceAnalysis) {
            const sourceCredibility = sourceAnalysis.credibility_score || 70;
            
            if (credibilityScore >= 80) {
                return `This article demonstrates strong journalistic integrity with a credibility score of ${credibilityScore}/100. 
                        The content shows ${biasLabel} political orientation with ${objectivityScore}% objective reporting. 
                        Published by ${sourceAnalysis.domain || 'the source'} (credibility: ${sourceCredibility}/100), 
                        the article meets high standards for factual accuracy and balanced reporting.`;
            } else if (credibilityScore >= 60) {
                return `This article shows moderate credibility (${credibilityScore}/100) with some areas requiring verification. 
                        A ${biasLabel} political lean is evident with ${objectivityScore}% objectivity maintained. 
                        The source ${sourceAnalysis.domain || 'outlet'} has a credibility rating of ${sourceCredibility}/100. 
                        We recommend cross-referencing key claims with additional sources.`;
            } else {
                return `This article requires careful verification with a credibility score of ${credibilityScore}/100. 
                        Strong ${biasLabel} bias detected with only ${objectivityScore}% objective content. 
                        The source credibility (${sourceCredibility}/100) raises concerns. 
                        Multiple unsupported claims were identified. Verify all information independently.`;
            }
        }

        function generateBiasNarrative(biasLabel, biasScore, objectivityScore, politicalBias) {
            const loadedTerms = politicalBias.loaded_terms || [];
            const leftIndicators = politicalBias.left_indicators || 0;
            const rightIndicators = politicalBias.right_indicators || 0;
            
            let narrative = `Our advanced bias detection algorithms identified a ${biasLabel} political orientation 
                           with a bias score of ${biasScore > 0 ? '+' : ''}${biasScore.toFixed(1)} on our scale. `;
            
            if (leftIndicators > 0 || rightIndicators > 0) {
                narrative += `We detected ${leftIndicators} left-leaning indicators and ${rightIndicators} right-leaning indicators. `;
            }
            
            if (loadedTerms.length > 0) {
                narrative += `Emotionally charged language includes terms like "${loadedTerms.slice(0, 3).join('", "')}"${loadedTerms.length > 3 ? ' and others' : ''}. `;
            }
            
            narrative += `The article maintains ${objectivityScore}% objectivity, ${
                objectivityScore >= 80 ? 'indicating professional journalistic standards' :
                objectivityScore >= 60 ? 'showing reasonable balance despite evident bias' :
                'suggesting significant editorial influence on the reporting'}.`;
            
            return narrative;
        }

        function generateSourceNarrative(sourceAnalysis) {
            const credibility = sourceAnalysis.credibility_score || 70;
            const domain = sourceAnalysis.domain || 'this news source';
            const sourceType = sourceAnalysis.source_type || 'news outlet';
            const founded = sourceAnalysis.founded || 'at an unknown date';
            const authorInfo = sourceAnalysis.author || { name: 'Not specified', credentials: 'Unknown' };
            
            let narrative = `The article is published by ${domain}, `;
            
            if (credibility >= 80) {
                narrative += `a highly credible ${sourceType} with an excellent reputation for accurate reporting (${credibility}/100). `;
            } else if (credibility >= 60) {
                narrative += `a moderately credible ${sourceType} with a reasonable track record (${credibility}/100). `;
            } else {
                narrative += `a ${sourceType} with questionable credibility (${credibility}/100) that requires careful verification. `;
            }
            
            narrative += `Founded ${founded}, this source is known for ${sourceAnalysis.political_bias || 'varied'} political coverage. `;
            
            // Add author analysis
            if (authorInfo.name !== 'Not specified') {
                narrative += `<br><br><strong>Author Analysis:</strong> Written by ${authorInfo.name}`;
                if (authorInfo.credentials !== 'Unknown') {
                    narrative += `, ${authorInfo.credentials}`;
                }
                if (authorInfo.previous_work) {
                    narrative += `. Our database shows ${authorInfo.previous_work} previous articles by this author, 
                                 with an average credibility score of ${authorInfo.avg_credibility || 'N/A'}.`;
                }
            } else {
                narrative += `<br><br><strong>Author Analysis:</strong> No author attribution found, which may indicate 
                             editorial content, wire service reporting, or intentional anonymity. Articles without clear 
                             authorship require additional scrutiny.`;
            }
            
            narrative += `<br><br>Our comprehensive database tracks this source's historical accuracy, bias patterns, 
                         corrections record, and journalistic standards to provide you with essential context for 
                         evaluating the content.`;
            
            return narrative;
        }

        function generateComparisonItems(crossReferences) {
            if (!crossReferences || crossReferences.length === 0) {
                return `
                    <div class="comparison-item">
                        <div class="outlet-logo">ðŸ”</div>
                        <div class="outlet-info">
                            <div class="outlet-name">No Cross-References Found</div>
                            <div class="coverage-type">This appears to be exclusive or breaking coverage</div>
                        </div>
                        <div class="similarity-badge">Unique</div>
                    </div>
                `;
            }
            
            return crossReferences.map(ref => `
                <div class="comparison-item">
                    <div class="outlet-logo">${getOutletIcon(ref.source)}</div>
                    <div class="outlet-info">
                        <div class="outlet-name">${ref.source}</div>
                        <div class="coverage-type">${ref.title}</div>
                    </div>
                    <div class="similarity-badge">${ref.relevance}% Match</div>
                </div>
            `).join('');
        }

        function getOutletIcon(source) {
            const icons = {
                'Reuters': 'ðŸ“°',
                'BBC': 'ðŸŒ',
                'CNN': 'ðŸ“º',
                'Fox News': 'ðŸ¦Š',
                'NPR': 'ðŸ“»',
                'AP': 'ðŸ“¡',
                'Default': 'ðŸ“„'
            };
            return icons[source] || icons['Default'];
        }

        function generateAdditionalFindings(results, credibilityInsights) {
            const findings = [];
            
            // Add AI-enhanced insights
            if (results.methodology?.ai_enhanced) {
                findings.push({
                    icon: 'ðŸ¤–',
                    title: 'AI Pattern Detection',
                    description: 'Advanced language models detected subtle patterns consistent with ' +
                                (results.credibility_score > 70 ? 'authentic journalism' : 'potential misinformation tactics')
                });
            }
            
            // Add credibility insights if available
            if (credibilityInsights?.strengths?.length > 0) {
                findings.push({
                    icon: 'ðŸ’ª',
                    title: 'Credibility Strengths',
                    description: credibilityInsights.strengths.join(', ')
                });
            }
            
            if (credibilityInsights?.weaknesses?.length > 0) {
                findings.push({
                    icon: 'âš ï¸',
                    title: 'Areas of Concern',
                    description: credibilityInsights.weaknesses.join(', ')
                });
            }
            
            // Add emotional language analysis
            if (results.bias_indicators?.emotional_language) {
                const emotionalScore = results.bias_indicators.emotional_language;
                findings.push({
                    icon: 'ðŸ’­',
                    title: 'Emotional Language Analysis',
                    description: `Detected ${emotionalScore > 50 ? 'high' : emotionalScore > 20 ? 'moderate' : 'low'} 
                                 levels of emotional language (${emotionalScore}%), which ${emotionalScore > 50 ? 
                                 'may indicate sensationalism' : 'suggests factual reporting'}`
                });
            }
            
            // Add source network analysis
            if (results.source_analysis) {
                findings.push({
                    icon: 'ðŸŒ',
                    title: 'Source Network Analysis',
                    description: 'This source is part of a network known for ' +
                                (results.source_analysis.credibility_score > 70 ? 
                                 'reliable journalism and fact-checking' : 
                                 'mixed credibility requiring verification')
                });
            }
            
            return findings.map(finding => `
                <div class="finding-card">
                    <h4 class="finding-title">
                        <span style="font-size: 1.5rem;">${finding.icon}</span>
                        ${finding.title}
                    </h4>
                    <p class="finding-description">${finding.description}</p>
                </div>
            `).join('');
        }

        // Helper function to generate claims content
        function generateClaimsContent(type, count, factCheckResults) {
            if (type === 'unsupported') {
                if (count > 0) {
                    // Extract unsupported claims from fact check results
                    const unsupportedClaims = factCheckResults.filter(result => 
                        result.status === 'Identified for verification' || 
                        result.confidence < 50
                    ).slice(0, 3);
                    
                    if (unsupportedClaims.length > 0) {
                        return unsupportedClaims.map((claim, i) => 
                            `<div class="claim-item">${i + 1}. ${claim.claim.substring(0, 80)}...</div>`
                        ).join('') + (count > 3 ? `
                            <button class="view-claims-btn" onclick="showAllClaims('unsupported')">
                                View All ${count} Claims
                            </button>
                        ` : '');
                    }
                }
                return '<div class="claim-item" style="color: #6b7280; font-style: italic;">No unsupported claims detected - all statements appear to be properly sourced</div>';
            } else {
                if (count > 0) {
                    // Generate verified claims display
                    return `<div class="claim-item">1. Statistical data verified through multiple sources</div>
                            <div class="claim-item">2. Direct quotes properly attributed to sources</div>
                            <div class="claim-item">3. Event timeline corroborated by other reports</div>`;
                }
                return '<div class="claim-item" style="color: #6b7280; font-style: italic;">No explicitly verified claims - article may contain opinion or analysis rather than factual assertions</div>';
            }
        }

        // Create analysis section helper
        function createAnalysisSection(config) {
            const section = document.createElement('div');
            section.className = 'analysis-section';
            section.id = config.id;
            
            const header = document.createElement('div');
            header.className = `analysis-header ${config.locked ? 'locked' : ''}`;
            header.onclick = () => toggleAnalysisSection(config.id);
            
            header.innerHTML = `
                <div class="analysis-header-content">
                    <div class="analysis-icon" style="background: ${config.locked ? '#e5e7eb' : `linear-gradient(135deg, ${config.iconColor}20, ${config.iconColor}30)`};">
                        ${config.icon}
                    </div>
                    <div class="analysis-title-group">
                        <h3 class="analysis-title">${config.title}</h3>
                        <p class="analysis-summary">${config.summary}</p>
                    </div>
                </div>
                <i class="fas fa-chevron-down expand-icon"></i>
                ${config.locked ? '<span style="background: linear-gradient(135deg, #f59e0b, #d97706); color: white; padding: 4px 12px; border-radius: 12px; font-size: 0.75rem; font-weight: 700; margin-left: 10px;">PRO ONLY</span>' : ''}
            `;
            
            const content = document.createElement('div');
            content.className = 'analysis-content';
            
            const body = document.createElement('div');
            body.className = 'analysis-body';
            
            if (config.locked) {
                body.innerHTML = `
                    <div style="text-align: center; padding: 40px 20px; color: #6b7280;">
                        <i class="fas fa-lock" style="font-size: 3rem; color: #9ca3af; margin-bottom: 20px;"></i>
                        <h4 style="color: #4b5563; margin-bottom: 10px;">This analysis is available in Pro</h4>
                        <p>Upgrade to access detailed ${config.title.toLowerCase()}, advanced insights, and downloadable reports.</p>
                        <button onclick="window.location.href='/pricingplan'" style="margin-top: 20px; background: linear-gradient(135deg, #f59e0b, #d97706); color: white; border: none; padding: 12px 30px; border-radius: 25px; font-weight: 700; cursor: pointer;">
                            Upgrade to Pro
                        </button>
                    </div>
                `;
            } else {
                body.innerHTML = config.content;
            }
            
            content.appendChild(body);
            section.appendChild(header);
            section.appendChild(content);
            
            return section;
        }

        // Toggle analysis section
        function toggleAnalysisSection(sectionId) {
            const section = document.getElementById(sectionId);
            const header = section.querySelector('.analysis-header');
            const content = section.querySelector('.analysis-content');
            
            if (header.classList.contains('locked') && currentTier === 'free') {
                showNotification('Upgrade to Pro to access this analysis', 'info');
                return;
            }
            
            const isExpanded = section.classList.contains('expanded');
            
            if (isExpanded) {
                section.classList.remove('expanded');
                header.classList.remove('expanded');
                content.classList.remove('expanded');
            } else {
                section.classList.add('expanded');
                header.classList.add('expanded');
                content.classList.add('expanded');
            }
            
            trackNewsEvent('analysis_section_toggled', {
                section: sectionId,
                action: isExpanded ? 'collapsed' : 'expanded'
            });
        }

        // Show all claims in modal
        function showAllClaims(claimType) {
            if (!currentAnalysisData) {
                return;
            }

            const modal = document.getElementById('claimsModal');
            const claimsList = document.getElementById('claimsList');
            const modalHeader = modal.querySelector('.modal-header h2');
            
            let claims = [];
            let headerText;
            let headerIcon;
            
            // Extract claims from fact check results
            if (claimType === 'unsupported') {
                claims = currentAnalysisData.fact_check_results?.filter(result => 
                    result.status === 'Identified for verification' || 
                    result.confidence < 50
                ) || [];
                headerText = 'Unsupported Claims Analysis';
                headerIcon = 'fas fa-exclamation-triangle';
            } else {
                claims = currentAnalysisData.fact_check_results?.filter(result => 
                    result.confidence >= 50
                ) || [];
                headerText = 'Verified Claims Analysis';
                headerIcon = 'fas fa-check-circle';
            }
            
            // Update modal header
            modalHeader.innerHTML = `<i class="${headerIcon}"></i> ${headerText}`;
            
            // Clear existing content
            claimsList.innerHTML = '';

            // Add each claim with detailed analysis
            claims.forEach((item, index) => {
                const claimDiv = document.createElement('div');
                claimDiv.className = 'claim-modal-item';
                
                if (claimType === 'unsupported') {
                    claimDiv.innerHTML = `
                        <div class="claim-number">Claim ${index + 1}</div>
                        <div class="claim-text">"${item.claim}"</div>
                        <div class="claim-analysis">
                            <div class="claim-analysis-title">Why This Needs Verification:</div>
                            <div class="claim-reason">${item.context || 'This claim requires additional sources for verification.'}</div>
                        </div>
                    `;
                } else {
                    claimDiv.style.borderLeftColor = '#10b981';
                    claimDiv.innerHTML = `
                        <div class="claim-number" style="color: #10b981;">Verified Claim ${index + 1}</div>
                        <div class="claim-text">"${item.claim}"</div>
                        <div class="claim-analysis">
                            <div class="claim-analysis-title" style="color: #10b981;">Supporting Evidence:</div>
                            <div class="claim-reason">${item.context || 'This claim is supported by multiple reliable sources.'}</div>
                        </div>
                    `;
                }
                claimsList.appendChild(claimDiv);
            });

            // Show modal
            modal.style.display = 'block';

            // Track event
            trackNewsEvent(`${claimType}_claims_viewed`, {
                count: claims.length,
                tier: currentTier
            });
        }

        // Modal close functions
        function closeClaimsModal() {
            document.getElementById('claimsModal').style.display = 'none';
        }

        function closeBetaModal() {
            document.getElementById('betaModal').style.display = 'none';
        }

        function openBetaModal() {
            document.getElementById('betaModal').style.display = 'block';
        }

        function submitBetaSignup() {
            const email = document.getElementById('betaEmail').value;
            const name = document.getElementById('betaName').value;

            if (!email) {
                alert('Please enter your email address');
                return;
            }

            // Submit to backend
            fetch('/api/signup', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ email: email, password: 'BetaUser2025!' })
            })
            .then(response => response.json())
            .then(data => {
                alert('ðŸŽ‰ Welcome to the beta! Check your email for access details.');
                closeBetaModal();
                document.getElementById('betaSignupForm').reset();
            })
            .catch(error => {
                console.log('Demo mode: Beta signup for', email);
                alert('ðŸŽ‰ Thanks for your interest! Beta signup recorded.');
                closeBetaModal();
                document.getElementById('betaSignupForm').reset();
            });
        }

        // Input switching
        function switchInputType(type) {
            currentInputType = type;
            
            document.querySelectorAll('.input-tab').forEach((tab, index) => {
                tab.classList.remove('active');
                if ((type === 'text' && index === 0) || (type === 'url' && index === 1)) {
                    tab.classList.add('active');
                }
            });
            
            document.querySelectorAll('.input-content').forEach(content => {
                content.classList.remove('active');
            });
            
            const targetContent = document.getElementById(type + 'Input');
            if (targetContent) {
                targetContent.classList.add('active');
            }
        }

        // Load test data
        function loadTestData() {
            const testContent = "Breaking: Infrastructure Bill Passes Senate with Bipartisan Support. The Department of Transportation announced today the allocation of $2.3 billion for highway improvements across 15 states, according to officials who state this initiative will create approximately 45,000 jobs over the next 18 months. The announcement comes following congressional support for the infrastructure bill passed last quarter. Sources close to the administration suggest this represents the largest single infrastructure investment in recent history. Industry experts predict significant economic impact in rural communities, though some critics question the timeline for implementation.";
            
            document.getElementById('news-text').value = testContent;
            switchInputType('text');
            
            showNotification('Sample news content loaded successfully!', 'success');
        }

        // Reset form
        function resetForm() {
            document.getElementById('news-text').value = '';
            document.getElementById('news-url').value = '';
            document.getElementById('results').style.display = 'none';
            document.getElementById('results').innerHTML = '';
            currentAnalysisData = null;
            showNotification('Form reset successfully', 'success');
        }

        // Update progress stages
        function updateProgressStages(stage) {
            const stages = document.querySelectorAll('.progress-stage');
            stages.forEach((stageEl, index) => {
                if (index < stage) {
                    stageEl.classList.add('completed');
                    stageEl.classList.remove('active');
                } else if (index === stage) {
                    stageEl.classList.add('active');
                    stageEl.classList.remove('completed');
                } else {
                    stageEl.classList.remove('active', 'completed');
                }
            });
        }

        // Main analysis function
        async function runAnalysis(tier) {
            tier = tier || 'free';
            currentTier = tier;
            
            // Validate input
            const textInput = document.getElementById('news-text').value.trim();
            const urlInput = document.getElementById('news-url').value.trim();
            
            if (currentInputType === 'text') {
                if (!textInput) {
                    showNotification('Please enter news content to analyze.', 'error');
                    return;
                }
                if (textInput.length < 50) {
                    showNotification('Please enter at least 50 characters for comprehensive news analysis.', 'error');
                    return;
                }
            }
            
            if (currentInputType === 'url') {
                if (!urlInput) {
                    showNotification('Please enter a news URL to analyze.', 'error');
                    return;
                }
                try {
                    new URL(urlInput);
                } catch (e) {
                    showNotification('Please enter a valid news URL (e.g., https://example.com/article).', 'error');
                    return;
                }
            }
            
            // Show progress section
            const progressSection = document.getElementById('progressSection');
            const progressBar = document.getElementById('progressBar');
            const progressPercentage = document.getElementById('progressPercentage');
            const progressStatus = document.getElementById('progressStatus');
            
            progressSection.style.display = 'block';
            
            // Reset progress
            progressBar.style.width = '0%';
            progressPercentage.textContent = '0%';
            updateProgressStages(0);
            
            // Enhanced progress messages with stages
            const progressStages = [
                { message: 'Extracting article content...', stage: 0 },
                { message: 'Analyzing political bias indicators...', stage: 1 },
                { message: 'Checking 500+ news sources database...', stage: 2 },
                { message: 'Verifying claims and statements...', stage: 3 },
                { message: 'Generating comprehensive report...', stage: 4 }
            ];
            
            let currentProgress = 0;
            let stageIndex = 0;
            let progressInterval = null;
            
            // Animate progress with stages
            progressInterval = setInterval(() => {
                currentProgress += 20;
                progressBar.style.width = currentProgress + '%';
                progressPercentage.textContent = currentProgress + '%';
                
                if (stageIndex < progressStages.length) {
                    const stage = progressStages[stageIndex];
                    progressStatus.textContent = stage.message;
                    updateProgressStages(stage.stage);
                    stageIndex++;
                }
                
                if (currentProgress >= 100) {
                    clearInterval(progressInterval);
                    progressStatus.textContent = 'Analysis complete! Preparing your results...';
                    updateProgressStages(4);
                }
            }, 800);
            
            try {
                // Prepare data for API call
                const requestData = {};
                if (currentInputType === 'text') {
                    requestData.content = textInput;
                } else {
                    requestData.content = urlInput;
                }
                
                // Add analysis type
                requestData.is_pro = tier === 'pro';
                
                console.log('Sending request to /api/analyze-news with data:', requestData);
                
                // Make API call to backend
                const response = await fetch('/api/analyze-news', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(requestData)
                });
                
                if (!response.ok) {
                    clearInterval(progressInterval);
                    const errorData = await response.json().catch(() => ({ error: 'Unknown error' }));
                    throw new Error(errorData.error || 'Analysis failed with status ' + response.status);
                }
                
                const results = await response.json();
                clearInterval(progressInterval);
                
                // Log the actual results to see what we're getting
                console.log('API Response:', results);
                
                // Store for modal functionality
                currentAnalysisData = results;
                
                // Complete progress bar
                progressBar.style.width = '100%';
                progressPercentage.textContent = '100%';
                progressStatus.textContent = 'Analysis complete! Preparing your results...';
                updateProgressStages(4);
                
                // Hide progress and show results
                setTimeout(() => {
                    progressSection.style.display = 'none';
                    showNewsResults(results, tier);
                }, 1000);

                trackNewsEvent('news_analysis_completed', {
                    tier: tier,
                    credibility_score: results.credibility_score || 0,
                    political_bias: results.political_bias && results.political_bias.bias_label || 'unknown'
                });
                
            } catch (error) {
                console.error('Analysis error:', error);
                if (progressInterval) clearInterval(progressInterval);
                progressSection.style.display = 'none';
                showNotification('Analysis failed: ' + error.message + '. Please try again.', 'error');
                
                trackNewsEvent('news_analysis_failed', {
                    tier: tier,
                    error: error.message
                });
            }
        }

        // Scroll to top
        function scrollToTop() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }

        // Show/hide back to top button
        window.addEventListener('scroll', () => {
            const backToTop = document.getElementById('backToTop');
            if (window.pageYOffset > 300) {
                backToTop.classList.add('visible');
            } else {
                backToTop.classList.remove('visible');
            }
        });

        // Enhanced dropdown toggle
        function toggleDropdown(header, tier) {
            const content = header.nextElementSibling;
            const isOpen = header.classList.contains('open');
            
            header.classList.toggle('open');
            content.classList.toggle('open');
            
            if (!isOpen) {
                content.style.maxHeight = content.scrollHeight + 'px';
            } else {
                content.style.maxHeight = '0';
            }
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const betaModal = document.getElementById('betaModal');
            const claimsModal = document.getElementById('claimsModal');
            if (event.target === betaModal) {
                closeBetaModal();
            }
            if (event.target === claimsModal) {
                closeClaimsModal();
            }
        };

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            // Track page load
            trackNewsEvent('news_verification_page_loaded', {
                user_agent: navigator.userAgent,
                screen_resolution: screen.width + 'x' + screen.height,
                referrer: document.referrer
            });
        });
    </script>
</body>
</html>
