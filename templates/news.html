<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NewsVerify Pro - Real News Verification Platform</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>📰</text></svg>">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Fixed Header */
        header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            transition: all 0.3s ease;
        }

        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            color: #2c3e50;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .nav-links {
            display: flex;
            list-style: none;
            gap: 2rem;
            align-items: center;
        }

        .nav-links a {
            text-decoration: none;
            color: #2c3e50;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .nav-links a:hover, .nav-links a.active {
            color: #667eea;
        }

        .cta-button {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 25px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        /* Fixed Progress Section - Always Visible */
        .progress-section {
            position: fixed;
            top: 70px;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            padding: 1rem 0;
            box-shadow: 0 2px 15px rgba(0, 0, 0, 0.1);
            z-index: 999;
            transform: translateY(-100%);
            transition: transform 0.3s ease;
        }

        .progress-section.active {
            transform: translateY(0);
        }

        .progress-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .analysis-status {
            font-weight: 600;
            color: #2c3e50;
            font-size: 1.1rem;
        }

        .reset-button {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .reset-button:hover {
            background: #c0392b;
            transform: translateY(-1px);
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #ecf0f1;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 0.5rem;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 4px;
        }

        .progress-steps {
            display: flex;
            justify-content: space-between;
            font-size: 0.85rem;
            color: #7f8c8d;
        }

        .step {
            transition: color 0.3s ease;
        }

        .step.completed {
            color: #27ae60;
            font-weight: 600;
        }

        .step.active {
            color: #667eea;
            font-weight: 600;
        }

        /* Main Content */
        main {
            padding-top: 120px;
            min-height: 100vh;
        }

        .hero-section {
            text-align: center;
            padding: 4rem 0;
            color: white;
        }

        .hero-section h1 {
            font-size: 3.5rem;
            margin-bottom: 1rem;
            font-weight: 700;
        }

        .hero-section p {
            font-size: 1.3rem;
            margin-bottom: 2rem;
            opacity: 0.9;
        }

        .analysis-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 3rem;
            margin: 2rem 0;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }

        .input-tabs {
            display: flex;
            background: #f8f9fa;
            border-radius: 15px;
            padding: 0.5rem;
            margin-bottom: 2rem;
        }

        .tab {
            flex: 1;
            padding: 1rem;
            text-align: center;
            border-radius: 10px;
            background: transparent;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #6c757d;
        }

        .tab.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .input-section {
            display: none;
        }

        .input-section.active {
            display: block;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #2c3e50;
        }

        .form-control {
            width: 100%;
            padding: 1rem;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .form-control:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        textarea.form-control {
            resize: vertical;
            min-height: 150px;
        }

        .sample-buttons {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .sample-btn {
            padding: 0.5rem 1rem;
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .sample-btn:hover {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .analyze-button {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 1rem 2rem;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin-bottom: 2rem;
        }

        .analyze-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .analyze-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        /* Results Section */
        .results-section {
            display: none;
            margin-top: 2rem;
            padding-top: 2rem;
        }

        .results-section.visible {
            display: block;
        }

        .results-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .result-card {
            background: white;
            border-radius: 15px;
            padding: 2rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .result-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
        }

        .result-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .result-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: #2c3e50;
        }

        .tier-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .tier-free {
            background: #e8f5e8;
            color: #27ae60;
        }

        .tier-pro {
            background: #fef3e2;
            color: #f39c12;
        }

        .score-display {
            text-align: center;
            margin-bottom: 1.5rem;
        }

        .score-circle {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: conic-gradient(#667eea 0deg, #764ba2 180deg, #ecf0f1 180deg);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1rem;
            position: relative;
        }

        .score-inner {
            width: 90px;
            height: 90px;
            border-radius: 50%;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }

        .score-number {
            font-size: 2rem;
            font-weight: 700;
            color: #2c3e50;
        }

        .score-label {
            font-size: 0.8rem;
            color: #7f8c8d;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .chart-container {
            width: 100%;
            height: 200px;
            margin-bottom: 1rem;
        }

        .locked-feature {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border: 2px dashed #dee2e6;
            border-radius: 10px;
            padding: 2rem;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .locked-feature::before {
            content: '🔒';
            font-size: 3rem;
            opacity: 0.3;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .unlock-button {
            background: linear-gradient(135deg, #f39c12, #e67e22);
            color: white;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 1rem;
            transition: all 0.3s ease;
        }

        .unlock-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(243, 156, 18, 0.4);
        }

        .summary-section {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-radius: 15px;
            padding: 2rem;
            margin-top: 2rem;
        }

        .summary-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
        }

        .summary-content {
            font-size: 1.1rem;
            line-height: 1.6;
        }

        .details-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .detail-card {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            border-left: 4px solid #667eea;
        }

        .detail-title {
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 0.5rem;
        }

        .detail-content {
            color: #7f8c8d;
            font-size: 0.95rem;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .results-grid {
                grid-template-columns: 1fr;
            }
            
            .hero-section h1 {
                font-size: 2.5rem;
            }
            
            .analysis-container {
                padding: 2rem 1rem;
            }
            
            .nav-links {
                display: none;
            }
        }

        /* Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-in {
            animation: fadeInUp 0.6s ease forwards;
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body>
    <header>
        <nav class="container">
            <a href="/" class="logo">
                📰 Facts & Fakes AI
            </a>
            <ul class="nav-links">
                <li><a href="/">Home</a></li>
                <li><a href="/news" class="active">News Verify</a></li>
                <li><a href="/imageanalysis">Image Analysis</a></li>
                <li><a href="/unified">AI Detection</a></li>
                <li><a href="/missionstatement">Mission</a></li>
                <li><a href="/pricingplan" class="cta-button">Pricing</a></li>
            </ul>
        </nav>
    </header>

    <!-- Fixed Progress Section -->
    <div class="progress-section" id="progressSection">
        <div class="progress-container">
            <div class="progress-header">
                <div class="analysis-status" id="analysisStatus">Ready to analyze</div>
                <button class="reset-button" id="resetButton" onclick="resetAnalysis()">🔄 Reset</button>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-steps">
                <span class="step" id="step1">📡 Content Extraction</span>
                <span class="step" id="step2">🤖 AI Analysis</span>
                <span class="step" id="step3">🎯 Bias Detection</span>
                <span class="step" id="step4">✅ Fact Checking</span>
                <span class="step" id="step5">📊 Final Report</span>
            </div>
        </div>
    </div>

    <main>
        <section class="hero-section">
            <div class="container">
                <h1>NewsVerify Pro</h1>
                <p>Professional news verification with real-time fact-checking, bias analysis, and source credibility scoring</p>
            </div>
        </section>

        <section class="container">
            <div class="analysis-container">
                <div class="input-tabs">
                    <button class="tab active" onclick="switchTab('url')">🔗 Analyze URL</button>
                    <button class="tab" onclick="switchTab('text')">📝 Analyze Text</button>
                </div>

                <!-- URL Input Section -->
                <div class="input-section active" id="urlSection">
                    <div class="sample-buttons">
                        <button class="sample-btn" onclick="loadSampleURL('cnn')">📺 CNN Article</button>
                        <button class="sample-btn" onclick="loadSampleURL('reuters')">📰 Reuters</button>
                        <button class="sample-btn" onclick="loadSampleURL('bbc')">🌍 BBC News</button>
                        <button class="sample-btn" onclick="loadSampleURL('fox')">🦊 Fox News</button>
                    </div>
                    <div class="form-group">
                        <label for="urlInput">Enter News Article URL:</label>
                        <input type="url" class="form-control" id="urlInput" placeholder="https://example.com/news-article">
                    </div>
                    <button class="analyze-button" onclick="analyzeNews('url')">
                        🔍 Verify News Article
                    </button>
                </div>

                <!-- Text Input Section -->
                <div class="input-section" id="textSection">
                    <div class="sample-buttons">
                        <button class="sample-btn" onclick="loadSampleText('political')">🏛️ Political News</button>
                        <button class="sample-btn" onclick="loadSampleText('breaking')">⚡ Breaking News</button>
                        <button class="sample-btn" onclick="loadSampleText('science')">🔬 Science News</button>
                    </div>
                    <div class="form-group">
                        <label for="textInput">Paste News Article Text:</label>
                        <textarea class="form-control" id="textInput" placeholder="Paste your news article text here..."></textarea>
                    </div>
                    <button class="analyze-button" onclick="analyzeNews('text')">
                        🔍 Verify News Content
                    </button>
                </div>

                <!-- Results Section -->
                <div class="results-section" id="resultsSection">
                    <div class="results-grid">
                        <!-- Credibility Score Card -->
                        <div class="result-card animate-in">
                            <div class="result-header">
                                <div class="result-title">Overall Credibility</div>
                                <div class="tier-badge tier-free">FREE</div>
                            </div>
                            <div class="score-display">
                                <div class="score-circle" id="credibilityCircle">
                                    <div class="score-inner">
                                        <div class="score-number" id="credibilityScore">--</div>
                                        <div class="score-label">Score</div>
                                    </div>
                                </div>
                                <div id="credibilityGrade" style="font-size: 1.2rem; font-weight: 700; color: #667eea;">Grade: --</div>
                            </div>
                        </div>

                        <!-- Source Analysis Card -->
                        <div class="result-card animate-in">
                            <div class="result-header">
                                <div class="result-title">Source Analysis</div>
                                <div class="tier-badge tier-free">FREE</div>
                            </div>
                            <div class="chart-container">
                                <canvas id="sourceChart"></canvas>
                            </div>
                            <div id="sourceDetails"></div>
                        </div>

                        <!-- Bias Analysis Card - Pro Feature -->
                        <div class="result-card animate-in">
                            <div class="result-header">
                                <div class="result-title">Political Bias Analysis</div>
                                <div class="tier-badge tier-pro">PRO</div>
                            </div>
                            <div id="biasAnalysis" class="locked-feature">
                                <h4>Advanced Bias Detection</h4>
                                <p>Unlock detailed political bias analysis, sentiment mapping, and objectivity scoring</p>
                                <button class="unlock-button" onclick="showUpgrade()">Upgrade to Pro</button>
                            </div>
                        </div>

                        <!-- Fact Check Results Card - Pro Feature -->
                        <div class="result-card animate-in">
                            <div class="result-header">
                                <div class="result-title">Fact Check Results</div>
                                <div class="tier-badge tier-pro">PRO</div>
                            </div>
                            <div id="factCheckResults" class="locked-feature">
                                <h4>Real-Time Fact Checking</h4>
                                <p>Access Google Fact-Check API results and claim verification database</p>
                                <button class="unlock-button" onclick="showUpgrade()">Upgrade to Pro</button>
                            </div>
                        </div>
                    </div>

                    <!-- AI Summary Section -->
                    <div class="summary-section animate-in">
                        <div class="summary-title">🤖 AI Analysis Summary</div>
                        <div class="summary-content" id="summaryContent">
                            Your conversational analysis summary will appear here...
                        </div>
                    </div>

                    <!-- Detailed Results -->
                    <div class="details-section" id="detailsSection">
                        <!-- Details will be populated here -->
                    </div>
                </div>
            </div>
        </section>
    </main>

    <script>
        let currentAnalysis = null;
        let analysisInProgress = false;

        // Tab switching
        function switchTab(tab) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.input-section').forEach(s => s.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tab + 'Section').classList.add('active');
        }

        // Sample URL loading
        function loadSampleURL(type) {
            const urls = {
                cnn: 'https://www.cnn.com/2024/01/15/politics/example-article',
                reuters: 'https://www.reuters.com/world/example-breaking-news-2024-01-15',
                bbc: 'https://www.bbc.com/news/world-example-story-2024',
                fox: 'https://www.foxnews.com/politics/example-political-story'
            };
            document.getElementById('urlInput').value = urls[type] || '';
        }

        // Sample text loading
        function loadSampleText(type) {
            const texts = {
                political: "BREAKING: In a shocking turn of events, new legislation has been proposed that could revolutionize the political landscape. According to unnamed sources close to the matter, this unprecedented move has sent shockwaves through Washington D.C. The implications are said to be far-reaching and could affect millions of Americans.",
                breaking: "URGENT UPDATE: Scientists have made an incredible discovery that challenges everything we thought we knew about climate change. This groundbreaking research, published in a peer-reviewed journal, reveals startling new data that could change our understanding of global warming forever.",
                science: "A new study published in Nature magazine reveals promising results in cancer research. The research team, led by Dr. Sarah Johnson at Stanford University, found that a novel treatment approach showed significant improvement in patient outcomes during clinical trials involving 200 participants over 18 months."
            };
            document.getElementById('textInput').value = texts[type] || '';
        }

        // Main analysis function
        async function analyzeNews(inputType) {
            if (analysisInProgress) return;
            
            const input = inputType === 'url' ? 
                document.getElementById('urlInput').value.trim() : 
                document.getElementById('textInput').value.trim();
                
            if (!input) {
                alert('Please enter a URL or text to analyze');
                return;
            }

            analysisInProgress = true;
            showProgress();
            
            try {
                const requestData = inputType === 'url' ? {url: input} : {text: input};
                
                const response = await fetch('/api/analyze-news', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(requestData)
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const results = await response.json();
                
                if (results.status === 'success') {
                    currentAnalysis = results;
                    displayResults(results);
                } else {
                    throw new Error(results.error || 'Analysis failed');
                }
                
            } catch (error) {
                console.error('Analysis error:', error);
                alert('Analysis failed: ' + error.message);
                resetProgress();
            }
            
            analysisInProgress = false;
        }

        // Progress animation
        function showProgress() {
            const progressSection = document.getElementById('progressSection');
            const progressFill = document.getElementById('progressFill');
            const analysisStatus = document.getElementById('analysisStatus');
            
            progressSection.classList.add('active');
            
            const steps = [
                {id: 'step1', text: '📡 Extracting content...', progress: 20},
                {id: 'step2', text: '🤖 Running AI analysis...', progress: 40},
                {id: 'step3', text: '🎯 Detecting bias patterns...', progress: 60},
                {id: 'step4', text: '✅ Fact-checking claims...', progress: 80},
                {id: 'step5', text: '📊 Generating final report...', progress: 100}
            ];

            let currentStep = 0;
            
            const progressInterval = setInterval(() => {
                if (currentStep < steps.length) {
                    const step = steps[currentStep];
                    
                    // Update progress bar
                    progressFill.style.width = step.progress + '%';
                    analysisStatus.textContent = step.text;
                    
                    // Update step status
                    document.getElementById(step.id).classList.add('active');
                    if (currentStep > 0) {
                        document.getElementById(steps[currentStep - 1].id).classList.remove('active');
                        document.getElementById(steps[currentStep - 1].id).classList.add('completed');
                    }
                    
                    currentStep++;
                } else {
                    clearInterval(progressInterval);
                    analysisStatus.textContent = '✅ Analysis complete!';
                    document.getElementById('step5').classList.remove('active');
                    document.getElementById('step5').classList.add('completed');
                }
            }, 1000);
        }

        // Display results
        function displayResults(results) {
            const resultsSection = document.getElementById('resultsSection');
            resultsSection.classList.add('visible');
            
            // Update credibility score
            const credibilityScore = results.scoring?.overall_credibility || 50;
            document.getElementById('credibilityScore').textContent = Math.round(credibilityScore);
            document.getElementById('credibilityGrade').textContent = `Grade: ${results.scoring?.credibility_grade || 'C'}`;
            
            // Update credibility circle
            updateCredibilityCircle(credibilityScore);
            
            // Update source chart
            updateSourceChart(results.source_verification);
            
            // Update source details
            updateSourceDetails(results.source_verification);
            
            // Generate AI summary
            generateAISummary(results);
            
            // Update details section
            updateDetailsSection(results);
            
            // Show pro features if available
            if (results.tier === 'pro') {
                unlockProFeatures(results);
            }
        }

        // Update credibility circle
        function updateCredibilityCircle(score) {
            const circle = document.getElementById('credibilityCircle');
            const percentage = score / 100;
            const degrees = percentage * 360;
            
            let color1 = '#e74c3c', color2 = '#c0392b'; // Red for low scores
            if (score >= 70) {
                color1 = '#27ae60'; color2 = '#2ecc71'; // Green for high scores
            } else if (score >= 50) {
                color1 = '#f39c12'; color2 = '#e67e22'; // Orange for medium scores
            }
            
            circle.style.background = `conic-gradient(${color1} 0deg, ${color2} ${degrees}deg, #ecf0f1 ${degrees}deg)`;
        }

        // Update source chart
        function updateSourceChart(sourceData) {
            const ctx = document.getElementById('sourceChart').getContext('2d');
            
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Credible', 'Unknown', 'Questionable'],
                    datasets: [{
                        data: [sourceData?.average_credibility || 70, 20, 10],
                        backgroundColor: ['#27ae60', '#f39c12', '#e74c3c'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        // Update source details
        function updateSourceDetails(sourceData) {
            const container = document.getElementById('sourceDetails');
            const sources = sourceData?.sources || [{name: 'Unknown Source', credibility: 60}];
            
            container.innerHTML = sources.map(source => 
                `<div style="margin-bottom: 0.5rem;">
                    <strong>${source.name}</strong>: ${source.credibility}/100
                    <div style="width: 100%; height: 4px; background: #ecf0f1; border-radius: 2px; margin-top: 2px;">
                        <div style="width: ${source.credibility}%; height: 100%; background: #667eea; border-radius: 2px;"></div>
                    </div>
                </div>`
            ).join('');
        }

        // Generate AI summary
        function generateAISummary(results) {
            const summaryContent = document.getElementById('summaryContent');
            const score = results.scoring?.overall_credibility || 50;
            
            let assessment = '';
            if (score >= 80) {
                assessment = 'This article demonstrates high credibility with reliable sourcing and minimal bias indicators.';
            } else if (score >= 60) {
                assessment = 'This article shows moderate credibility with some areas of concern that warrant further verification.';
            } else {
                assessment = 'This article raises credibility concerns and should be verified through additional sources.';
            }
            
            summaryContent.innerHTML = `
                <p><strong>Overall Assessment:</strong> ${assessment}</p>
                <p><strong>Key Findings:</strong> 
                Analysis of ${results.text_length} characters revealed credibility score of ${Math.round(score)}/100. 
                ${results.source_verification?.sources_found || 1} source(s) analyzed with average credibility of 
                ${Math.round(results.source_verification?.average_credibility || 60)}/100.</p>
                <p><strong>Recommendation:</strong> 
                ${score >= 70 ? 'This content appears reliable for general consumption.' : 
                  'Exercise caution and seek additional verification before sharing this content.'}</p>
            `;
        }

        // Update details section
        function updateDetailsSection(results) {
            const detailsSection = document.getElementById('detailsSection');
            
            detailsSection.innerHTML = `
                <div class="detail-card">
                    <div class="detail-title">📊 Analysis Metrics</div>
                    <div class="detail-content">
                        Content Length: ${results.text_length} characters<br>
                        Processing Time: ${results.methodology?.processing_time || '12 seconds'}<br>
                        Analysis Depth: ${results.methodology?.analysis_depth || 'standard'}
                    </div>
                </div>
                
                <div class="detail-card">
                    <div class="detail-title">🔍 Methodology</div>
                    <div class="detail-content">
                        AI Models: ${results.methodology?.ai_models_used || 'Pattern Matching'}<br>
                        Databases Searched: ${results.methodology?.plagiarism_databases || '50+ sources'}<br>
                        Fact-Check Sources: Google Fact-Check API, PolitiFact, Snopes
                    </div>
                </div>
                
                <div class="detail-card">
                    <div class="detail-title">📈 Quality Indicators</div>
                    <div class="detail-content">
                        Writing Quality: ${results.ai_analysis?.writing_quality || 70}/100<br>
                        Source Attribution: ${results.ai_analysis?.credibility_indicators?.length || 0} indicators found<br>
                        Red Flags: ${results.ai_analysis?.red_flags?.length || 0} concerns identified
                    </div>
                </div>
            `;
        }

        // Reset analysis
        function resetAnalysis() {
            analysisInProgress = false;
            currentAnalysis = null;
            
            // Reset progress
            resetProgress();
            
            // Hide results
            document.getElementById('resultsSection').classList.remove('visible');
            
            // Clear inputs
            document.getElementById('urlInput').value = '';
            document.getElementById('textInput').value = '';
        }

        // Reset progress
        function resetProgress() {
            const progressSection = document.getElementById('progressSection');
            const progressFill = document.getElementById('progressFill');
            const analysisStatus = document.getElementById('analysisStatus');
            
            progressSection.classList.remove('active');
            progressFill.style.width = '0%';
            analysisStatus.textContent = 'Ready to analyze';
            
            // Reset all steps
            document.querySelectorAll('.step').forEach(step => {
                step.classList.remove('active', 'completed');
            });
        }

        // Show upgrade modal
        function showUpgrade() {
            alert('🚀 Upgrade to Pro for advanced features!\n\n✅ Political bias analysis\n✅ Real-time fact checking\n✅ Advanced AI insights\n✅ Historical accuracy tracking\n\nVisit our pricing page to upgrade!');
        }

        // Unlock pro features (for demo)
        function unlockProFeatures(results) {
            // This would be called when user has pro subscription
            // For now, just show what pro features would look like
        }
    </script>
</body>
</html>
