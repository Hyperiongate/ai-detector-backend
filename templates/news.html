<!DOCTYPE html>
<html lang="en">  
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
    <title>NewsVerify Pro - News Verification Platform</title>
    
    <!-- Google Analytics 4 Integration -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-9CLSNV2S8Q"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-9CLSNV2S8Q');
        
        // Custom Analytics Events for News Verification Page
        function trackNewsEvent(eventName, eventData = {}) {
            gtag('event', eventName, {
                event_category: 'News_Verification',
                page_title: 'NewsVerify Pro - News Verification Platform',
                ...eventData
            });
            
            // Backend analytics tracking
            if (typeof backendAnalytics !== 'undefined') {
                backendAnalytics.track(eventName, {
                    page: 'news_verification',
                    timestamp: new Date().toISOString(),
                    ...eventData
                });
            }
        }
        
        // Track page view
        gtag('event', 'page_view', {
            page_title: 'NewsVerify Pro - News Verification Platform',
            page_location: window.location.href,
            content_group1: 'News Verification'
        });
    </script>
    
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üì∞</text></svg>">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/static/styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            line-height: 1.6;
            padding-top: 60px;
        }

        /* Beta Banner */
        .beta-banner {
            background: linear-gradient(45deg, #ff6b35, #f7931e);
            padding: 8px 0;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .beta-banner::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 3s infinite;
            transform: rotate(45deg);
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }

        .beta-content {
            position: relative;
            z-index: 2;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            color: white;
            font-weight: 600;
        }

        .beta-badge {
            background: rgba(255,255,255,0.2);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .beta-join-btn {
            background: rgba(255,255,255,0.2);
            border: 2px solid rgba(255,255,255,0.3);
            color: white;
            padding: 6px 16px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            text-decoration: none;
            font-size: 0.9rem;
        }

        .beta-join-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 10000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 5% auto;
            padding: 0;
            border-radius: 20px;
            width: 90%;
            max-width: 500px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .modal-header {
            background: rgba(255,255,255,0.1);
            padding: 2rem;
            text-align: center;
            border-bottom: 1px solid rgba(255,255,255,0.2);
        }

        .modal-header h2 {
            color: white;
            margin-bottom: 0.5rem;
            font-size: 1.8rem;
        }

        .modal-header p {
            color: rgba(255,255,255,0.8);
            font-size: 1rem;
        }

        .modal-body {
            padding: 2rem;
        }

        .modal-body .input-group {
            margin-bottom: 1rem;
        }

        .modal-body input {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.3);
            color: white;
            padding: 1rem;
            border-radius: 10px;
            width: 100%;
            font-size: 1rem;
        }

        .modal-body input::placeholder {
            color: rgba(255,255,255,0.6);
        }

        .modal-footer {
            padding: 1.5rem 2rem 2rem;
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
        }

        .btn-secondary {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 1px solid rgba(255,255,255,0.3);
            padding: 0.75rem 1.5rem;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-secondary:hover {
            background: rgba(255,255,255,0.3);
        }

        .close {
            position: absolute;
            right: 1rem;
            top: 1rem;
            color: rgba(255,255,255,0.8);
            font-size: 2rem;
            font-weight: bold;
            cursor: pointer;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .close:hover {
            background: rgba(255,255,255,0.2);
            color: white;
        }

        /* Container adjustments */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-bottom: 20px;
        }

        /* Navigation Bar */
        .nav-bar {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 15px;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .nav-links-secondary {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .nav-links-secondary a {
            color: white;
            text-decoration: none;
            padding: 10px 20px;
            border-radius: 12px;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .nav-links-secondary a:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .nav-links-secondary a.active {
            background: rgba(255, 255, 255, 0.3);
            font-weight: 600;
        }

        /* Tool Container */
        .tool-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .tool-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .tool-header h2 {
            font-size: 2.2rem;
            color: #4a5568;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .tool-header p {
            font-size: 1rem;
            color: #718096;
            margin-bottom: 15px;
        }

        /* Tools Section */
        .tools-employed {
            background: linear-gradient(145deg, #f8fafc, #ffffff);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            border: 2px solid rgba(102, 126, 234, 0.1);
            position: relative;
            overflow: hidden;
        }

        .tools-employed::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #10b981, #667eea, #764ba2);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.8; }
            50% { opacity: 1; }
        }

        .tools-title {
            font-weight: 700;
            color: #4a5568;
            margin-bottom: 20px;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .tools-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        .tool-item {
            background: rgba(102, 126, 234, 0.05);
            padding: 15px 20px;
            border-radius: 12px;
            border-left: 4px solid #667eea;
            font-size: 0.95rem;
            font-weight: 600;
            color: #4a5568;
            transition: all 0.3s ease;
        }

        .tool-item:hover {
            background: rgba(102, 126, 234, 0.1);
            transform: translateY(-2px);
        }

        .tool-item i {
            margin-right: 8px;
            color: #667eea;
        }

        /* Progress Section */
        .progress-section {
            margin-bottom: 30px;
            background: linear-gradient(145deg, #f8fafc, #ffffff);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            border: 2px solid rgba(102, 126, 234, 0.1);
            position: relative;
            overflow: hidden;
        }

        .progress-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #667eea, #10b981, #764ba2, #667eea);
            background-size: 300% 100%;
            animation: rainbow-flow 4s ease-in-out infinite;
        }

        @keyframes rainbow-flow {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .progress-title {
            font-weight: 700;
            color: #4a5568;
            margin-bottom: 25px;
            font-size: 1.3rem;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .progress-item {
            margin-bottom: 20px;
        }

        .progress-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
            font-size: 0.95rem;
            color: #6b7280;
            font-weight: 600;
        }

        .progress-bar {
            background: #e2e8f0;
            height: 14px;
            border-radius: 7px;
            overflow: hidden;
            position: relative;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2, #10b981);
            border-radius: 7px;
            width: 0%;
            transition: width 2s ease;
            position: relative;
            background-size: 200% 100%;
            animation: gradient-flow 3s ease-in-out infinite;
        }

        @keyframes gradient-flow {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            animation: shine 2s infinite;
        }

        @keyframes shine {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        /* Input Section */
        .input-section {
            margin-bottom: 30px;
        }

        .input-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid #e2e8f0;
        }

        .input-tab {
            padding: 12px 24px;
            border: none;
            background: #f8fafc;
            color: #6b7280;
            font-weight: 600;
            cursor: pointer;
            border-radius: 10px 10px 0 0;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .input-tab:hover {
            background: #f1f5f9;
            color: #374151;
        }

        .input-tab.active {
            background: white;
            color: #667eea;
            border-bottom: 2px solid #667eea;
            transform: translateY(2px);
        }

        .input-content {
            display: none;
        }

        .input-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 700;
            color: #4a5568;
            font-size: 1rem;
        }

        .input-group input, .input-group textarea {
            width: 100%;
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: white;
            font-family: inherit;
        }

        .input-group input:focus, .input-group textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .input-group textarea {
            min-height: 120px;
            resize: vertical;
            line-height: 1.5;
        }

        /* Button Styles */
        .button-group {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            flex: 1;
            justify-content: center;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .btn-test {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
        }

        .btn-test:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(16, 185, 129, 0.3);
        }

        /* Results Section */
        .results {
            display: none;
            margin-top: 30px;
            animation: fadeInUp 0.5s ease;
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Version Badge */
        .version-badge {
            position: absolute;
            top: -12px;
            right: 20px;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 700;
            color: white;
            z-index: 10;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .version-badge.free {
            background: linear-gradient(135deg, #6b7280, #4b5563);
        }

        .version-badge.pro {
            background: linear-gradient(135deg, #f59e0b, #d97706);
        }

        /* Result Cards */
        .result-card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 25px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            border: 2px solid rgba(102, 126, 234, 0.1);
            position: relative;
            overflow: hidden;
        }

        .result-card.main-assessment {
            border: 3px solid #667eea;
            background: linear-gradient(145deg, #ffffff, #f8fafc);
        }

        .result-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #10b981, #667eea, #764ba2);
        }

        .result-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
            color: #4a5568;
            font-weight: 700;
            font-size: 1.3rem;
        }

        .result-header i {
            color: #667eea;
            font-size: 1.4rem;
        }

        /* Dropdown Styles */
        .dropdown-section {
            margin-bottom: 15px;
            border: 2px solid rgba(102, 126, 234, 0.1);
            border-radius: 12px;
            overflow: hidden;
            background: white;
        }

        .dropdown-header {
            background: rgba(102, 126, 234, 0.05);
            padding: 18px 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-weight: 600;
            color: #4a5568;
            transition: all 0.3s ease;
            font-size: 1.1rem;
        }

        .dropdown-header:hover {
            background: rgba(102, 126, 234, 0.1);
        }

        .dropdown-header.locked {
            background: rgba(156, 163, 175, 0.1);
            color: #9ca3af;
            cursor: not-allowed;
            position: relative;
        }

        .dropdown-header.locked:hover {
            background: rgba(156, 163, 175, 0.15);
        }

        .dropdown-header.locked::after {
            content: 'üîí PRO ONLY';
            position: absolute;
            right: 60px;
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 700;
        }

        .dropdown-icon {
            transition: transform 0.3s ease;
            font-size: 1.2rem;
        }

        .dropdown-header.open .dropdown-icon {
            transform: rotate(180deg);
        }

        .dropdown-content {
            display: none;
            padding: 25px;
            background: white;
            border-top: 1px solid rgba(102, 126, 234, 0.1);
        }

        .dropdown-content.open {
            display: block;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Compact Summary */
        .compact-summary {
            display: flex;
            align-items: center;
            gap: 30px;
            margin-bottom: 25px;
            padding: 25px;
            background: linear-gradient(145deg, #f8fafc, #ffffff);
            border-radius: 15px;
            border: 2px solid rgba(102, 126, 234, 0.1);
        }

        .score-circle {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.6rem;
            font-weight: 900;
            position: relative;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            flex-shrink: 0;
        }

        .score-circle::before {
            content: '';
            position: absolute;
            width: 70px;
            height: 70px;
            background: white;
            border-radius: 50%;
            z-index: 1;
        }

        .score-text {
            position: relative;
            z-index: 2;
        }

        .summary-content {
            flex: 1;
        }

        .summary-content h3 {
            margin-bottom: 12px;
            font-size: 1.4rem;
        }

        .summary-dialogue {
            color: #6b7280;
            line-height: 1.6;
            font-size: 1.05rem;
        }

        /* Locked Content */
        .locked-content {
            background: linear-gradient(145deg, rgba(156, 163, 175, 0.05), rgba(156, 163, 175, 0.1));
            border: 2px dashed #d1d5db;
            border-radius: 12px;
            padding: 40px;
            text-align: center;
            color: #6b7280;
            margin: 20px 0;
            position: relative;
        }

        .locked-content .lock-icon {
            font-size: 3rem;
            color: #9ca3af;
            margin-bottom: 20px;
        }

        .locked-content h3 {
            color: #4b5563;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }

        .locked-content p {
            font-size: 1.05rem;
            line-height: 1.6;
        }

        .upgrade-prompt {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 25px 35px;
            border-radius: 15px;
            text-align: center;
            margin-top: 25px;
        }

        .upgrade-prompt h3 {
            margin-bottom: 20px;
            font-size: 1.4rem;
        }

        .upgrade-prompt .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
            font-size: 0.95rem;
        }

        .upgrade-prompt button {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 15px 30px;
            border-radius: 10px;
            cursor: pointer;
            margin-top: 20px;
            font-weight: 600;
            font-size: 1.1rem;
            transition: all 0.3s ease;
        }

        .upgrade-prompt button:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        /* Download Report Button */
        .download-report {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            margin: 15px 0;
            transition: all 0.3s ease;
        }

        .download-report:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(16, 185, 129, 0.3);
        }

        /* Data Grid */
        .data-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .data-item {
            background: #f8fafc;
            padding: 18px;
            border-radius: 12px;
            text-align: center;
            border: 2px solid rgba(102, 126, 234, 0.1);
            transition: all 0.3s ease;
        }

        .data-item:hover {
            background: #f1f5f9;
            transform: translateY(-2px);
        }

        .data-value {
            font-size: 1.6rem;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 8px;
        }

        .data-label {
            font-size: 0.9rem;
            color: #6b7280;
            font-weight: 600;
        }

        /* Feature Teaser */
        .feature-teaser {
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), rgba(217, 119, 6, 0.1));
            border: 2px solid rgba(245, 158, 11, 0.3);
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
            text-align: center;
        }

        .feature-teaser h4 {
            color: #d97706;
            margin-bottom: 10px;
            font-size: 1.2rem;
        }

        .feature-teaser p {
            color: #92400e;
            margin-bottom: 15px;
        }

        .feature-teaser .preview-items {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 10px;
            margin: 15px 0;
            font-size: 0.9rem;
            color: #b45309;
        }

        /* Bias Spectrum */
        .bias-spectrum {
            background: linear-gradient(90deg, #ef4444 0%, #f59e0b 25%, #10b981 50%, #f59e0b 75%, #ef4444 100%);
            height: 40px;
            border-radius: 20px;
            position: relative;
            margin: 25px 0;
        }

        .bias-indicator {
            position: absolute;
            top: 50%;
            transform: translate(-50%, -50%);
            width: 24px;
            height: 24px;
            background: white;
            border: 4px solid #374151;
            border-radius: 50%;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            z-index: 2;
        }

        .bias-labels {
            position: absolute;
            top: -25px;
            left: 0;
            right: 0;
            display: flex;
            justify-content: space-between;
            font-size: 0.8rem;
            color: #6b7280;
            font-weight: 600;
        }

        /* Cross-Verification Specific Styles */
        .cross-verification-container {
            margin-top: 30px;
            background: linear-gradient(145deg, #f8fafc, #ffffff);
            border-radius: 20px;
            padding: 30px;
            border: 3px solid #667eea;
            box-shadow: 0 15px 35px rgba(102, 126, 234, 0.2);
            position: relative;
            overflow: hidden;
        }

        .cross-verification-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: linear-gradient(90deg, #667eea, #10b981, #f59e0b, #ef4444);
            background-size: 400% 100%;
            animation: rainbow-flow 4s ease-in-out infinite;
        }

        .cv-header {
            text-align: center;
            margin-bottom: 30px;
            position: relative;
        }

        .cv-header h2 {
            color: #667eea;
            font-size: 1.8rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .cv-header .beta-badge {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 700;
            animation: pulse 2s infinite;
        }

        .cv-input-section {
            margin-bottom: 25px;
        }

        .cv-input-group {
            display: flex;
            gap: 15px;
            align-items: flex-end;
            flex-wrap: wrap;
        }

        .cv-input-group input {
            flex: 1;
            min-width: 300px;
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .cv-input-group input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .cv-button-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .cv-btn {
            padding: 15px 25px;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.95rem;
        }

        .cv-btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .cv-btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .cv-btn-secondary {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            box-shadow: 0 5px 15px rgba(16, 185, 129, 0.3);
        }

        .cv-btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.4);
        }

        /* Cross-Verification Progress */
        .cv-progress-section {
            display: none;
            margin: 25px 0;
            background: rgba(102, 126, 234, 0.05);
            border-radius: 15px;
            padding: 25px;
            border: 2px solid rgba(102, 126, 234, 0.1);
        }

        .cv-progress-title {
            text-align: center;
            color: #667eea;
            font-weight: 700;
            font-size: 1.2rem;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .cv-progress-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .cv-progress-item {
            background: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .cv-progress-item .status-icon {
            font-size: 1.5rem;
            margin-bottom: 8px;
            transition: all 0.3s ease;
        }

        .cv-progress-item.loading .status-icon {
            color: #f59e0b;
            animation: spin 1s linear infinite;
        }

        .cv-progress-item.completed .status-icon {
            color: #10b981;
        }

        .cv-progress-item.error .status-icon {
            color: #ef4444;
        }

        /* Source Comparison Grid */
        .source-comparison-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }

        .source-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            border: 2px solid #e2e8f0;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .source-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(0, 0, 0, 0.15);
        }

        .source-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--credibility-color, #667eea);
        }

        .source-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
        }

        .source-name {
            font-weight: 700;
            color: #374151;
            font-size: 1.1rem;
        }

        .credibility-badge {
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 700;
            color: white;
        }

        .credibility-high { background: #10b981; }
        .credibility-medium { background: #f59e0b; }
        .credibility-low { background: #ef4444; }

        .source-metrics {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin: 15px 0;
        }

        .metric-item {
            text-align: center;
            padding: 8px;
            background: #f8fafc;
            border-radius: 8px;
        }

        .metric-value {
            font-size: 1.2rem;
            font-weight: 700;
            color: #667eea;
        }

        .metric-label {
            font-size: 0.8rem;
            color: #6b7280;
            font-weight: 600;
        }

        .source-claims {
            margin-top: 15px;
        }

        .source-claims h4 {
            color: #374151;
            font-size: 0.95rem;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .claim-item {
            background: rgba(102, 126, 234, 0.05);
            padding: 8px 12px;
            border-radius: 8px;
            margin-bottom: 8px;
            font-size: 0.9rem;
            border-left: 3px solid #667eea;
        }

        /* Consensus Analysis */
        .consensus-analysis {
            background: linear-gradient(145deg, #ffffff, #f8fafc);
            border-radius: 15px;
            padding: 25px;
            margin: 25px 0;
            border: 2px solid rgba(102, 126, 234, 0.2);
            text-align: center;
        }

        .consensus-score {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 30px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .consensus-circle {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            font-weight: 900;
            color: white;
            position: relative;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .consensus-details {
            flex: 1;
            min-width: 300px;
            text-align: left;
        }

        .consensus-details h3 {
            color: #374151;
            font-size: 1.4rem;
            margin-bottom: 15px;
        }

        .consensus-metrics {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .consensus-metric {
            background: rgba(102, 126, 234, 0.05);
            padding: 12px 15px;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }

        .consensus-metric-value {
            font-size: 1.3rem;
            font-weight: 700;
            color: #667eea;
        }

        .consensus-metric-label {
            font-size: 0.9rem;
            color: #6b7280;
            font-weight: 600;
        }

        /* Cross-Verification Actions */
        .cv-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 25px;
            flex-wrap: wrap;
        }

        .cv-action-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .cv-action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        .cv-action-btn.secondary {
            background: linear-gradient(135deg, #10b981, #059669);
        }

        .cv-action-btn.tertiary {
            background: linear-gradient(135deg, #f59e0b, #d97706);
        }

        /* Pro feature teaser for free users */
        .cv-pro-teaser {
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), rgba(217, 119, 6, 0.1));
            border: 2px solid rgba(245, 158, 11, 0.3);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            margin: 25px 0;
        }

        .cv-pro-teaser h3 {
            color: #d97706;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }

        .cv-pro-teaser p {
            color: #92400e;
            margin-bottom: 20px;
            font-size: 1.05rem;
        }

        .cv-pro-features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
            font-size: 0.95rem;
            color: #b45309;
            font-weight: 600;
        }

        .cv-upgrade-btn {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.1rem;
        }

        .cv-upgrade-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(245, 158, 11, 0.3);
        }

        /* Loading animations */
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            body {
                padding-top: 60px;
            }
            
            .container {
                padding: 15px;
            }
            
            .tool-container {
                padding: 25px;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            .nav-links-secondary {
                flex-direction: column;
                gap: 10px;
            }
            
            .tools-grid {
                grid-template-columns: 1fr;
            }
            
            .compact-summary {
                flex-direction: column;
                text-align: center;
            }
            
            .data-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .score-circle {
                width: 80px;
                height: 80px;
                font-size: 1.3rem;
            }

            .upgrade-prompt .features-grid {
                grid-template-columns: 1fr;
            }

            .beta-content {
                flex-direction: column;
                gap: 8px;
            }

            .modal-content {
                margin: 10% auto;
                width: 95%;
            }

            .modal-footer {
                flex-direction: column;
            }

            .cv-input-group {
                flex-direction: column;
            }
            
            .cv-input-group input {
                min-width: 100%;
            }
            
            .cv-button-group {
                justify-content: center;
            }
            
            .source-comparison-grid {
                grid-template-columns: 1fr;
            }
            
            .consensus-score {
                flex-direction: column;
                gap: 20px;
            }
            
            .consensus-circle {
                width: 100px;
                height: 100px;
                font-size: 1.5rem;
            }
            
            .consensus-metrics {
                grid-template-columns: 1fr;
            }
            
            .cv-actions {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
</head>
<body>
    {% include 'header.html' %}

    <!-- Beta Banner -->
    <div class="beta-banner">
        <div class="beta-content">
            <span class="beta-badge">BETA</span>
            <span>üöÄ The world's ONLY platform built specifically for news verification - Join our beta!</span>
            <button class="beta-join-btn" onclick="openBetaModal()">Join Beta</button>
        </div>
    </div>

    <div class="container">
        <div class="header">
            <h1><i class="fas fa-shield-alt"></i> NewsVerify Pro</h1>
            <p>The World's First AI Platform Built Specifically for News Verification & Media Analysis</p>
        </div>

        <nav class="nav-bar">
            <div class="nav-links-secondary">
                <a href="/"><i class="fas fa-home"></i> Home</a>
                <a href="/news" class="active"><i class="fas fa-newspaper"></i> News Verification</a>
                <a href="/unified"><i class="fas fa-search"></i> Content Authenticity</a>
                <a href="/imageanalysis"><i class="fas fa-image"></i> AI Image Analysis</a>
                <a href="/missionstatement"><i class="fas fa-bullseye"></i> Our Mission</a>
                <a href="/pricingplan"><i class="fas fa-tags"></i> Pricing</a>
            </div>
        </nav>

        <div class="tool-container">
            <div class="tool-header">
                <h2><i class="fas fa-newspaper"></i> Professional News Verification Engine</h2>
                <p>Advanced political bias detection, source credibility scoring, and cross-reference verification</p>
            </div>

            <!-- Enhanced Tools Employed Section -->
            <div class="tools-employed">
                <div class="tools-title">
                    <i class="fas fa-cogs"></i>
                    News Industry Analysis Tools & Methodologies
                </div>
                <div class="tools-grid">
                    <div class="tool-item">
                        <i class="fas fa-balance-scale"></i> Real-Time Political Bias Detection
                    </div>
                    <div class="tool-item">
                        <i class="fas fa-database"></i> 500+ News Source Credibility Database
                    </div>
                    <div class="tool-item">
                        <i class="fas fa-search"></i> Cross-Source Verification Network
                    </div>
                    <div class="tool-item">
                        <i class="fas fa-shield-alt"></i> Misinformation Pattern Recognition
                    </div>
                    <div class="tool-item">
                        <i class="fas fa-network-wired"></i> Multi-Outlet Story Comparison
                    </div>
                    <div class="tool-item">
                        <i class="fas fa-chart-line"></i> Journalism Quality Scoring
                    </div>
                    <div class="tool-item">
                        <i class="fas fa-clock"></i> Timeline & Event Verification
                    </div>
                    <div class="tool-item">
                        <i class="fas fa-fingerprint"></i> Editorial vs News Classification
                    </div>
                    <div class="tool-item">
                        <i class="fas fa-brain"></i> Advanced AI Content Analysis
                    </div>
                    <div class="tool-item">
                        <i class="fas fa-globe"></i> Real-Time Breaking News Verification
                    </div>
                </div>
            </div>

            <!-- Authentication Message Area -->
            <div id="authMessageArea"></div>

            <!-- Usage Counter -->
            <div id="usageCounter"></div>

            <!-- Enhanced Progress Bars -->
            <div class="progress-section" id="progressSection" style="display: none;">
                <div class="progress-title">
                    <i class="fas fa-cogs fa-spin"></i>
                    News Verification in Progress...
                </div>
                
                <div class="progress-item">
                    <div class="progress-label">
                        <span><i class="fas fa-file-text"></i> Content Analysis & Source Detection</span>
                        <span id="progress1Status">Pending...</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress1"></div>
                    </div>
                </div>
                
                <div class="progress-item">
                    <div class="progress-label">
                        <span><i class="fas fa-balance-scale"></i> Political Bias Assessment</span>
                        <span id="progress2Status">Pending...</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress2"></div>
                    </div>
                </div>
                
                <div class="progress-item">
                    <div class="progress-label">
                        <span><i class="fas fa-database"></i> Source Credibility Verification</span>
                        <span id="progress3Status">Pending...</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress3"></div>
                    </div>
                </div>
                
                <div class="progress-item">
                    <div class="progress-label">
                        <span><i class="fas fa-search"></i> Cross-Source Fact-Check</span>
                        <span id="progress4Status">Pending...</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress4"></div>
                    </div>
                </div>
                
                <div class="progress-item">
                    <div class="progress-label">
                        <span><i class="fas fa-file-alt"></i> Professional Report Generation</span>
                        <span id="progress5Status">Pending...</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress5"></div>
                    </div>
                </div>
            </div>

            <div class="input-section">
                <div class="input-tabs">
                    <button class="input-tab active" onclick="switchInputType('text')">üìù News Text Analysis</button>
                    <button class="input-tab" onclick="switchInputType('url')">üîó URL Verification</button>
                </div>
                
                <div class="input-content active" id="textInput">
                    <div class="input-group">
                        <label for="news-text"><i class="fas fa-file-text"></i> News Article or Social Media Content</label>
                        <textarea id="news-text" placeholder="Paste news article, social media post, or any news content for comprehensive verification and bias analysis..."></textarea>
                    </div>
                </div>
                
                <div class="input-content" id="urlInput">
                    <div class="input-group">
                        <label for="news-url"><i class="fas fa-link"></i> News Article URL</label>
                        <input type="url" id="news-url" placeholder="https://example.com/news-article-for-verification">
                    </div>
                </div>
            </div>

            <div class="button-group">
                <button class="btn btn-primary" onclick="runAnalysis('free')">
                    <i class="fas fa-play"></i> Start Free Analysis
                </button>
                <button class="btn btn-primary" onclick="runAnalysis('pro')" style="background: linear-gradient(135deg, #f59e0b, #d97706);">
                    <i class="fas fa-crown"></i> Start Pro Analysis
                </button>
                <button class="btn btn-secondary" onclick="showCrossVerificationDashboard()" style="background: linear-gradient(135deg, #10b981, #059669);">
                    <i class="fas fa-network-wired"></i> Cross-Verify Sources
                </button>
                <button class="btn btn-test" onclick="loadTestData()">
                    <i class="fas fa-flask"></i> Load Sample News
                </button>
                <button class="btn btn-secondary" onclick="resetForm()">
                    <i class="fas fa-redo"></i> Reset
                </button>
            </div>

            <div class="results" id="results">
                <!-- Results will be populated here -->
            </div>
        </div>

        <!-- Cross-Verification Dashboard -->
        <div class="cross-verification-container" id="crossVerificationContainer" style="display: none;">
            <div class="cv-header">
                <h2>
                    <i class="fas fa-network-wired"></i>
                    Real-Time Source Cross-Verification
                    <span class="beta-badge">WORLD'S FIRST</span>
                </h2>
                <p style="color: #6b7280; font-size: 1rem; margin-top: 5px;">
                    Compare how multiple news sources report the same story - powered by our exclusive multi-source verification engine
                </p>
            </div>

            <div class="cv-input-section">
                <div class="cv-input-group">
                    <div style="flex: 1;">
                        <label for="cv-topic" style="display: block; margin-bottom: 8px; font-weight: 700; color: #4a5568;">
                            <i class="fas fa-search"></i> News Topic or Event
                        </label>
                        <input type="text" id="cv-topic" placeholder="Enter a news topic (e.g., 'Infrastructure Bill', 'Climate Summit', 'Election Results')">
                    </div>
                    <div class="cv-button-group">
                        <button class="cv-btn cv-btn-primary" onclick="runCrossVerification('free')">
                            <i class="fas fa-play"></i> Start Free Cross-Check
                        </button>
                        <button class="cv-btn cv-btn-secondary" onclick="runCrossVerification('pro')">
                            <i class="fas fa-crown"></i> Pro Multi-Source Analysis
                        </button>
                    </div>
                </div>
            </div>

            <!-- Progress Section -->
            <div class="cv-progress-section" id="cvProgressSection">
                <div class="cv-progress-title">
                    <i class="fas fa-cogs fa-spin"></i>
                    Cross-Verifying Sources in Real-Time...
                </div>
                <div class="cv-progress-grid">
                    <div class="cv-progress-item" id="cvProgress1">
                        <div class="status-icon"><i class="fas fa-search"></i></div>
                        <div>Finding Sources</div>
                    </div>
                    <div class="cv-progress-item" id="cvProgress2">
                        <div class="status-icon"><i class="fas fa-file-text"></i></div>
                        <div>Extracting Content</div>
                    </div>
                    <div class="cv-progress-item" id="cvProgress3">
                        <div class="status-icon"><i class="fas fa-balance-scale"></i></div>
                        <div>Analyzing Claims</div>
                    </div>
                    <div class="cv-progress-item" id="cvProgress4">
                        <div class="status-icon"><i class="fas fa-chart-line"></i></div>
                        <div>Calculating Consensus</div>
                    </div>
                    <div class="cv-progress-item" id="cvProgress5">
                        <div class="status-icon"><i class="fas fa-check-circle"></i></div>
                        <div>Generating Report</div>
                    </div>
                </div>
            </div>

            <!-- Results Section -->
            <div id="cvResults" style="display: none;">
                <!-- Dynamic content will be inserted here -->
            </div>
        </div>
    </div>

    <!-- Beta Modal -->
    <div id="betaModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeBetaModal()">&times;</span>
            <div class="modal-header">
                <h2>üöÄ Join Our Beta Program</h2>
                <p>Get exclusive early access to the world's first news verification platform and help shape the future of media analysis!</p>
            </div>
            <div class="modal-body">
                <form id="betaSignupForm">
                    <div class="input-group">
                        <input type="email" id="betaEmail" placeholder="Enter your email address" required>
                    </div>
                    <div class="input-group">
                        <input type="text" id="betaName" placeholder="Your name (optional)">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-secondary" onclick="closeBetaModal()">Cancel</button>
                <button type="button" class="btn" onclick="submitBetaSignup()">Join Beta Program</button>
            </div>
        </div>
    </div>

    <script src="/static/auth-analysis.js"></script>
    <script>
        // Initialize analytics tracking
        document.addEventListener('DOMContentLoaded', function() {
            trackNewsEvent('news_verification_page_loaded', {
                user_agent: navigator.userAgent,
                screen_resolution: screen.width + 'x' + screen.height,
                referrer: document.referrer,
                unique_feature: 'first_news_verification_platform'
            });
            
            setupNewsAnalytics();
        });

        // Setup comprehensive news verification analytics
        function setupNewsAnalytics() {
            // Track navigation clicks
            document.querySelectorAll('.nav-links a, .nav-links-secondary a').forEach(link => {
                link.addEventListener('click', function() {
                    const destination = this.getAttribute('href');
                    trackNewsEvent('navigation_clicked', {
                        destination: destination,
                        link_text: this.textContent.trim()
                    });
                });
            });

            // Track tool interactions
            document.querySelectorAll('.tool-item').forEach(card => {
                card.addEventListener('mouseenter', function() {
                    const toolTitle = this.textContent.trim();
                    trackNewsEvent('news_tool_hovered', {
                        tool: toolTitle
                    });
                });
            });

            // Track form interactions
            document.querySelectorAll('input, textarea').forEach(field => {
                field.addEventListener('focus', function() {
                    const fieldType = this.type || 'textarea';
                    const fieldId = this.id;
                    trackNewsEvent('form_field_focused', {
                        field_type: fieldType,
                        field_id: fieldId
                    });
                });

                field.addEventListener('input', function() {
                    const fieldId = this.id;
                    const hasContent = this.value.length > 0;
                    trackNewsEvent('form_field_input', {
                        field_id: fieldId,
                        has_content: hasContent,
                        content_length: this.value.length
                    });
                });
            });

            // Track engagement metrics
            let pageStartTime = Date.now();
            let engagementEvents = 0;

            ['click', 'scroll', 'mousemove', 'keydown'].forEach(eventType => {
                document.addEventListener(eventType, function() {
                    engagementEvents++;
                });
            });

            window.addEventListener('beforeunload', function() {
                const timeOnPage = Math.round((Date.now() - pageStartTime) / 1000);
                trackNewsEvent('page_session_end', {
                    time_on_page: timeOnPage,
                    engagement_events: engagementEvents
                });
            });
        }

        // Beta Modal Functions
        function openBetaModal() {
            trackNewsEvent('beta_modal_opened', {
                source: 'news_verification_banner',
                unique_value_prop: 'first_news_verification_platform'
            });
            document.getElementById('betaModal').style.display = 'block';
        }

        function closeBetaModal() {
            trackNewsEvent('beta_modal_closed');
            document.getElementById('betaModal').style.display = 'none';
        }

        function submitBetaSignup() {
            const email = document.getElementById('betaEmail').value;
            const name = document.getElementById('betaName').value;

            if (!email) {
                alert('Please enter your email address');
                return;
            }

            trackNewsEvent('beta_signup_attempted', {
                email: email,
                has_name: name.length > 0,
                source: 'news_verification'
            });

            // Submit to backend
            fetch('/api/beta-signup', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ email: email, name: name })
            })
            .then(response => response.json())
            .then(data => {
                trackNewsEvent('beta_signup_completed', {
                    email: email,
                    source: 'news_verification'
                });
                alert('üéâ Welcome to the beta! Check your email for access details.');
                closeBetaModal();
                document.getElementById('betaSignupForm').reset();
            })
            .catch(error => {
                console.log('Demo mode: Beta signup for', email);
                trackNewsEvent('beta_signup_completed', {
                    email: email,
                    source: 'news_verification',
                    demo_mode: true
                });
                alert('üéâ Thanks for your interest! Beta signup recorded.');
                closeBetaModal();
                document.getElementById('betaSignupForm').reset();
            });
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('betaModal');
            if (event.target === modal) {
                closeBetaModal();
            }
        };

        let currentInputType = 'text';
        let currentAnalysisData = null;
        let currentTier = 'free';

        function switchInputType(type) {
            currentInputType = type;
            
            document.querySelectorAll('.input-tab').forEach((tab, index) => {
                tab.classList.remove('active');
                if ((type === 'text' && index === 0) || (type === 'url' && index === 1)) {
                    tab.classList.add('active');
                }
            });
            
            document.querySelectorAll('.input-content').forEach(content => {
                content.classList.remove('active');
            });
            
            const targetContent = document.getElementById(type + 'Input');
            if (targetContent) {
                targetContent.classList.add('active');
            }

            trackNewsEvent('input_type_switched', {
                type: type
            });
        }

        function loadTestData() {
            const testContent = "Breaking: Infrastructure Bill Passes Senate with Bipartisan Support. The Department of Transportation announced today the allocation of $2.3 billion for highway improvements across 15 states, according to officials who state this initiative will create approximately 45,000 jobs over the next 18 months. The announcement comes following congressional support for the infrastructure bill passed last quarter. Sources close to the administration suggest this represents the largest single infrastructure investment in recent history. Industry experts predict significant economic impact in rural communities, though some critics question the timeline for implementation.";
            
            document.getElementById('news-text').value = testContent;
            switchInputType('text');
            
            showNotification('Sample news content loaded successfully!', 'success');
            trackNewsEvent('test_data_loaded', {
                content_type: 'news_sample'
            });
        }

        // Cross-Verification Functions
        let currentCrossVerification = null;
        let cvProgressInterval = null;

        function showCrossVerificationDashboard() {
            const container = document.getElementById('crossVerificationContainer');
            container.style.display = 'block';
            container.scrollIntoView({ behavior: 'smooth' });
            
            // Track event
            if (typeof trackNewsEvent === 'function') {
                trackNewsEvent('cross_verification_dashboard_opened', {
                    unique_feature: 'worlds_first_multi_source_verification'
                });
            }
        }

        async function runCrossVerification(tier) {
            tier = tier || 'free';
            
            // Check authentication for pro features
            if (tier === 'pro' && window.authAnalysis && !window.authAnalysis.checkAuth()) {
                window.authAnalysis.showAuthMessage();
                return;
            }
            
            const topic = document.getElementById('cv-topic').value.trim();
            
            if (!topic) {
                showNotification('Please enter a news topic to cross-verify.', 'error');
                return;
            }
            
            if (topic.length < 3) {
                showNotification('Please enter at least 3 characters for the news topic.', 'error');
                return;
            }
            
            // Track analysis start
            if (typeof trackNewsEvent === 'function') {
                trackNewsEvent('cross_verification_started', {
                    tier: tier,
                    topic: topic,
                    unique_platform: 'multi_source_verification'
                });
            }
            
            // Show progress
            const progressSection = document.getElementById('cvProgressSection');
            progressSection.style.display = 'block';
            
            // Reset progress
            resetCrossVerificationProgress();
            
            // Start progress animation
            startCrossVerificationProgress();
            
            try {
                // For now, simulate the cross-verification API call
                // This will work with a real backend once implemented
                const response = await simulateCrossVerification(topic, tier);
                
                // Stop progress animation
                clearInterval(cvProgressInterval);
                completeCrossVerificationProgress();
                
                // Store results
                currentCrossVerification = response;
                
                // Hide progress and show results
                setTimeout(() => {
                    progressSection.style.display = 'none';
                    showCrossVerificationResults(response, tier);
                    
                    // Update usage if authenticated
                    if (window.authAnalysis && typeof window.authAnalysis.updateUsage === 'function') {
                        window.authAnalysis.updateUsage();
                    }
                }, 1500);
                
                // Track completion
                if (typeof trackNewsEvent === 'function') {
                    trackNewsEvent('cross_verification_completed', {
                        tier: tier,
                        topic: topic,
                        total_sources: response.source_analysis?.total_sources || 0,
                        consensus_score: response.source_analysis?.consensus_analysis?.consensus_score || 0,
                        processing_time: response.processing_time || 0
                    });
                }
                
            } catch (error) {
                console.error('Cross-verification error:', error);
                clearInterval(cvProgressInterval);
                progressSection.style.display = 'none';
                
                showNotification('Cross-verification failed: ' + error.message + '. Please try again.', 'error');
                
                // Track failure
                if (typeof trackNewsEvent === 'function') {
                    trackNewsEvent('cross_verification_failed', {
                        tier: tier,
                        topic: topic,
                        error: error.message
                    });
                }
                
                resetCrossVerificationProgress();
            }
        }

        // Simulate cross-verification for demo purposes
        async function simulateCrossVerification(topic, tier) {
            await new Promise(resolve => setTimeout(resolve, 3000)); // Simulate processing time
            
            const mockSources = [
                {
                    source_domain: 'reuters.com',
                    source_name: 'Reuters',
                    credibility_score: 95,
                    political_bias: 'center',
                    article_title: `${topic}: Latest developments from Reuters`,
                    article_url: `https://reuters.com/article/${topic.replace(/\s+/g, '-')}`,
                    claims_extracted: [
                        { claim_text: `${topic} represents a significant development in current affairs.` },
                        { claim_text: 'Multiple stakeholders are closely monitoring the situation.' }
                    ]
                },
                {
                    source_domain: 'cnn.com',
                    source_name: 'CNN',
                    credibility_score: 75,
                    political_bias: 'left',
                    article_title: `Breaking: ${topic} analysis and implications`,
                    article_url: `https://cnn.com/politics/${topic.replace(/\s+/g, '-')}`,
                    claims_extracted: [
                        { claim_text: `${topic} could have far-reaching consequences.` },
                        { claim_text: 'Expert analysis suggests this is a critical moment.' }
                    ]
                },
                {
                    source_domain: 'foxnews.com',
                    source_name: 'Fox News',
                    credibility_score: 65,
                    political_bias: 'right',
                    article_title: `${topic}: What you need to know`,
                    article_url: `https://foxnews.com/politics/${topic.replace(/\s+/g, '-')}`,
                    claims_extracted: [
                        { claim_text: `${topic} raises important questions about policy direction.` },
                        { claim_text: 'Conservative viewpoints emphasize different aspects of this issue.' }
                    ]
                },
                {
                    source_domain: 'bbc.com',
                    source_name: 'BBC News',
                    credibility_score: 88,
                    political_bias: 'center-left',
                    article_title: `${topic}: International perspective`,
                    article_url: `https://bbc.com/news/${topic.replace(/\s+/g, '-')}`,
                    claims_extracted: [
                        { claim_text: `${topic} has international implications worth considering.` },
                        { claim_text: 'Global observers are tracking developments closely.' }
                    ]
                }
            ];

            // Limit sources based on tier
            const sources = tier === 'pro' ? mockSources : mockSources.slice(0, 2);
            const avgCredibility = sources.reduce((sum, s) => sum + s.credibility_score, 0) / sources.length;
            const consensusScore = Math.min(90, avgCredibility + (sources.length * 5));

            return {
                success: true,
                query_topic: topic,
                processing_time: 3.2,
                source_analysis: {
                    total_sources: sources.length,
                    sources: sources,
                    consensus_analysis: {
                        consensus_score: consensusScore,
                        controversy_level: consensusScore >= 75 ? 'low' : 'moderate',
                        avg_source_credibility: avgCredibility
                    }
                },
                final_report: {
                    executive_summary: {
                        assessment: consensusScore >= 75 ? 'HIGH SOURCE CONSENSUS' : 'MODERATE AGREEMENT',
                        consensus_score: consensusScore,
                        total_sources_analyzed: sources.length,
                        avg_source_credibility: avgCredibility,
                        controversy_level: consensusScore >= 75 ? 'low' : 'moderate'
                    }
                }
            };
        }

        function resetCrossVerificationProgress() {
            for (let i = 1; i <= 5; i++) {
                const item = document.getElementById(`cvProgress${i}`);
                item.className = 'cv-progress-item';
            }
        }

        function startCrossVerificationProgress() {
            let currentStep = 1;
            
            function updateStep() {
                if (currentStep <= 5) {
                    const item = document.getElementById(`cvProgress${currentStep}`);
                    item.className = 'cv-progress-item loading';
                    
                    setTimeout(() => {
                        if (item.className.includes('loading')) {
                            item.className = 'cv-progress-item completed';
                        }
                    }, 1500);
                    
                    currentStep++;
                }
            }
            
            updateStep(); // Start first step
            cvProgressInterval = setInterval(updateStep, 2000);
        }

        function completeCrossVerificationProgress() {
            for (let i = 1; i <= 5; i++) {
                const item = document.getElementById(`cvProgress${i}`);
                item.className = 'cv-progress-item completed';
            }
        }

        function showCrossVerificationResults(results, tier) {
            const resultsDiv = document.getElementById('cvResults');
            
            if (!results.success) {
                resultsDiv.innerHTML = `
                    <div class="cv-error">
                        <h3>Cross-Verification Failed</h3>
                        <p>${results.error || 'Unable to complete cross-verification'}</p>
                    </div>
                `;
                resultsDiv.style.display = 'block';
                return;
            }
            
            const sourceAnalysis = results.source_analysis || {};
            const sources = sourceAnalysis.sources || [];
            const consensusAnalysis = sourceAnalysis.consensus_analysis || {};
            const finalReport = results.final_report || {};
            const executiveSummary = finalReport.executive_summary || {};
            
            // Build results HTML
            let html = '';
            
            // Executive Summary
            html += createExecutiveSummary(executiveSummary, results.query_topic);
            
            // Source Comparison Grid
            if (sources.length > 0) {
                html += createSourceComparisonGrid(sources, tier);
            }
            
            // Consensus Analysis
            html += createConsensusAnalysis(consensusAnalysis);
            
            // Pro teaser for free users
            if (tier === 'free') {
                html += createCrossVerificationProTeaser();
            }
            
            // Action buttons
            html += createCrossVerificationActions(tier);
            
            resultsDiv.innerHTML = html;
            resultsDiv.style.display = 'block';
            resultsDiv.scrollIntoView({ behavior: 'smooth' });
        }

        function createExecutiveSummary(executiveSummary, queryTopic) {
            const consensusScore = executiveSummary.consensus_score || 50;
            const assessment = executiveSummary.assessment || 'ANALYSIS COMPLETED';
            const totalSources = executiveSummary.total_sources_analyzed || 0;
            const avgCredibility = executiveSummary.avg_source_credibility || 50;
            const controversyLevel = executiveSummary.controversy_level || 'unknown';
            
            // Determine consensus circle color
            let consensusColor = '#f59e0b'; // default yellow
            if (consensusScore >= 75) consensusColor = '#10b981'; // green
            else if (consensusScore < 50) consensusColor = '#ef4444'; // red
            
            return `
                <div class="consensus-analysis">
                    <h3 style="color: #374151; margin-bottom: 20px; text-align: center;">
                        <i class="fas fa-chart-pie"></i> Cross-Verification Results for "${queryTopic}"
                    </h3>
                    
                    <div class="consensus-score">
                        <div class="consensus-circle" style="background: conic-gradient(from 0deg, ${consensusColor} 0deg ${consensusScore * 3.6}deg, #e5e7eb ${consensusScore * 3.6}deg 360deg);">
                            ${consensusScore}
                        </div>
                        
                        <div class="consensus-details">
                            <h3>${assessment}</h3>
                            <div class="consensus-metrics">
                                <div class="consensus-metric">
                                    <div class="consensus-metric-value">${totalSources}</div>
                                    <div class="consensus-metric-label">Sources Analyzed</div>
                                </div>
                                <div class="consensus-metric">
                                    <div class="consensus-metric-value">${Math.round(avgCredibility)}/100</div>
                                    <div class="consensus-metric-label">Avg Source Quality</div>
                                </div>
                                <div class="consensus-metric">
                                    <div class="consensus-metric-value">${controversyLevel.toUpperCase()}</div>
                                    <div class="consensus-metric-label">Controversy Level</div>
                                </div>
                                <div class="consensus-metric">
                                    <div class="consensus-metric-value">${consensusScore}/100</div>
                                    <div class="consensus-metric-label">Consensus Score</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function createSourceComparisonGrid(sources, tier) {
            const maxSources = tier === 'pro' ? sources.length : Math.min(sources.length, 4);
            const displaySources = sources.slice(0, maxSources);
            
            let html = `
                <div class="source-comparison-section">
                    <h3 style="color: #374151; margin-bottom: 20px; text-align: center;">
                        <i class="fas fa-newspaper"></i> Source-by-Source Comparison (${displaySources.length} outlets)
                    </h3>
                    <div class="source-comparison-grid">
            `;
            
            displaySources.forEach(source => {
                const credibilityScore = source.credibility_score || 50;
                const credibilityLevel = credibilityScore >= 80 ? 'high' : credibilityScore >= 60 ? 'medium' : 'low';
                const credibilityColor = credibilityScore >= 80 ? '#10b981' : credibilityScore >= 60 ? '#f59e0b' : '#ef4444';
                
                const claims = source.claims_extracted || [];
                const displayClaims = claims.slice(0, 2);
                
                html += `
                    <div class="source-card" style="--credibility-color: ${credibilityColor}">
                        <div class="source-header">
                            <div class="source-name">${source.source_name || 'Unknown Source'}</div>
                            <div class="credibility-badge credibility-${credibilityLevel}">
                                ${credibilityScore}/100
                            </div>
                        </div>
                        
                        <div class="source-metrics">
                            <div class="metric-item">
                                <div class="metric-value">${credibilityScore}</div>
                                <div class="metric-label">Credibility</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-value">${source.political_bias || 'N/A'}</div>
                                <div class="metric-label">Bias</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-value">${claims.length}</div>
                                <div class="metric-label">Claims</div>
                            </div>
                        </div>
                        
                        <div class="source-title" style="font-size: 0.9rem; color: #6b7280; margin: 10px 0; line-height: 1.4;">
                            <strong>Article:</strong> ${source.article_title || 'No title available'}
                        </div>
                        
                        ${displayClaims.length > 0 ? `
                            <div class="source-claims">
                                <h4>Key Claims:</h4>
                                ${displayClaims.map(claim => `
                                    <div class="claim-item">${claim.claim_text || claim}</div>
                                `).join('')}
                                ${claims.length > 2 ? `<div style="text-align: center; color: #6b7280; font-size: 0.8rem; margin-top: 8px;">+${claims.length - 2} more claims</div>` : ''}
                            </div>
                        ` : ''}
                        
                        ${source.article_url ? `
                            <a href="${source.article_url}" target="_blank" style="display: inline-block; margin-top: 10px; color: #667eea; font-size: 0.8rem; text-decoration: none;">
                                <i class="fas fa-external-link-alt"></i> Read Full Article
                            </a>
                        ` : ''}
                    </div>
                `;
            });
            
            html += `
                    </div>
                </div>
            `;
            
            return html;
        }

        function createConsensusAnalysis(consensusAnalysis) {
            const consensusScore = consensusAnalysis.consensus_score || 50;
            const avgCredibility = consensusAnalysis.avg_source_credibility || 50;
            const controversyLevel = consensusAnalysis.controversy_level || 'unknown';
            
            let consensusDescription = '';
            if (consensusScore >= 75) {
                consensusDescription = 'Strong agreement across multiple credible sources. High confidence in reported information.';
            } else if (consensusScore >= 50) {
                consensusDescription = 'Moderate agreement with some discrepancies. Cross-reference with additional sources recommended.';
            } else {
                consensusDescription = 'Significant disagreement between sources. Exercise caution and seek additional verification.';
            }
            
            return `
                <div class="consensus-analysis" style="margin-top: 0;">
                    <h3 style="color: #374151; margin-bottom: 15px; text-align: left;">
                        <i class="fas fa-handshake"></i> Source Consensus Analysis
                    </h3>
                    <p style="color: #6b7280; margin-bottom: 20px; line-height: 1.6;">${consensusDescription}</p>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;">
                        <div style="text-align: center; background: rgba(102, 126, 234, 0.05); padding: 15px; border-radius: 10px;">
                            <div style="font-size: 1.5rem; font-weight: 700; color: #667eea;">${consensusScore}/100</div>
                            <div style="font-size: 0.9rem; color: #6b7280;">Consensus Score</div>
                        </div>
                        <div style="text-align: center; background: rgba(16, 185, 129, 0.05); padding: 15px; border-radius: 10px;">
                            <div style="font-size: 1.5rem; font-weight: 700; color: #10b981;">${Math.round(avgCredibility)}/100</div>
                            <div style="font-size: 0.9rem; color: #6b7280;">Avg Credibility</div>
                        </div>
                        <div style="text-align: center; background: rgba(239, 68, 68, 0.05); padding: 15px; border-radius: 10px;">
                            <div style="font-size: 1.2rem; font-weight: 700; color: #ef4444;">${controversyLevel.toUpperCase()}</div>
                            <div style="font-size: 0.9rem; color: #6b7280;">Controversy</div>
                        </div>
                    </div>
                </div>
            `;
        }

        function createCrossVerificationProTeaser() {
            return `
                <div class="cv-pro-teaser">
                    <h3><i class="fas fa-crown"></i> Unlock Advanced Cross-Verification with Pro</h3>
                    <p>Get detailed claim-by-claim analysis, source relationship mapping, and timeline tracking across all major news outlets.</p>
                    
                    <div class="cv-pro-features">
                        <div>‚Ä¢ Claim-by-claim cross-verification</div>
                        <div>‚Ä¢ Source relationship mapping</div>
                        <div>‚Ä¢ Timeline story development</div>
                        <div>‚Ä¢ Controversy detection algorithms</div>
                        <div>‚Ä¢ 15+ source comparison</div>
                        <div>‚Ä¢ Advanced consensus scoring</div>
                    </div>
                    
                    <button class="cv-upgrade-btn" onclick="upgradeToPro()">
                        <i class="fas fa-rocket"></i> Upgrade to Pro Cross-Verification
                    </button>
                </div>
            `;
        }

        function createCrossVerificationActions(tier) {
            return `
                <div class="cv-actions">
                    <button class="cv-action-btn" onclick="downloadCrossVerificationReport()">
                        <i class="fas fa-download"></i> Download Cross-Verification Report
                    </button>
                    <button class="cv-action-btn secondary" onclick="shareCrossVerification()">
                        <i class="fas fa-share"></i> Share Analysis
                    </button>
                    <button class="cv-action-btn tertiary" onclick="runNewCrossVerification()">
                        <i class="fas fa-redo"></i> Analyze Different Topic
                    </button>
                </div>
            `;
        }

        function downloadCrossVerificationReport() {
            if (!currentCrossVerification) {
                showNotification('No cross-verification data available for download.', 'error');
                return;
            }
            
            // Track download
            if (typeof trackNewsEvent === 'function') {
                trackNewsEvent('cross_verification_report_downloaded', {
                    topic: currentCrossVerification.query_topic,
                    sources: currentCrossVerification.source_analysis?.total_sources || 0
                });
            }
            
            try {
                const reportData = generateCrossVerificationReport(currentCrossVerification);
                
                const blob = new Blob([reportData], { type: 'text/plain;charset=utf-8' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `CrossVerification_${currentCrossVerification.query_topic.replace(/\s+/g, '_')}_${new Date().toISOString().split('T')[0]}.txt`;
                a.style.display = 'none';
                
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                
                setTimeout(() => URL.revokeObjectURL(url), 1000);
                
                showNotification('Cross-verification report downloaded successfully!', 'success');
                
            } catch (error) {
                console.error('Download failed:', error);
                showNotification('Download failed. Please try again.', 'error');
            }
        }

        function generateCrossVerificationReport(data) {
            const sourceAnalysis = data.source_analysis || {};
            const executiveSummary = data.final_report?.executive_summary || {};
            const sources = sourceAnalysis.sources || [];
            const consensusAnalysis = sourceAnalysis.consensus_analysis || {};
            
            return `====================================================
REAL-TIME SOURCE CROSS-VERIFICATION REPORT
====================================================
Generated: ${new Date().toLocaleString()}
Query Topic: "${data.query_topic}"
Analysis ID: cross_verify_${Date.now()}
Platform: World's First Multi-Source News Verification System
Processing Time: ${data.processing_time || 0} seconds

EXECUTIVE SUMMARY
================
Final Assessment: ${executiveSummary.assessment || 'ANALYSIS COMPLETED'}
Consensus Score: ${executiveSummary.consensus_score || 0}/100
Total Sources Analyzed: ${executiveSummary.total_sources_analyzed || 0}
Average Source Credibility: ${executiveSummary.avg_source_credibility || 0}/100
Controversy Level: ${executiveSummary.controversy_level || 'unknown'}

MULTI-SOURCE ANALYSIS
====================

Source Breakdown:
${sources.map((source, index) => `
${index + 1}. ${source.source_name || 'Unknown Source'}
   Domain: ${source.source_domain || 'Unknown'}
   Credibility Score: ${source.credibility_score || 0}/100
   Political Bias: ${source.political_bias || 'Unknown'}
   Article: ${source.article_title || 'No title'}
   Claims Extracted: ${(source.claims_extracted || []).length}
   URL: ${source.article_url || 'Not available'}
`).join('')}

CONSENSUS ANALYSIS
=================
Overall Consensus Score: ${consensusAnalysis.consensus_score || 0}/100
Average Source Credibility: ${consensusAnalysis.avg_source_credibility || 0}/100
Controversy Level: ${consensusAnalysis.controversy_level || 'unknown'}

${consensusAnalysis.consensus_score >= 75 ? 
'HIGH CONSENSUS: Multiple credible sources are in strong agreement about this topic.' :
consensusAnalysis.consensus_score >= 50 ?
'MODERATE CONSENSUS: Sources show general agreement with some discrepancies.' :
'LOW CONSENSUS: Significant disagreement between sources detected.'}

METHODOLOGY
===========
Platform: NewsVerify Pro Cross-Verification Engine
Analysis Type: Real-time multi-source comparison
Sources Searched: ${sources.length} major news outlets
Verification Methods: 
- Multi-source content aggregation
- Claim extraction and matching
- Source credibility weighting
- Consensus scoring algorithm

COMPETITIVE ADVANTAGE
====================
‚Ä¢ World's ONLY platform with real-time cross-source verification
‚Ä¢ Simultaneous analysis of multiple news outlets
‚Ä¢ Advanced consensus scoring algorithms
‚Ä¢ Source relationship mapping
‚Ä¢ Timeline-based story development tracking
‚Ä¢ Credibility-weighted analysis

====================================================
This report was generated by Facts & Fakes AI
The World's First Real-Time Source Cross-Verification Platform
Professional Multi-Source News Analysis & Verification
¬© 2024 - Revolutionary News Intelligence Technology
====================================================`;
        }

        function shareCrossVerification() {
            if (!currentCrossVerification) {
                showNotification('No cross-verification data available to share.', 'error');
                return;
            }
            
            const shareData = {
                title: `Cross-Verification: ${currentCrossVerification.query_topic}`,
                text: `I just cross-verified "${currentCrossVerification.query_topic}" across ${currentCrossVerification.source_analysis?.total_sources || 0} news sources with a ${currentCrossVerification.final_report?.executive_summary?.consensus_score || 0}/100 consensus score.`,
                url: window.location.href
            };
            
            if (navigator.share) {
                navigator.share(shareData);
            } else {
                // Fallback to clipboard
                navigator.clipboard.writeText(`${shareData.text} ${shareData.url}`).then(() => {
                    showNotification('Cross-verification results copied to clipboard!', 'success');
                });
            }
            
            // Track sharing
            if (typeof trackNewsEvent === 'function') {
                trackNewsEvent('cross_verification_shared', {
                    topic: currentCrossVerification.query_topic,
                    method: navigator.share ? 'native_share' : 'clipboard'
                });
            }
        }

        function runNewCrossVerification() {
            document.getElementById('cv-topic').value = '';
            document.getElementById('cvResults').style.display = 'none';
            document.getElementById('cvProgressSection').style.display = 'none';
            currentCrossVerification = null;
            
            document.getElementById('cv-topic').focus();
            
            showNotification('Ready for new cross-verification analysis.', 'success');
            
            // Track reset
            if (typeof trackNewsEvent === 'function') {
                trackNewsEvent('cross_verification_reset');
            }
        }

        // Continue with existing news analysis functions...
        async function runAnalysis(tier) {
            tier = tier || 'free';
            currentTier = tier;
            
            // Check authentication for pro features
            if (tier === 'pro' && window.authAnalysis && !window.authAnalysis.checkAuth()) {
                window.authAnalysis.showAuthMessage();
                return;
            }
            
            trackNewsEvent('news_analysis_started', {
                tier: tier,
                input_type: currentInputType,
                unique_platform: 'news_verification_specialist'
            });
            
            // Validate input
            const textInput = document.getElementById('news-text').value.trim();
            const urlInput = document.getElementById('news-url').value.trim();
            
            if (currentInputType === 'text') {
                if (!textInput) {
                    showNotification('Please enter news content to analyze.', 'error');
                    return;
                }
                if (textInput.length < 50) {
                    showNotification('Please enter at least 50 characters for comprehensive news analysis.', 'error');
                    return;
                }
            }
            
            if (currentInputType === 'url') {
                if (!urlInput) {
                    showNotification('Please enter a news URL to analyze.', 'error');
                    return;
                }
                try {
                    new URL(urlInput);
                } catch (e) {
                    showNotification('Please enter a valid news URL (e.g., https://example.com/article).', 'error');
                    return;
                }
            }
            
            // Show progress section
            const progressSection = document.getElementById('progressSection');
            progressSection.style.display = 'block';
            
            // Reset progress bars
            resetProgressBars();
            
            // Start progress animation
            const progressSteps = [
                { id: 'progress1', status: 'progress1Status', label: 'Analyzing content & detecting sources...' },
                { id: 'progress2', status: 'progress2Status', label: 'Assessing political bias...' },
                { id: 'progress3', status: 'progress3Status', label: 'Verifying source credibility...' },
                { id: 'progress4', status: 'progress4Status', label: 'Cross-referencing fact-checks...' },
                { id: 'progress5', status: 'progress5Status', label: 'Generating verification report...' }
            ];
            
            // Start progress updates
            let currentStep = 0;
            function updateProgress() {
                if (currentStep < progressSteps.length) {
                    const step = progressSteps[currentStep];
                    document.getElementById(step.status).textContent = step.label;
                    document.getElementById(step.id).style.width = '100%';
                    currentStep++;
                }
            }
            
            updateProgress(); // Start first step
            
            try {
                // Prepare data for API call
                const requestData = {};
                if (currentInputType === 'text') {
                    requestData.content = textInput;
                } else {
                    requestData.url = urlInput;
                }
                
                // Add analysis type
                requestData.is_pro = tier === 'pro';
                
                // Simulate API call for demo
                const progressInterval = setInterval(updateProgress, 800);
                
                // Simulate processing time
                await new Promise(resolve => setTimeout(resolve, 4000));
                
                clearInterval(progressInterval);
                
                // Generate mock results
                const results = generateMockNewsResults(requestData.content || 'Sample content', tier);
                
                // Store for download functionality
                currentAnalysisData = results;
                
                // Complete remaining progress bars
                while (currentStep < progressSteps.length) {
                    updateProgress();
                    await new Promise(resolve => setTimeout(resolve, 200));
                }
                
                // Update final status
                progressSteps.forEach((step, index) => {
                    document.getElementById(step.status).textContent = 'Completed ‚úì';
                });
                
                // Hide progress and show results
                setTimeout(() => {
                    progressSection.style.display = 'none';
                    showNewsResults(results, tier);
                    
                    // Update usage if authenticated
                    if (window.authAnalysis && typeof window.authAnalysis.updateUsage === 'function') {
                        window.authAnalysis.updateUsage();
                    }
                }, 1000);

                trackNewsEvent('news_analysis_completed', {
                    tier: tier,
                    credibility_score: results.credibility_score || 0,
                    political_bias: results.political_bias && results.political_bias.bias_label || 'unknown',
                    source_credibility: results.source_verification && results.source_verification.domain_info && results.source_verification.domain_info.credibility_score || 0
                });
                
            } catch (error) {
                console.error('Analysis error:', error);
                progressSection.style.display = 'none';
                showNotification('Analysis failed: ' + error.message + '. Please try again.', 'error');
                
                trackNewsEvent('news_analysis_failed', {
                    tier: tier,
                    error: error.message
                });
                
                resetProgressBars();
            }
        }

        function generateMockNewsResults(content, tier) {
            const credibilityScore = Math.floor(Math.random() * 40) + 60; // 60-100
            const biasScore = Math.floor(Math.random() * 40) - 20; // -20 to +20
            const objectivity = Math.floor(Math.random() * 30) + 70; // 70-100
            
            return {
                credibility_score: credibilityScore,
                political_bias: {
                    bias_score: biasScore,
                    bias_label: biasScore < -10 ? 'left' : biasScore > 10 ? 'right' : 'center',
                    objectivity_score: objectivity,
                    bias_confidence: 85
                },
                source_verification: {
                    domain_info: {
                        credibility_score: credibilityScore - 10,
                        political_bias: biasScore < -5 ? 'center-left' : biasScore > 5 ? 'center-right' : 'center',
                        source_type: 'news_outlet',
                        domain: 'example.com'
                    }
                },
                executive_summary: {
                    main_assessment: credibilityScore >= 80 ? 'HIGH CREDIBILITY' : credibilityScore >= 60 ? 'MODERATE CREDIBILITY' : 'QUESTIONABLE CONTENT'
                }
            };
        }

        function resetProgressBars() {
            document.querySelectorAll('.progress-fill').forEach(bar => {
                bar.style.width = '0%';
            });
            
            ['progress1Status', 'progress2Status', 'progress3Status', 'progress4Status', 'progress5Status'].forEach(id => {
                document.getElementById(id).textContent = 'Pending...';
            });
        }

        function showNewsResults(results, tier) {
            const resultsDiv = document.getElementById('results');
            
            // Extract data with proper fallbacks
            const credibilityScore = Math.round(results.credibility_score || 65);
            const assessment = results.executive_summary && results.executive_summary.main_assessment || 'ANALYSIS COMPLETED';
            
            // Political bias data
            const biasData = results.political_bias || {};
            const biasScore = biasData.bias_score || 0;
            const biasLabel = biasData.bias_label || 'center';
            const objectivity = biasData.objectivity_score || 75;
            
            // Source verification data
            const sourceData = results.source_verification && results.source_verification.domain_info || {};
            const sourceCredibility = sourceData.credibility_score || 50;
            const sourceBias = sourceData.political_bias || 'unknown';
            const sourceType = sourceData.source_type || 'unknown';
            const sourceDomain = sourceData.domain || 'Unknown Source';
            
            // Generate colors based on credibility
            function getCredibilityColor(score) {
                if (score >= 80) return { primary: '#10b981', secondary: '#059669', text: 'Highly Credible' };
                if (score >= 60) return { primary: '#f59e0b', secondary: '#d97706', text: 'Moderately Credible' };
                return { primary: '#ef4444', secondary: '#dc2626', text: 'Low Credibility' };
            }
            
            const credibilityColors = getCredibilityColor(credibilityScore);
            const biasPosition = Math.max(5, Math.min(95, 50 + (biasScore / 2)));
            
            // Create the main results container
            resultsDiv.innerHTML = '';
            
            // Create version badge
            const versionBadge = document.createElement('div');
            versionBadge.className = 'version-badge ' + tier;
            versionBadge.innerHTML = '<i class="fas fa-' + (tier === 'pro' ? 'crown' : 'shield-alt') + '"></i>' + tier.toUpperCase() + ' NEWS VERIFICATION';
            resultsDiv.appendChild(versionBadge);

            // Create main assessment card
            const mainCard = document.createElement('div');
            mainCard.className = 'result-card main-assessment';
            
            // Card header
            const cardHeader = document.createElement('div');
            cardHeader.className = 'result-header';
            cardHeader.innerHTML = '<i class="fas fa-newspaper"></i>News Verification Assessment<span style="background: ' + credibilityColors.primary + '; color: white; padding: 6px 14px; border-radius: 12px; font-size: 0.85rem; margin-left: auto;">' + assessment + '</span>';
            mainCard.appendChild(cardHeader);
            
            // Compact summary
            const summary = document.createElement('div');
            summary.className = 'compact-summary';
            summary.innerHTML = '<div class="score-circle" style="background: conic-gradient(from 0deg, ' + credibilityColors.primary + ' 0deg ' + (credibilityScore * 3.6) + 'deg, #e5e7eb ' + (credibilityScore * 3.6) + 'deg 360deg);"><div class="score-text" style="color: ' + credibilityColors.secondary + ';">' + credibilityScore + '</div></div><div class="summary-content"><h3 style="color: #374151; margin-bottom: 8px; font-size: 1.4rem;">' + credibilityColors.text + ' - Overall Score: ' + credibilityScore + '/100</h3><div class="summary-dialogue">' + generateNewsDialogue(credibilityScore, biasLabel, sourceCredibility) + '</div></div>';
            mainCard.appendChild(summary);
            
            // Data grid
            const dataGrid = document.createElement('div');
            dataGrid.className = 'data-grid';
            dataGrid.innerHTML = '<div class="data-item"><div class="data-value">' + credibilityScore + '/100</div><div class="data-label">Overall Credibility</div></div><div class="data-item"><div class="data-value">' + sourceCredibility + '/100</div><div class="data-label">Source Quality</div></div><div class="data-item"><div class="data-value">' + objectivity + '%</div><div class="data-label">Objectivity</div></div><div class="data-item"><div class="data-value">' + biasLabel.toUpperCase() + '</div><div class="data-label">Political Lean</div></div>';
            mainCard.appendChild(dataGrid);
            
            resultsDiv.appendChild(mainCard);
            
            resultsDiv.style.display = 'block';
            resultsDiv.scrollIntoView({ behavior: 'smooth' });
        }

        function generateNewsDialogue(credibilityScore, biasLabel, sourceCredibility) {
            if (credibilityScore >= 80) {
                return 'This news content demonstrates strong credibility with professional journalism standards. The source shows ' + (sourceCredibility >= 80 ? 'high' : 'moderate') + ' reliability and maintains ' + (biasLabel === 'center' ? 'excellent neutrality' : 'acceptable political perspective') + '. Content appears trustworthy for sharing and citation.';
            } else if (credibilityScore >= 60) {
                return 'This content shows moderate credibility with some areas requiring verification. The source exhibits ' + (sourceCredibility >= 70 ? 'good' : 'mixed') + ' reliability patterns. ' + (biasLabel !== 'center' ? 'Shows ' + biasLabel + ' political lean' : 'Maintains political neutrality') + '. Recommend cross-referencing with additional sources before sharing.';
            } else {
                return 'This content exhibits significant credibility concerns requiring careful scrutiny. Source reliability is ' + (sourceCredibility >= 60 ? 'questionable' : 'low') + ' and ' + (biasLabel !== 'center' ? 'shows strong ' + biasLabel + ' bias' : 'political neutrality unclear') + '. Exercise extreme caution and seek verification from trusted news sources before considering reliable.';
            }
        }

        function upgradeToPro() {
            trackNewsEvent('news_upgrade_clicked', {
                source: 'results_page',
                unique_value_prop: 'news_verification_specialist'
            });
            
            showNotification('üöÄ Redirecting to Pro upgrade for news professionals...', 'info');
            setTimeout(function() {
                window.location.href = '/pricingplan';
            }, 1500);
        }

        function resetForm() {
            document.getElementById('news-text').value = '';
            document.getElementById('news-url').value = '';
            document.getElementById('results').style.display = 'none';
            document.getElementById('progressSection').style.display = 'none';
            document.getElementById('crossVerificationContainer').style.display = 'none';
            document.getElementById('cvResults').style.display = 'none';
            currentAnalysisData = null;
            currentCrossVerification = null;
            currentTier = 'free';
            
            resetProgressBars();
            resetCrossVerificationProgress();
            switchInputType('text');
            
            showNotification('News verification form reset successfully.', 'success');
            trackNewsEvent('news_form_reset');
        }

        function showNotification(message, type) {
            const notification = document.createElement('div');
            const colors = {
                success: '#10b981',
                error: '#ef4444', 
                info: '#3b82f6',
                warning: '#f59e0b'
            };
            
            notification.style.cssText = 
                'position: fixed;' + 
                'top: 20px;' + 
                'right: 20px;' + 
                'background: ' + (colors[type] || colors.info) + ';' + 
                'color: white;' + 
                'padding: 15px 20px;' + 
                'border-radius: 8px;' + 
                'z-index: 1000;' + 
                'font-weight: 600;' +
                'box-shadow: 0 4px 15px rgba(0,0,0,0.2);' +
                'animation: slideIn 0.3s ease;' +
                'max-width: 400px;';
            
            const icons = {
                success: 'fas fa-check-circle',
                error: 'fas fa-exclamation-triangle',
                info: 'fas fa-info-circle',
                warning: 'fas fa-exclamation-circle'
            };
            
            notification.innerHTML = '<i class="' + (icons[type] || icons.info) + '"></i> ' + message;
            document.body.appendChild(notification);
            
            setTimeout(function() {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(function() { 
                    if (notification.parentNode) {
                        notification.remove(); 
                    }
                }, 300);
            }, type === 'error' ? 5000 : 3000);
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            // Add animations
            const style = document.createElement('style');
            style.textContent = 
                '@keyframes slideIn {' +
                    'from { transform: translateX(100%); opacity: 0; }' +
                    'to { transform: translateX(0); opacity: 1; }' +
                '}' +
                '@keyframes slideOut {' +
                    'from { transform: translateX(0); opacity: 1; }' +
                    'to { transform: translateX(100%); opacity: 0; }' +
                '}';
            document.head.appendChild(style);
            
            // Initialize authentication
            if (window.authAnalysis && typeof window.authAnalysis.init === 'function') {
                window.authAnalysis.init();
            }
        });
    </script>
</body>
</html>
