<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NewsVerify Pro - News Verification Platform</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>📰</text></svg>">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Simplified Header */
        .header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-bottom: 20px;
        }

        /* Enhanced Navigation */
        .nav-bar {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 15px;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .nav-links {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .nav-links a {
            color: white;
            text-decoration: none;
            padding: 10px 20px;
            border-radius: 12px;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .nav-links a:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .nav-links a.active {
            background: rgba(255, 255, 255, 0.3);
            font-weight: 600;
        }

        /* Tool Container */
        .tool-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .tool-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .tool-header h2 {
            font-size: 2.2rem;
            color: #4a5568;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .tool-header p {
            font-size: 1rem;
            color: #718096;
            margin-bottom: 15px;
        }

        .tools-employed {
            background: linear-gradient(145deg, #f8fafc, #ffffff);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            border: 2px solid rgba(102, 126, 234, 0.1);
        }

        .tools-title {
            font-weight: 700;
            color: #4a5568;
            margin-bottom: 15px;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .tools-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .tool-item {
            background: rgba(102, 126, 234, 0.05);
            padding: 12px 16px;
            border-radius: 10px;
            border-left: 4px solid #667eea;
            font-size: 0.9rem;
            font-weight: 600;
            color: #4a5568;
        }

        /* Fancy Progress Bars */
        .progress-section {
            margin-bottom: 30px;
            background: linear-gradient(145deg, #f8fafc, #ffffff);
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border: 2px solid rgba(102, 126, 234, 0.1);
            position: relative;
            overflow: hidden;
        }

        .progress-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #667eea, #10b981, #764ba2, #667eea);
            background-size: 300% 100%;
            animation: rainbow-flow 4s ease-in-out infinite;
        }

        @keyframes rainbow-flow {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .progress-title {
            font-weight: 700;
            color: #4a5568;
            margin-bottom: 20px;
            font-size: 1.2rem;
            text-align: center;
        }

        .progress-bar {
            background: #e2e8f0;
            height: 12px;
            border-radius: 6px;
            overflow: hidden;
            margin-bottom: 15px;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2, #10b981);
            border-radius: 6px;
            width: 0%;
            transition: width 2s ease;
            position: relative;
            background-size: 200% 100%;
            animation: gradient-flow 3s ease-in-out infinite;
        }

        @keyframes gradient-flow {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shine 2s infinite;
        }

        @keyframes shine {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .progress-label {
            font-size: 0.9rem;
            color: #6b7280;
            font-weight: 600;
        }

        /* Input Section */
        .input-section {
            margin-bottom: 30px;
        }

        .input-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid #e2e8f0;
        }

        .input-tab {
            padding: 12px 24px;
            border: none;
            background: #f8fafc;
            color: #6b7280;
            font-weight: 600;
            cursor: pointer;
            border-radius: 10px 10px 0 0;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .input-tab:hover {
            background: #f1f5f9;
            color: #374151;
        }

        .input-tab.active {
            background: white;
            color: #667eea;
            border-bottom: 2px solid #667eea;
            transform: translateY(2px);
        }

        .input-content {
            display: none;
        }

        .input-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 700;
            color: #4a5568;
            font-size: 1rem;
        }

        .input-group input, .input-group textarea {
            width: 100%;
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: white;
            font-family: inherit;
        }

        .input-group input:focus, .input-group textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .input-group textarea {
            min-height: 120px;
            resize: vertical;
            line-height: 1.5;
        }

        /* Button Styles */
        .button-group {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            flex: 1;
            justify-content: center;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #f8fafc;
            color: #4a5568;
            border: 2px solid #e2e8f0;
        }

        .btn-secondary:hover {
            background: #f1f5f9;
            border-color: #667eea;
            color: #667eea;
        }

        .btn-test {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
        }

        .btn-test:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(16, 185, 129, 0.3);
        }

        .btn-pro-test {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
        }

        .btn-pro-test:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(245, 158, 11, 0.3);
        }

        /* Results Section */
        .results {
            display: none;
            margin-top: 30px;
            animation: fadeInUp 0.5s ease;
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .result-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border: 2px solid rgba(102, 126, 234, 0.1);
        }

        .result-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            color: #4a5568;
            font-weight: 700;
            font-size: 1.2rem;
        }

        .credibility-score {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 20px;
        }

        .score-circle {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: conic-gradient(from 0deg, #10b981 0deg 288deg, #e5e7eb 288deg 360deg);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: 900;
            color: #059669;
            position: relative;
        }

        .score-circle::before {
            content: '';
            position: absolute;
            width: 60px;
            height: 60px;
            background: white;
            border-radius: 50%;
            z-index: 1;
        }

        .score-text {
            position: relative;
            z-index: 2;
        }

        .locked-content {
            background: rgba(0, 0, 0, 0.05);
            border: 2px dashed #ccc;
            border-radius: 12px;
            padding: 30px;
            text-align: center;
            color: #6b7280;
            margin: 20px 0;
        }

        .locked-content .lock-icon {
            font-size: 2rem;
            color: #9ca3af;
            margin-bottom: 10px;
        }

        .upgrade-prompt {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            text-align: center;
            margin-top: 15px;
        }

        .upgrade-prompt button {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            margin-top: 10px;
            font-weight: 600;
        }

        .upgrade-prompt button:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .tool-container {
                padding: 25px;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            .nav-links {
                flex-direction: column;
                gap: 10px;
            }
            
            .tools-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-shield-alt"></i> NewsVerify Pro</h1>
            <p>AI-Powered News Verification Platform</p>
        </div>

        <nav class="nav-bar">
            <div class="nav-links">
                <a href="/"><i class="fas fa-home"></i> Home</a>
                <a href="/news" class="active"><i class="fas fa-newspaper"></i> News Verification</a>
                <a href="/unified"><i class="fas fa-search"></i> Content Authenticity</a>
                <a href="/imageanalysis"><i class="fas fa-image"></i> AI Image Analysis</a>
                <a href="/missionstatement"><i class="fas fa-bullseye"></i> Our Mission</a>
                <a href="/pricingplan"><i class="fas fa-tags"></i> Pricing</a>
            </div>
        </nav>

        <div class="tool-container">
            <div class="tool-header">
                <h2><i class="fas fa-newspaper"></i> News Verification Engine</h2>
                <p>Comprehensive analysis using multiple AI tools and databases</p>
            </div>

            <!-- Tools Employed Section -->
            <div class="tools-employed">
                <div class="tools-title">
                    <i class="fas fa-cogs"></i>
                    Analysis Tools Employed
                </div>
                <div class="tools-grid">
                    <div class="tool-item"><i class="fas fa-brain"></i> GPT-4 Analysis</div>
                    <div class="tool-item"><i class="fas fa-database"></i> Source Verification API</div>
                    <div class="tool-item"><i class="fas fa-search"></i> Fact-Check Database</div>
                    <div class="tool-item"><i class="fas fa-balance-scale"></i> Bias Detection AI</div>
                    <div class="tool-item"><i class="fas fa-network-wired"></i> Cross-Reference Network</div>
                    <div class="tool-item"><i class="fas fa-chart-line"></i> Sentiment Analysis</div>
                    <div class="tool-item"><i class="fas fa-clock"></i> Timeline Verification</div>
                    <div class="tool-item"><i class="fas fa-shield-alt"></i> Misinformation Detection</div>
                </div>
            </div>

            <!-- Progress Bars -->
            <div class="progress-section" id="progressSection" style="display: none;">
                <div class="progress-title">Analysis in Progress...</div>
                
                <div class="progress-label">Content Extraction & Parsing</div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progress1"></div>
                </div>
                
                <div class="progress-label">AI Credibility Analysis</div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progress2"></div>
                </div>
                
                <div class="progress-label">Source Verification</div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progress3"></div>
                </div>
                
                <div class="progress-label">Cross-Reference Check</div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progress4"></div>
                </div>
                
                <div class="progress-label">Final Report Generation</div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progress5"></div>
                </div>
            </div>

            <div class="input-section">
                <div class="input-tabs">
                    <button class="input-tab active" onclick="switchInputType('text')">📝 Text Analysis</button>
                    <button class="input-tab" onclick="switchInputType('url')">🔗 URL Verification</button>
                </div>
                
                <div class="input-content active" id="textInput">
                    <div class="input-group">
                        <label for="news-text"><i class="fas fa-file-text"></i> News Content or Claims</label>
                        <textarea id="news-text" placeholder="Paste news article, social media post, or any claim you want to verify..."></textarea>
                    </div>
                </div>
                
                <div class="input-content" id="urlInput">
                    <div class="input-group">
                        <label for="news-url"><i class="fas fa-link"></i> News Article URL</label>
                        <input type="url" id="news-url" placeholder="https://example.com/news-article-to-verify">
                    </div>
                </div>
            </div>

            <div class="button-group">
                <button class="btn btn-primary" onclick="runAnalysis()">
                    <i class="fas fa-play"></i> Start Analysis
                </button>
                <button class="btn btn-test" onclick="loadTestData()">
                    <i class="fas fa-flask"></i> Load Test Data
                </button>
                <button class="btn btn-pro-test" onclick="testProVersion()">
                    <i class="fas fa-star"></i> Test Pro Version
                </button>
                <button class="btn btn-secondary" onclick="resetForm()">
                    <i class="fas fa-redo"></i> Reset
                </button>
            </div>

            <div class="results" id="results">
                <!-- Free Version Results -->
                <div class="result-card">
                    <div class="result-header">
                        <i class="fas fa-chart-pie"></i>
                        Credibility Assessment (Free Version)
                    </div>
                    
                    <div class="credibility-score">
                        <div class="score-circle">
                            <div class="score-text">82</div>
                        </div>
                        <div>
                            <h3>Moderate Credibility</h3>
                            <p>This content shows reasonable credibility indicators but requires further verification.</p>
                        </div>
                    </div>
                    
                    <div><strong>Source Type:</strong> Established news outlet</div>
                    <div><strong>Publication Date:</strong> Recent (within 24 hours)</div>
                    <div><strong>Basic Fact Check:</strong> No obvious contradictions found</div>
                </div>

                <!-- Locked Pro Features -->
                <div class="locked-content">
                    <div class="lock-icon"><i class="fas fa-lock"></i></div>
                    <h3>Detailed Analysis Available in Pro Version</h3>
                    <p>Unlock comprehensive bias analysis, source network mapping, timeline verification, sentiment analysis, and detailed recommendations.</p>
                    
                    <div class="upgrade-prompt">
                        <strong>Upgrade to Pro for Complete Analysis</strong>
                        <br>• Political bias assessment with visual charts
                        <br>• Source authority ranking and verification
                        <br>• Cross-reference with fact-checking databases
                        <br>• Historical context and timeline analysis
                        <br>• Detailed credibility breakdown
                        <br>• Export and sharing capabilities
                        <button onclick="upgradeToPro()">Upgrade to Pro</button>
                    </div>
                </div>

                <div class="result-card">
                    <div class="result-header">
                        <i class="fas fa-comments"></i>
                        Conversational Summary
                    </div>
                    <p>This article appears to be from a legitimate news source with standard journalistic practices. The content presents information in a factual manner without obvious bias indicators. However, for a complete assessment including political lean analysis, source network verification, and historical context, consider upgrading to our Pro version for more detailed insights.</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentInputType = 'text';

        function switchInputType(type) {
            currentInputType = type;
            
            document.querySelectorAll('.input-tab').forEach((tab, index) => {
                tab.classList.remove('active');
                if ((type === 'text' && index === 0) || (type === 'url' && index === 1)) {
                    tab.classList.add('active');
                }
            });
            
            document.querySelectorAll('.input-content').forEach(content => {
                content.classList.remove('active');
            });
            
            const targetContent = document.getElementById(type + 'Input');
            if (targetContent) {
                targetContent.classList.add('active');
            }
        }

        function loadTestData() {
            const testContent = "Recent reports indicate that a new federal policy has been announced regarding infrastructure spending. The Department of Transportation released a statement confirming the allocation of $2.3 billion for highway improvements across 15 states. Officials state this initiative will create approximately 45,000 jobs over the next 18 months. The announcement comes following bipartisan congressional support for the infrastructure bill passed last quarter.";
            
            document.getElementById('news-text').value = testContent;
            switchInputType('text');
            
            // Show a brief notification
            const notification = document.createElement('div');
            notification.style.cssText = 'position: fixed; top: 20px; right: 20px; background: #10b981; color: white; padding: 15px 20px; border-radius: 8px; z-index: 1000; font-weight: 600;';
            notification.innerHTML = '<i class="fas fa-check"></i> Test data loaded successfully!';
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        async function runAnalysis() {
            // Validate input
            const textInput = document.getElementById('news-text').value;
            const urlInput = document.getElementById('news-url').value;
            
            if (currentInputType === 'text' && !textInput.trim()) {
                alert('Please enter some text to analyze.');
                return;
            }
            
            if (currentInputType === 'url' && !urlInput.trim()) {
                alert('Please enter a URL to analyze.');
                return;
            }
            
            // Show progress section
            const progressSection = document.getElementById('progressSection');
            progressSection.style.display = 'block';
            
            // Reset progress bars to default colors
            document.querySelectorAll('.progress-fill').forEach(bar => {
                bar.style.background = 'linear-gradient(90deg, #667eea, #764ba2, #10b981)';
                bar.style.width = '0%';
            });
            
            // Start progress animation
            const progressBars = ['progress1', 'progress2', 'progress3', 'progress4', 'progress5'];
            let currentProgress = 0;
            
            function updateProgress() {
                if (currentProgress < progressBars.length) {
                    document.getElementById(progressBars[currentProgress]).style.width = '100%';
                    currentProgress++;
                }
            }
            
            // Initial progress
            setTimeout(updateProgress, 500);
            
            try {
                // Prepare data for API call
                const requestData = {};
                if (currentInputType === 'text') {
                    requestData.text = textInput;
                } else {
                    requestData.url = urlInput;
                }
                
                // Make real API call to backend
                const response = await fetch('/api/analyze-news', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(requestData)
                });
                
                // Continue progress updates during API call
                const progressInterval = setInterval(updateProgress, 800);
                
                if (!response.ok) {
                    clearInterval(progressInterval);
                    throw new Error(`Analysis failed: ${response.status} ${response.statusText}`);
                }
                
                const results = await response.json();
                clearInterval(progressInterval);
                
                // Complete remaining progress bars
                while (currentProgress < progressBars.length) {
                    updateProgress();
                    await new Promise(resolve => setTimeout(resolve, 200));
                }
                
                // Hide progress and show real results
                setTimeout(() => {
                    progressSection.style.display = 'none';
                    showRealResults(results);
                }, 500);
                
            } catch (error) {
                console.error('Analysis error:', error);
                progressSection.style.display = 'none';
                
                // Show error message
                const errorDiv = document.createElement('div');
                errorDiv.style.cssText = 'position: fixed; top: 20px; right: 20px; background: #ef4444; color: white; padding: 15px 20px; border-radius: 8px; z-index: 1000; font-weight: 600;';
                errorDiv.innerHTML = `<i class="fas fa-exclamation-triangle"></i> Analysis failed: ${error.message}`;
                document.body.appendChild(errorDiv);
                
                setTimeout(() => {
                    errorDiv.remove();
                }, 5000);
                
                // Show fallback results
                showFreeResults();
            }
        }

        function showRealResults(results) {
            const resultsDiv = document.getElementById('results');
            
            // Extract real data from backend response
            const credibilityScore = results.scoring?.overall_credibility || 50;
            const credibilityGrade = results.scoring?.credibility_grade || 'C';
            const biasScore = results.political_bias?.bias_score || 0;
            const biasLabel = results.political_bias?.bias_label || 'unknown';
            const sourceCount = results.source_verification?.sources_found || 0;
            const avgSourceCredibility = results.source_verification?.average_credibility || 60;
            const factCheckCount = results.fact_check_results?.fact_checks_found || 0;
            const assessment = results.executive_summary?.main_assessment || 'ANALYSIS COMPLETED';
            const summaryText = results.executive_summary?.summary_text || 'Analysis completed with basic assessment.';
            
            // Determine bias position for visual chart (convert -100 to 100 scale to 0-100% position)
            const biasPosition = Math.max(0, Math.min(100, 50 + (biasScore / 2)));
            
            // Get bias color based on score
            let biasColor = '#10b981'; // center/green
            if (Math.abs(biasScore) > 60) {
                biasColor = '#ef4444'; // far left/right - red
            } else if (Math.abs(biasScore) > 30) {
                biasColor = '#f59e0b'; // moderate bias - orange
            }
            
            resultsDiv.innerHTML = `
                <!-- Real Analysis Results -->
                <div class="result-card">
                    <div class="result-header">
                        <i class="fas fa-chart-pie"></i>
                        Comprehensive Credibility Analysis
                        <span style="background: ${credibilityScore >= 80 ? '#10b981' : credibilityScore >= 60 ? '#f59e0b' : '#ef4444'}; color: white; padding: 4px 12px; border-radius: 12px; font-size: 0.8rem; margin-left: 10px;">
                            ${assessment}
                        </span>
                    </div>
                    
                    <div class="credibility-score">
                        <div class="score-circle" style="background: conic-gradient(from 0deg, ${credibilityScore >= 80 ? '#10b981' : credibilityScore >= 60 ? '#f59e0b' : '#ef4444'} 0deg ${credibilityScore * 3.6}deg, #e5e7eb ${credibilityScore * 3.6}deg 360deg);">
                            <div class="score-text" style="color: ${credibilityScore >= 80 ? '#059669' : credibilityScore >= 60 ? '#d97706' : '#dc2626'};">${Math.round(credibilityScore)}</div>
                        </div>
                        <div>
                            <h3>Credibility Score: ${Math.round(credibilityScore)}/100 (Grade: ${credibilityGrade})</h3>
                            <p>${summaryText}</p>
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 20px;">
                        <div style="background: #f8fafc; padding: 15px; border-radius: 10px;">
                            <strong>Political Bias:</strong><br>
                            ${biasLabel.charAt(0).toUpperCase() + biasLabel.slice(1)} (${biasScore > 0 ? '+' : ''}${biasScore}/100)
                        </div>
                        <div style="background: #f8fafc; padding: 15px; border-radius: 10px;">
                            <strong>Sources Verified:</strong><br>
                            ${sourceCount} sources • Avg credibility: ${Math.round(avgSourceCredibility)}%
                        </div>
                        <div style="background: #f8fafc; padding: 15px; border-radius: 10px;">
                            <strong>Fact Checks:</strong><br>
                            ${factCheckCount} fact checks found${results.fact_check_results?.source ? ` via ${results.fact_check_results.source}` : ''}
                        </div>
                    </div>
                </div>

                ${results.source_verification?.sources?.length > 0 ? `
                <div class="result-card">
                    <div class="result-header">
                        <i class="fas fa-network-wired"></i>
                        Source Analysis
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
                        ${results.source_verification.sources.map(source => `
                            <div style="background: #f8fafc; padding: 15px; border-radius: 10px; border-left: 4px solid ${source.credibility >= 80 ? '#10b981' : source.credibility >= 60 ? '#f59e0b' : '#ef4444'};">
                                <div style="font-weight: 700; color: #374151; margin-bottom: 8px;">${source.name}</div>
                                <div style="font-size: 0.9rem; color: #6b7280;">
                                    Credibility: ${source.credibility}/100<br>
                                    ${source.bias ? `Bias: ${source.bias}<br>` : ''}
                                    ${source.type ? `Type: ${source.type.replace('_', ' ')}` : ''}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
                ` : ''}

                ${Math.abs(biasScore) > 5 ? `
                <div class="result-card">
                    <div class="result-header">
                        <i class="fas fa-balance-scale"></i>
                        Political Bias Analysis
                    </div>
                    <div style="background: linear-gradient(90deg, #ef4444 0%, #f59e0b 25%, #10b981 50%, #f59e0b 75%, #ef4444 100%); height: 20px; border-radius: 10px; position: relative; margin: 15px 0;">
                        <div style="position: absolute; top: 50%; left: ${biasPosition}%; transform: translate(-50%, -50%); width: 16px; height: 16px; background: white; border: 3px solid ${biasColor}; border-radius: 50%; box-shadow: 0 2px 8px rgba(0,0,0,0.3);"></div>
                    </div>
                    <div style="display: flex; justify-content: space-between; font-size: 0.85rem; color: #6b7280;">
                        <span>Far Left</span>
                        <span>Center</span>
                        <span>Far Right</span>
                    </div>
                    <div style="text-align: center; margin-top: 10px; color: #4a5568;">
                        Analysis shows <strong>${biasLabel}</strong> positioning with ${results.political_bias?.objectivity_score ? `${results.political_bias.objectivity_score}% objectivity` : 'moderate objectivity'}
                    </div>
                </div>
                ` : ''}

                ${results.fact_check_results?.claims?.length > 0 ? `
                <div class="result-card">
                    <div class="result-header">
                        <i class="fas fa-check-double"></i>
                        Fact Check Results
                    </div>
                    <div style="display: grid; gap: 15px;">
                        ${results.fact_check_results.claims.map(claim => `
                            <div style="background: #f8fafc; padding: 15px; border-radius: 10px; border-left: 4px solid ${claim.rating_value >= 70 ? '#10b981' : claim.rating_value >= 40 ? '#f59e0b' : '#ef4444'};">
                                <div style="font-weight: 600; color: #374151; margin-bottom: 8px;">
                                    ${claim.rating} - ${claim.reviewer}
                                </div>
                                <div style="font-size: 0.9rem; color: #6b7280;">
                                    "${claim.claim_text}"
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
                ` : ''}

                ${results.ai_analysis?.status === 'success' ? `
                <div class="result-card">
                    <div class="result-header">
                        <i class="fas fa-brain"></i>
                        AI Content Analysis
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                        <div style="background: #f8fafc; padding: 15px; border-radius: 10px;">
                            <strong>Writing Quality:</strong><br>
                            ${results.ai_analysis.writing_quality || 'N/A'}/100
                        </div>
                        <div style="background: #f8fafc; padding: 15px; border-radius: 10px;">
                            <strong>Emotional Language:</strong><br>
                            ${results.ai_analysis.emotional_language || 'N/A'}/100
                        </div>
                        <div style="background: #f8fafc; padding: 15px; border-radius: 10px;">
                            <strong>Sensationalism:</strong><br>
                            ${results.ai_analysis.sensationalism_score || 'N/A'}/100
                        </div>
                    </div>
                    ${results.ai_analysis.detailed_explanation ? `
                    <div style="margin-top: 15px; padding: 15px; background: rgba(102, 126, 234, 0.1); border-radius: 10px;">
                        <strong>Analysis Details:</strong><br>
                        ${results.ai_analysis.detailed_explanation}
                    </div>
                    ` : ''}
                </div>
                ` : ''}

                <div class="result-card">
                    <div class="result-header">
                        <i class="fas fa-comments"></i>
                        Analysis Summary
                    </div>
                    <p style="line-height: 1.6; color: #4a5568;">
                        ${summaryText}
                    </p>
                    
                    ${results.methodology ? `
                    <div style="background: #10b981; color: white; padding: 15px; border-radius: 10px; margin-top: 15px; text-align: center;">
                        <strong>Analysis Complete</strong><br>
                        <small>
                            ${results.methodology.ai_models_used} • 
                            ${results.methodology.processing_time} processing • 
                            ${results.methodology.analysis_depth} depth
                        </small>
                    </div>
                    ` : ''}
                </div>
            `;
            
            resultsDiv.style.display = 'block';
            resultsDiv.scrollIntoView({ behavior: 'smooth' });
        }

        function upgradeToPro() {
            alert('🚀 Redirecting to Pro upgrade page...\n\nPro features include:\n• Advanced bias analysis\n• Complete source verification\n• Historical timeline analysis\n• Export capabilities\n• Priority support');
        }

        function resetForm() {
            document.getElementById('news-text').value = '';
            document.getElementById('news-url').value = '';
            document.getElementById('results').style.display = 'none';
            document.getElementById('progressSection').style.display = 'none';
            
            // Reset progress bars
            document.querySelectorAll('.progress-fill').forEach(bar => {
                bar.style.width = '0%';
                bar.style.background = 'linear-gradient(90deg, #667eea, #764ba2, #10b981)';
            });
            
            switchInputType('text');
        }

        async function testProVersion() {
            const testContent = "Breaking: Federal Reserve Chairman announces unexpected policy shift regarding interest rates, citing concerns over inflation data released yesterday. The decision, which contradicts earlier statements from Fed officials, has sparked debate among economists. Some analysts suggest this move could signal deeper concerns about economic stability than previously acknowledged.";
            
            document.getElementById('news-text').value = testContent;
            switchInputType('text');
            
            // Show enhanced progress for pro
            const progressSection = document.getElementById('progressSection');
            progressSection.style.display = 'block';
            
            // Reset progress bars with pro colors
            document.querySelectorAll('.progress-fill').forEach(bar => {
                bar.style.background = 'linear-gradient(90deg, #f59e0b, #10b981, #667eea)';
                bar.style.width = '0%';
            });
            
            // Faster animation for pro test
            const progressBars = ['progress1', 'progress2', 'progress3', 'progress4', 'progress5'];
            let currentProgress = 0;
            
            function updateProProgress() {
                if (currentProgress < progressBars.length) {
                    document.getElementById(progressBars[currentProgress]).style.width = '100%';
                    currentProgress++;
                }
            }
            
            // Start progress
            setTimeout(updateProProgress, 200);
            const progressInterval = setInterval(updateProProgress, 400);
            
            try {
                // Make REAL API call to your backend - no demo data!
                const response = await fetch('/api/analyze-news', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        text: testContent,
                        analysis_type: 'pro'  // Tell backend this is pro-level analysis
                    })
                });
                
                clearInterval(progressInterval);
                
                if (!response.ok) {
                    throw new Error(`Pro analysis failed: ${response.status} ${response.statusText}`);
                }
                
                // Get REAL results from your backend
                const realResults = await response.json();
                
                // Complete remaining progress
                while (currentProgress < progressBars.length) {
                    updateProProgress();
                    await new Promise(resolve => setTimeout(resolve, 150));
                }
                
                setTimeout(() => {
                    progressSection.style.display = 'none';
                    showEnhancedProResults(realResults);  // Use real results with pro styling
                }, 500);
                
            } catch (error) {
                clearInterval(progressInterval);
                console.error('Pro test API error:', error);
                progressSection.style.display = 'none';
                
                // Show error message - no fake demo results
                const errorDiv = document.createElement('div');
                errorDiv.style.cssText = 'position: fixed; top: 20px; right: 20px; background: #ef4444; color: white; padding: 15px 20px; border-radius: 8px; z-index: 1000; font-weight: 600;';
                errorDiv.innerHTML = `<i class="fas fa-exclamation-triangle"></i> Pro analysis failed: ${error.message}`;
                document.body.appendChild(errorDiv);
                
                setTimeout(() => {
                    errorDiv.remove();
                }, 8000);
            }
            
            // Show notification
            const notification = document.createElement('div');
            notification.style.cssText = 'position: fixed; top: 20px; right: 20px; background: linear-gradient(135deg, #f59e0b, #d97706); color: white; padding: 15px 20px; border-radius: 8px; z-index: 1000; font-weight: 600;';
            notification.innerHTML = '<i class="fas fa-star"></i> Pro version analysis initiated!';
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        function showEnhancedProResults(realResults) {
            // Use the REAL results from your backend, just with enhanced pro styling
            showRealResults(realResults);
            
            // Add pro enhancement styling to the real results
            const resultsDiv = document.getElementById('results');
            const proBadge = document.createElement('div');
            proBadge.style.cssText = 'position: absolute; top: -10px; right: 20px; background: linear-gradient(135deg, #f59e0b, #d97706); color: white; padding: 8px 15px; border-radius: 20px; font-size: 0.8rem; font-weight: 700; z-index: 10; box-shadow: 0 4px 15px rgba(245, 158, 11, 0.3);';
            proBadge.innerHTML = '<i class="fas fa-crown"></i> PRO ANALYSIS';
            resultsDiv.style.position = 'relative';
            resultsDiv.insertBefore(proBadge, resultsDiv.firstChild);
            
            // Add subtle gold glow to pro results
            resultsDiv.style.boxShadow = '0 0 30px rgba(245, 158, 11, 0.2)';
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            // No auto-loading of results - only show after analysis
        });
    </script>
</body>
</html>
