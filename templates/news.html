<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NewsVerify Pro - Real News Verification Platform</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üõ°Ô∏è</text></svg>">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
        }

        .header h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 20px;
        }

        .production-badge {
            background: linear-gradient(135deg, #10b981, #059669);
            backdrop-filter: blur(10px);
            padding: 12px 30px;
            border-radius: 25px;
            display: inline-block;
            font-weight: 700;
            font-size: 1rem;
            border: 2px solid rgba(16, 185, 129, 0.3);
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.2);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 8px 25px rgba(16, 185, 129, 0.2); }
            50% { box-shadow: 0 8px 35px rgba(16, 185, 129, 0.4); }
            100% { box-shadow: 0 8px 25px rgba(16, 185, 129, 0.2); }
        }

        .tool-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 50px;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            position: relative;
            overflow: hidden;
        }

        .tool-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .tool-header h2 {
            font-size: 2.8rem;
            color: #4a5568;
            margin-bottom: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .api-status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(16, 185, 129, 0.1));
            border-radius: 15px;
            border: 2px solid rgba(102, 126, 234, 0.2);
        }

        .api-status-item {
            text-align: center;
            padding: 15px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .api-status-icon {
            font-size: 1.5rem;
            margin-bottom: 8px;
            display: block;
        }

        .api-connected { color: #10b981; }
        .api-disconnected { color: #ef4444; }
        .api-optional { color: #f59e0b; }

        .api-name {
            font-weight: 600;
            font-size: 0.9rem;
            margin-bottom: 5px;
        }

        .api-description {
            font-size: 0.8rem;
            color: #6b7280;
        }

        .tier-selector {
            display: flex;
            gap: 40px;
            justify-content: center;
            margin-bottom: 40px;
            flex-wrap: wrap;
        }

        .tier-btn {
            background: linear-gradient(145deg, #f8fafc, #e2e8f0);
            color: #4a5568;
            border: 3px solid #e2e8f0;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.4s ease;
            border-radius: 20px;
            padding: 20px 40px;
            font-size: 1.1rem;
            position: relative;
            min-width: 220px;
            text-align: center;
        }

        .tier-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .tier-btn.active {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            border-color: #10b981;
            color: white;
            transform: translateY(-3px);
        }

        .tier-btn.premium {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-color: #667eea;
            color: white;
        }

        .tier-features {
            font-size: 0.85rem;
            margin-top: 8px;
            opacity: 0.9;
        }

        .input-section {
            margin-bottom: 40px;
        }

        .input-group {
            margin-bottom: 25px;
        }

        .input-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 700;
            color: #4a5568;
            font-size: 1.1rem;
        }

        .input-group textarea, .input-group input {
            width: 100%;
            padding: 18px;
            border: 3px solid #e2e8f0;
            border-radius: 15px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: white;
            font-family: inherit;
        }

        .input-group textarea {
            min-height: 140px;
            resize: vertical;
            line-height: 1.6;
        }

        .input-group textarea:focus, .input-group input:focus {
            outline: none;
            border-color: #10b981;
            box-shadow: 0 0 0 4px rgba(16, 185, 129, 0.1);
        }

        .input-row {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
            align-items: end;
        }

        .sample-buttons {
            margin-bottom: 20px;
            text-align: center;
        }

        .sample-btn {
            background: linear-gradient(145deg, rgba(16, 185, 129, 0.1), rgba(16, 185, 129, 0.2));
            border: 1px solid #10b981;
            color: #10b981;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            margin: 4px;
            transition: all 0.3s ease;
        }

        .sample-btn:hover {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            transform: translateY(-2px);
        }

        .analyze-btn {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            border: none;
            padding: 20px 50px;
            border-radius: 20px;
            font-size: 1.3rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.4s ease;
            width: 100%;
            margin-bottom: 20px;
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.3);
        }

        .analyze-btn:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(16, 185, 129, 0.4);
        }

        .analyze-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .progress-container {
            display: none;
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            padding: 25px 30px;
            border-radius: 15px;
            margin: 20px 0;
            color: white;
            text-align: center;
        }

        .progress-text {
            font-weight: 700;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: rgba(0, 0, 0, 0.25);
            border-radius: 15px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #ffffff, #f0fdf4, #ffffff);
            border-radius: 15px;
            transition: width 1.5s ease;
            width: 0%;
        }

        .progress-details {
            font-size: 0.95rem;
            opacity: 0.9;
        }

        .progress-apis {
            font-size: 0.85rem;
            margin-top: 10px;
            opacity: 0.8;
        }

        .results {
            display: none;
            margin-top: 40px;
        }

        .result-card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border-left: 5px solid #10b981;
        }

        .score-display {
            text-align: center;
            margin-bottom: 30px;
        }

        .score-circle {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            font-weight: 900;
            color: white;
            margin: 0 auto 20px;
            position: relative;
        }

        .score-high { background: linear-gradient(135deg, #10b981, #059669); }
        .score-medium { background: linear-gradient(135deg, #f59e0b, #d97706); }
        .score-low { background: linear-gradient(135deg, #ef4444, #dc2626); }

        .score-grade {
            position: absolute;
            bottom: -5px;
            font-size: 0.8rem;
            background: rgba(0, 0, 0, 0.2);
            padding: 2px 8px;
            border-radius: 10px;
        }

        .real-analysis-badge {
            display: inline-block;
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            padding: 8px 16px;
            border-radius: 15px;
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .analysis-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .metric-card {
            background: #f8fafc;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            border: 2px solid #e2e8f0;
            transition: all 0.3s ease;
        }

        .metric-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        .metric-value {
            font-size: 2rem;
            font-weight: 900;
            color: #10b981;
            margin-bottom: 8px;
        }

        .metric-label {
            font-weight: 600;
            color: #4a5568;
            margin-bottom: 5px;
        }

        .metric-description {
            font-size: 0.9rem;
            color: #6b7280;
        }

        .api-usage-indicator {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(5, 150, 105, 0.05));
            border: 1px solid rgba(16, 185, 129, 0.3);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .api-usage-title {
            font-weight: 600;
            color: #10b981;
            margin-bottom: 8px;
        }

        .api-usage-list {
            font-size: 0.9rem;
            color: #4a5568;
        }

        .expandable-section {
            margin-bottom: 20px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            border: 2px solid rgba(16, 185, 129, 0.1);
        }

        .section-header {
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 20px;
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
        }

        .section-header:hover {
            background: linear-gradient(135deg, #059669 0%, #047857 100%);
        }

        .section-content {
            padding: 20px;
            display: none;
        }

        .section-content.active {
            display: block;
        }

        .fact-check-results {
            background: #f0fdf4;
            border: 2px solid #10b981;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
        }

        .fact-check-item {
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid #d1fae5;
        }

        .fact-check-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .fact-check-rating {
            font-weight: 700;
            color: #059669;
        }

        .cross-platform-results {
            background: #fef3c7;
            border: 2px solid #f59e0b;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
        }

        .platform-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .platform-score {
            font-weight: 600;
            color: #d97706;
        }

        .error-message {
            background: linear-gradient(145deg, rgba(255, 68, 68, 0.1), rgba(255, 68, 68, 0.05));
            border: 2px solid rgba(255, 68, 68, 0.3);
            color: #ff4444;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            font-weight: 600;
            text-align: center;
        }

        .reset-btn {
            background: linear-gradient(145deg, #6b7280, #4b5563);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 15px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
        }

        .reset-btn:hover {
            background: linear-gradient(145deg, #4b5563, #374151);
            transform: translateY(-2px);
        }

        .loading-apis {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 15px;
        }

        .loading-api {
            padding: 5px 12px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            font-size: 0.8rem;
            animation: fadeInOut 2s infinite;
        }

        @keyframes fadeInOut {
            0%, 100% { opacity: 0.6; }
            50% { opacity: 1; }
        }

        @media (max-width: 768px) {
            .tool-container {
                padding: 30px;
            }
            .tier-selector {
                flex-direction: column;
                align-items: center;
            }
            .tier-btn {
                width: 100%;
                max-width: 300px;
            }
            .input-row {
                grid-template-columns: 1fr;
            }
            .api-status-grid {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-shield-alt"></i> NewsVerify Pro</h1>
            <p>Real News Verification Platform - Live API Integration</p>
            <div class="production-badge">
                <i class="fas fa-satellite-dish"></i> PRODUCTION READY - Live APIs
            </div>
        </div>

        <div class="tool-container">
            <div class="tool-header">
                <h2><i class="fas fa-newspaper"></i> Real NewsVerify Pro</h2>
                <p>Professional news verification with live fact-checking APIs</p>
            </div>

            <!-- Real API Status Grid -->
            <div class="api-status-grid" id="apiStatusGrid">
                <div class="api-status-item">
                    <div class="api-status-icon" id="openaiStatus">üîÑ</div>
                    <div class="api-name">OpenAI API</div>
                    <div class="api-description">AI Detection & Analysis</div>
                </div>
                <div class="api-status-item">
                    <div class="api-status-icon" id="newsapiStatus">üîÑ</div>
                    <div class="api-name">NewsAPI</div>
                    <div class="api-description">Live News Verification</div>
                </div>
                <div class="api-status-item">
                    <div class="api-status-icon" id="googleFactStatus">üîÑ</div>
                    <div class="api-name">Google Fact Check</div>
                    <div class="api-description">Professional Fact-Checking</div>
                </div>
                <div class="api-status-item">
                    <div class="api-status-icon" id="mediastackStatus">üîÑ</div>
                    <div class="api-name">MediaStack</div>
                    <div class="api-description">Additional News Sources</div>
                </div>
            </div>

            <div class="tier-selector">
                <button class="tier-btn active" id="freeBtn" onclick="selectTier('free')">
                    üÜì Standard Analysis
                    <div class="tier-features">Pattern-based ‚Ä¢ 50+ sources ‚Ä¢ Basic AI detection</div>
                </button>
                <button class="tier-btn premium" id="premiumBtn" onclick="selectTier('premium')">
                    ‚≠ê Premium Analysis
                    <div class="tier-features">OpenAI GPT-4 ‚Ä¢ 500+ sources ‚Ä¢ Advanced features</div>
                </button>
            </div>

            <div class="input-section">
                <div class="sample-buttons">
                    <label style="display: block; margin-bottom: 10px; font-weight: 600;">üìö Try Real Content Samples:</label>
                    <button class="sample-btn" onclick="loadSample('reuters')">üì∞ Reuters Article</button>
                    <button class="sample-btn" onclick="loadSample('opinion')">üí≠ Opinion Piece</button>
                    <button class="sample-btn" onclick="loadSample('social')">üì± Social Media Post</button>
                    <button class="sample-btn" onclick="loadSample('ai_generated')">ü§ñ AI-Generated</button>
                </div>
                
                <div class="input-row">
                    <div class="input-group">
                        <label for="news-text"><i class="fas fa-file-text"></i> News Article Content</label>
                        <textarea id="news-text" placeholder="Paste news article content here for real-time verification using live APIs. Our system will fact-check against Google's database, verify across multiple news sources, detect AI generation, and provide professional analysis..."></textarea>
                    </div>
                    <div class="input-group">
                        <label for="news-url"><i class="fas fa-link"></i> Article URL (Optional)</label>
                        <input type="url" id="news-url" placeholder="https://example.com/article">
                    </div>
                </div>
            </div>

            <div style="text-align: center;">
                <button class="analyze-btn" onclick="analyzeNews()" id="analyzeButton">
                    <i class="fas fa-satellite-dish"></i> Start Real-Time Analysis
                </button>
                
                <div class="progress-container" id="progressContainer">
                    <div class="progress-text" id="progressText">Initializing real APIs...</div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <div class="progress-details" id="progressDetails">Connecting to verification services...</div>
                    <div class="progress-apis" id="progressApis">
                        <div class="loading-apis">
                            <div class="loading-api">Google Fact Check</div>
                            <div class="loading-api">NewsAPI</div>
                            <div class="loading-api">OpenAI</div>
                            <div class="loading-api">MediaStack</div>
                        </div>
                    </div>
                </div>
                
                <button class="reset-btn" onclick="resetForm()">
                    <i class="fas fa-undo"></i> Reset
                </button>
            </div>

            <div class="results" id="results">
                <!-- Real results will be populated here -->
            </div>
        </div>
    </div>

    <script>
        console.log('NewsVerify Pro - Real Production Version Loaded');
        
        let currentTier = 'free';
        let apiStatus = {};
        let lastAnalysisData = null;

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            checkRealAPIStatus();
        });

        // Check real API status
        async function checkRealAPIStatus() {
            try {
                console.log('Checking real API status...');
                const response = await fetch('/api/health');
                
                if (response.ok) {
                    const healthData = await response.json();
                    apiStatus = healthData;
                    updateAPIStatusDisplay(healthData);
                } else {
                    throw new Error(`Backend returned ${response.status}`);
                }
            } catch (error) {
                console.error('API status check failed:', error);
                updateAPIStatusDisplay(null);
            }
        }

        // Update API status display
        function updateAPIStatusDisplay(healthData) {
            const statusMapping = {
                'openaiStatus': 'openai_api',
                'newsapiStatus': 'newsapi', 
                'googleFactStatus': 'google_factcheck',
                'mediastackStatus': 'mediastack'
            };

            for (const [elementId, apiKey] of Object.entries(statusMapping)) {
                const element = document.getElementById(elementId);
                if (healthData && healthData[apiKey] === 'connected') {
                    element.textContent = '‚úÖ';
                    element.className = 'api-status-icon api-connected';
                } else if (healthData && healthData[apiKey] === 'not_configured') {
                    element.textContent = '‚ö†Ô∏è';
                    element.className = 'api-status-icon api-optional';
                } else {
                    element.textContent = '‚ùå';
                    element.className = 'api-status-icon api-disconnected';
                }
            }
        }

        // MAIN ANALYSIS FUNCTION - Real Implementation
        async function analyzeNews() {
            const newsText = document.getElementById('news-text').value.trim();
            const newsUrl = document.getElementById('news-url').value.trim();
            
            if (!newsText && !newsUrl) {
                alert('Please provide either article content or URL for analysis');
                return;
            }

            showProgress();
            document.getElementById('results').style.display = 'none';

            try {
                updateProgress(15, 'üîó Connecting to Live APIs...', 'Establishing secure connections to verification services...');
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                updateProgress(35, 'üéØ Real-Time Processing...', `Running ${currentTier} analysis with live data...`);
                
                // Call real backend API
                const analysisResult = await callRealBackendAPI(newsText, newsUrl);
                
                updateProgress(75, 'üìä Aggregating Results...', 'Combining data from multiple verification sources...');
                await new Promise(resolve => setTimeout(resolve, 800));

                updateProgress(95, '‚úÖ Analysis Complete!', 'Real verification results ready...');
                
                lastAnalysisData = analysisResult;
                
                setTimeout(() => {
                    hideProgress();
                    displayRealResults(analysisResult);
                }, 1000);

            } catch (error) {
                console.error('Real analysis failed:', error);
                hideProgress();
                showError(`Real-time analysis failed: ${error.message}`);
            }
        }

        // Real backend API call
        async function callRealBackendAPI(content, url) {
            try {
                const requestData = {
                    content: content,
                    url: url,
                    tier: currentTier
                };

                console.log('Calling real backend with:', requestData);

                const response = await fetch('/api/analyze-news', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(requestData)
                });

                if (!response.ok) {
                    const errorText = await response.text();
                    console.error('Real backend error:', errorText);
                    throw new Error(`Backend error: ${response.status} ${response.statusText}`);
                }

                const responseText = await response.text();
                console.log('Real backend response length:', responseText.length);
                
                if (!responseText || responseText.trim() === '') {
                    throw new Error('Empty response from real backend');
                }

                let data;
                try {
                    data = JSON.parse(responseText);
                } catch (parseError) {
                    console.error('JSON parse error:', parseError);
                    throw new Error(`Invalid JSON response: ${parseError.message}`);
                }

                console.log('Successfully parsed real backend data:', data);
                return data;
            } catch (error) {
                console.error('Real backend API call failed:', error);
                throw error;
            }
        }

        // Display real results
        function displayRealResults(analysisData) {
            const results = document.getElementById('results');
            results.style.display = 'block';

            const credibilityScore = analysisData.credibility_score || 70;
            const grade = analysisData.credibility_grade || 'B+';
            const assessment = analysisData.credibility_assessment || 'Analysis completed';
            const analysisMethod = analysisData.analysis_method || 'real_api_integration';
            
            const scoreClass = credibilityScore >= 80 ? 'score-high' : credibilityScore >= 60 ? 'score-medium' : 'score-low';

            // Generate API usage indicator
            const apisUsed = analysisData.executive_summary?.apis_used || [];
            const apiUsageHTML = apisUsed.length > 0 ? `
                <div class="api-usage-indicator">
                    <div class="api-usage-title"><i class="fas fa-satellite-dish"></i> Live APIs Used:</div>
                    <div class="api-usage-list">${apisUsed.join(' ‚Ä¢ ')}</div>
                </div>
            ` : '';

            results.innerHTML = `
                <div class="result-card">
                    <div class="real-analysis-badge">
                        <i class="fas fa-satellite-dish"></i> Real-Time Analysis Complete
                    </div>
                    
                    ${apiUsageHTML}
                    
                    <div class="score-display">
                        <div class="score-circle ${scoreClass}">
                            ${credibilityScore}
                            <div class="score-grade">${grade}</div>
                        </div>
                        <h3>${assessment}</h3>
                        <p><strong>Method:</strong> ${analysisMethod.replace(/_/g, ' ').toUpperCase()}</p>
                    </div>
                    
                    <div class="analysis-grid">
                        ${generateRealMetricCards(analysisData)}
                    </div>
                    
                    <div style="margin-top: 30px; padding: 20px; background: #f0fdf4; border-radius: 15px; border: 2px solid #10b981;">
                        <h4 style="color: #059669; margin-bottom: 15px;">
                            <i class="fas fa-satellite-dish"></i> Real-Time Analysis Summary
                        </h4>
                        <p style="line-height: 1.6;">
                            ${analysisData.executive_summary?.summary_text || 
                                `Real-time analysis completed using live APIs with ${analysisMethod} method. ` +
                                `Overall credibility: ${credibilityScore}/100 (Grade: ${grade}). ` +
                                `Verified through multiple professional sources.`
                            }
                        </p>
                    </div>
                </div>

                ${generateRealExpandableSections(analysisData)}
            `;
        }

        // Generate real metric cards
        function generateRealMetricCards(data) {
            const metrics = [];
            
            // AI Detection
            const aiData = data.ai_detection || {};
            if ('ai_probability' in aiData) {
                const aiProb = typeof aiData.ai_probability === 'number' ? 
                    Math.round(aiData.ai_probability * 100) : aiData.ai_probability;
                metrics.push(`
                    <div class="metric-card">
                        <div class="metric-value">${aiProb}%</div>
                        <div class="metric-label">AI Probability</div>
                        <div class="metric-description">${aiData.classification || 'AI detection analysis'}</div>
                    </div>
                `);
            }

            // Bias Analysis
            const biasData = data.bias_analysis || {};
            if ('bias_score' in biasData) {
                metrics.push(`
                    <div class="metric-card">
                        <div class="metric-value">${Math.abs(biasData.bias_score || 0)}</div>
                        <div class="metric-label">Bias Score</div>
                        <div class="metric-description">${biasData.bias_direction || 'Political bias analysis'}</div>
                    </div>
                `);
            }

            // Source Analysis
            const sourceData = data.source_analysis || {};
            if ('source_credibility' in sourceData) {
                metrics.push(`
                    <div class="metric-card">
                        <div class="metric-value">${sourceData.source_credibility}</div>
                        <div class="metric-label">Source Score</div>
                        <div class="metric-description">${sourceData.known_source ? 'Verified source' : 'Unknown source'}</div>
                    </div>
                `);
            }

            // Fact Check
            const factData = data.fact_check || {};
            if (factData.fact_check_available) {
                const claimsFound = factData.claims_found || 0;
                metrics.push(`
                    <div class="metric-card">
                        <div class="metric-value">${claimsFound}</div>
                        <div class="metric-label">Fact Checks</div>
                        <div class="metric-description">Professional verifications found</div>
                    </div>
                `);
            }

            // Cross-platform verification
            const crossPlatform = data.cross_platform_verification || {};
            if ('verification_score' in crossPlatform) {
                metrics.push(`
                    <div class="metric-card">
                        <div class="metric-value">${Math.round(crossPlatform.verification_score)}</div>
                        <div class="metric-label">Consensus</div>
                        <div class="metric-description">${crossPlatform.platforms_analyzed || 0} platforms checked</div>
                    </div>
                `);
            }

            // Plagiarism
            const plagiarismData = data.plagiarism_detection || {};
            if ('similarity_score' in plagiarismData) {
                const similarityPercent = Math.round(plagiarismData.similarity_score * 100);
                metrics.push(`
                    <div class="metric-card">
                        <div class="metric-value">${similarityPercent}%</div>
                        <div class="metric-label">Similarity</div>
                        <div class="metric-description">${plagiarismData.matches?.length || 0} matches found</div>
                    </div>
                `);
            }

            return metrics.join('');
        }

        // Generate real expandable sections
        function generateRealExpandableSections(data) {
            let sections = '';

            // AI Detection Section
            const aiData = data.ai_detection || {};
            if (Object.keys(aiData).length > 0) {
                sections += `
                    <div class="expandable-section">
                        <div class="section-header" onclick="toggleSection('ai')">
                            <h3 style="margin: 0; display: flex; align-items: center; justify-content: space-between;">
                                <span><i class="fas fa-robot"></i> Real AI Content Detection</span>
                                <span id="ai-toggle">‚ñº</span>
                            </h3>
                        </div>
                        <div class="section-content" id="ai-content">
                            <p><strong>AI Probability:</strong> ${typeof aiData.ai_probability === 'number' ? Math.round(aiData.ai_probability * 100) : aiData.ai_probability}%</p>
                            <p><strong>Classification:</strong> ${aiData.classification || 'Not available'}</p>
                            <p><strong>Confidence:</strong> ${typeof aiData.confidence === 'number' ? Math.round(aiData.confidence * 100) : aiData.confidence}%</p>
                            <p><strong>Analysis:</strong> ${aiData.explanation || 'Advanced AI detection completed'}</p>
                            ${aiData.detailed_analysis ? `
                                <div style="margin-top: 15px; padding: 15px; background: #f8fafc; border-radius: 10px;">
                                    <strong>Detailed Analysis:</strong><br>
                                    Statistical Score: ${aiData.detailed_analysis.statistical?.ai_indicators_score || 'N/A'}<br>
                                    Linguistic Score: ${aiData.detailed_analysis.linguistic?.linguistic_ai_score || 'N/A'}<br>
                                    ${aiData.detailed_analysis.openai ? 'OpenAI Analysis: Available' : 'OpenAI Analysis: Pattern-based only'}
                                </div>
                            ` : ''}
                        </div>
                    </div>
                `;
            }

            // Real Fact-Checking Section
            const factData = data.fact_check || {};
            if (Object.keys(factData).length > 0 && !factData.error) {
                sections += `
                    <div class="expandable-section">
                        <div class="section-header" onclick="toggleSection('factcheck')">
                            <h3 style="margin: 0; display: flex; align-items: center; justify-content: space-between;">
                                <span><i class="fas fa-search-plus"></i> Live Fact-Check Results</span>
                                <span id="factcheck-toggle">‚ñº</span>
                            </h3>
                        </div>
                        <div class="section-content" id="factcheck-content">
                            ${factData.fact_check_available ? `
                                <div class="fact-check-results">
                                    <p><strong>Professional Fact-Checks Found:</strong> ${factData.claims_found || 0}</p>
                                    ${factData.fact_checks ? factData.fact_checks.map(factCheck => `
                                        <div class="fact-check-item">
                                            <p><strong>Claim:</strong> ${factCheck.claim}</p>
                                            <p><strong>Rating:</strong> <span class="fact-check-rating">${factCheck.rating}</span></p>
                                            <p><strong>Source:</strong> ${factCheck.source}</p>
                                            <p><strong>Claimant:</strong> ${factCheck.claimant}</p>
                                            ${factCheck.url ? `<p><strong>URL:</strong> <a href="${factCheck.url}" target="_blank">View Full Fact-Check</a></p>` : ''}
                                        </div>
                                    `).join('') : ''}
                                </div>
                            ` : `
                                <p>No professional fact-checks found in Google's database for this content.</p>
                                <p><em>This doesn't necessarily indicate false information - many true stories simply haven't been specifically fact-checked.</em></p>
                            `}
                        </div>
                    </div>
                `;
            }

            // Cross-Platform Verification Section
            const crossPlatform = data.cross_platform_verification || {};
            if (Object.keys(crossPlatform).length > 0) {
                sections += `
                    <div class="expandable-section">
                        <div class="section-header" onclick="toggleSection('crossplatform')">
                            <h3 style="margin: 0; display: flex; align-items: center; justify-content: space-between;">
                                <span><i class="fas fa-network-wired"></i> Live Cross-Platform Verification</span>
                                <span id="crossplatform-toggle">‚ñº</span>
                            </h3>
                        </div>
                        <div class="section-content" id="crossplatform-content">
                            <div class="cross-platform-results">
                                <p><strong>Platforms Analyzed:</strong> ${crossPlatform.platforms_analyzed || 0}</p>
                                <p><strong>Verification Score:</strong> ${Math.round(crossPlatform.verification_score || 0)}/100</p>
                                <p><strong>Consensus Strength:</strong> ${crossPlatform.consensus_strength || 'Unknown'}</p>
                                ${crossPlatform.platforms_checked ? `
                                    <div style="margin-top: 15px;">
                                        <strong>Sources Checked:</strong><br>
                                        ${crossPlatform.platforms_checked.map(platform => `
                                            <div class="platform-item">
                                                <span>${platform}</span>
                                                <span class="platform-score">‚úì Verified</span>
                                            </div>
                                        `).join('')}
                                    </div>
                                ` : ''}
                            </div>
                        </div>
                    </div>
                `;
            }

            // Plagiarism Detection Section
            const plagiarismData = data.plagiarism_detection || {};
            if (Object.keys(plagiarismData).length > 0) {
                sections += `
                    <div class="expandable-section">
                        <div class="section-header" onclick="toggleSection('plagiarism')">
                            <h3 style="margin: 0; display: flex; align-items: center; justify-content: space-between;">
                                <span><i class="fas fa-copy"></i> Real Plagiarism Detection</span>
                                <span id="plagiarism-toggle">‚ñº</span>
                            </h3>
                        </div>
                        <div class="section-content" id="plagiarism-content">
                            <p><strong>Overall Similarity:</strong> ${Math.round((plagiarismData.similarity_score || 0) * 100)}%</p>
                            <p><strong>Databases Checked:</strong> ${plagiarismData.databases_checked?.join(', ') || 'None'}</p>
                            <p><strong>Assessment:</strong> ${plagiarismData.overall_assessment || 'Clean'}</p>
                            ${plagiarismData.matches && plagiarismData.matches.length > 0 ? `
                                <div style="margin-top: 15px;">
                                    <strong>Matches Found:</strong><br>
                                    ${plagiarismData.matches.map(match => `
                                        <div style="margin: 10px 0; padding: 10px; background: #fef3c7; border-radius: 8px;">
                                            <p><strong>Source:</strong> ${match.source}</p>
                                            <p><strong>Similarity:</strong> ${Math.round(match.similarity * 100)}%</p>
                                            <p><strong>Type:</strong> ${match.type}</p>
                                            ${match.url ? `<p><strong>URL:</strong> <a href="${match.url}" target="_blank">View Source</a></p>` : ''}
                                        </div>
                                    `).join('')}
                                </div>
                            ` : '<p><em>No significant similarity matches found.</em></p>'}
                        </div>
                    </div>
                `;
            }

            // Bias Analysis Section
            const biasData = data.bias_analysis || {};
            if (Object.keys(biasData).length > 0) {
                sections += `
                    <div class="expandable-section">
                        <div class="section-header" onclick="toggleSection('bias')">
                            <h3 style="margin: 0; display: flex; align-items: center; justify-content: space-between;">
                                <span><i class="fas fa-balance-scale"></i> Political Bias Analysis</span>
                                <span id="bias-toggle">‚ñº</span>
                            </h3>
                        </div>
                        <div class="section-content" id="bias-content">
                            <p><strong>Bias Direction:</strong> ${biasData.bias_direction || 'Center'}</p>
                            <p><strong>Bias Score:</strong> ${biasData.bias_score || 0} (Range: -100 to +100)</p>
                            <p><strong>Confidence:</strong> ${biasData.bias_confidence || 75}%</p>
                            <p><strong>Analysis:</strong> ${biasData.bias_explanation || 'Political bias analysis completed'}</p>
                        </div>
                    </div>
                `;
            }

            return sections;
        }

        // Utility functions
        function selectTier(tier) {
            currentTier = tier;
            
            document.querySelectorAll('.tier-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(tier === 'free' ? 'freeBtn' : 'premiumBtn').classList.add('active');

            const analyzeBtn = document.getElementById('analyzeButton');
            analyzeBtn.innerHTML = tier === 'free' ? 
                '<i class="fas fa-satellite-dish"></i> Start Real-Time Analysis' : 
                '<i class="fas fa-star"></i> Start Premium Analysis';
        }

        function loadSample(type) {
            const samples = {
                reuters: `WASHINGTON, Dec 15 (Reuters) - The Federal Reserve raised its benchmark interest rate by 0.25 percentage points on Wednesday, bringing it to a 22-year high of 5.25%-5.5% as the central bank continues its efforts to combat inflation.

The decision was unanimous among voting members of the Federal Open Market Committee. Fed Chair Jerome Powell indicated during his post-meeting press conference that future policy decisions will depend on incoming economic data, particularly inflation metrics and employment figures.

"We remain committed to bringing inflation back to our 2% target," Powell said. "Today's decision reflects our ongoing assessment of economic conditions and our determination to ensure price stability."

The rate increase had been widely anticipated by financial markets, with economists citing recent inflation data that showed core prices rising faster than expected in November.`,
                
                opinion: `The Federal Reserve's Latest Rate Hike: A Necessary Evil or Policy Mistake?

The Fed's decision to raise rates again yesterday strikes me as both predictable and potentially problematic. While Chair Powell's commitment to fighting inflation is admirable, I can't help but wonder if we're witnessing the early stages of policy overcorrection.

Consider the broader economic context: unemployment remains near historic lows, but consumer confidence has been steadily declining. Small businesses are already struggling with higher borrowing costs, and this additional quarter-point increase could be the proverbial straw that breaks the camel's back.

Furthermore, the Fed's own projections suggest inflation will moderate naturally over the coming quarters. Why risk triggering a recession when patience might achieve the same result?`,
                
                social: `üö® BREAKING: Fed raises rates AGAIN! 0.25% increase brings us to 5.5% - highest since 2001! üìà

This is getting ridiculous. How are ordinary Americans supposed to afford mortgages when rates keep climbing? My cousin just got quoted 7.8% for a 30-year mortgage. That's INSANE! üò§

Powell says it's about "fighting inflation" but all I see is them making it impossible for regular people to buy homes while the rich get richer from their bond investments. 

Anyone else think they're just protecting Wall Street? üí≠ #FedPolicy #InterestRates #Economy`,
                
                ai_generated: `The Federal Reserve's monetary policy decision represents a comprehensive approach to macroeconomic stabilization through strategic interest rate optimization. This sophisticated framework demonstrates the institution's commitment to maintaining price stability while simultaneously addressing the complex interplay between inflationary pressures and economic growth dynamics.

Furthermore, the implementation of this monetary tightening mechanism reflects a nuanced understanding of contemporary economic challenges. The systematic approach to rate adjustments illustrates the Fed's data-driven methodology, incorporating sophisticated econometric models and forward-looking indicators.

Additionally, this policy framework represents a paradigm shift toward more proactive monetary intervention. The comprehensive nature of these adjustments demonstrates institutional commitment to long-term economic stability through carefully calibrated policy instruments.`
            };
            
            document.getElementById('news-text').value = samples[type];
            document.getElementById('news-url').value = ''; // Clear URL when loading sample
        }

        function resetForm() {
            document.getElementById('news-text').value = '';
            document.getElementById('news-url').value = '';
            document.getElementById('results').style.display = 'none';
            hideProgress();
        }

        function updateProgress(percentage, text, detail = '') {
            document.getElementById('progressFill').style.width = percentage + '%';
            document.getElementById('progressText').textContent = text;
            document.getElementById('progressDetails').textContent = detail;
        }

        function showProgress() {
            document.getElementById('progressContainer').style.display = 'block';
            updateProgress(0, 'Initializing real-time analysis...', 'Connecting to live verification services...');
        }

        function hideProgress() {
            document.getElementById('progressContainer').style.display = 'none';
        }

        function showError(message) {
            const results = document.getElementById('results');
            results.style.display = 'block';
            results.innerHTML = `
                <div class="error-message">
                    <i class="fas fa-exclamation-triangle"></i>
                    <h3>Real-Time Analysis Error</h3>
                    <p>${message}</p>
                    <p style="margin-top: 15px; font-size: 0.9rem; opacity: 0.8;">
                        Please check your API configurations and try again. Some APIs may require setup.
                    </p>
                </div>
            `;
        }

        function toggleSection(sectionName) {
            const content = document.getElementById(sectionName + '-content');
            const toggle = document.getElementById(sectionName + '-toggle');
            
            if (content.classList.contains('active')) {
                content.classList.remove('active');
                toggle.textContent = '‚ñº';
            } else {
                content.classList.add('active');
                toggle.textContent = '‚ñ≤';
            }
        }
    </script>
</body>
</html>
