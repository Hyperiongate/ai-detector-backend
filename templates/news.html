<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI News Intelligence System - Facts & Fakes</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #1a1f2e;
            color: #ffffff;
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Static gradient background - no animation */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 50%, rgba(120, 119, 198, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(255, 119, 198, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 40% 20%, rgba(120, 219, 255, 0.1) 0%, transparent 50%);
            z-index: -1;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }

        /* Header - removed animated glow */
        .header {
            text-align: center;
            margin-bottom: 50px;
            padding: 40px 0;
            position: relative;
        }

        .header h1 {
            font-size: 3.5em;
            font-weight: 900;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #4facfe 75%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .header p {
            font-size: 1.3em;
            color: #b0bec5;
            margin-bottom: 20px;
        }

        /* State of the Art Section */
        .tech-intro {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 40px;
            backdrop-filter: blur(10px);
            cursor: pointer;
            transition: all 0.3s;
        }

        .tech-intro:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(120, 119, 198, 0.5);
            transform: translateY(-2px);
            box-shadow: 0 10px 40px rgba(120, 119, 198, 0.3);
        }

        .tech-intro h3 {
            color: #64b5f6;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .tech-intro-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-out;
        }

        .tech-intro.expanded .tech-intro-content {
            max-height: 500px;
        }

        /* Input Section */
        .input-section {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 40px;
            backdrop-filter: blur(10px);
            position: relative;
            overflow: hidden;
        }

        .input-tabs {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .input-tab {
            padding: 12px 30px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.05);
            color: #b0bec5;
            font-weight: 600;
            cursor: pointer;
            border-radius: 50px;
            transition: all 0.3s;
            font-size: 16px;
        }

        .input-tab:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(120, 119, 198, 0.5);
            color: #ffffff;
        }

        .input-tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-color: transparent;
            color: #ffffff;
            box-shadow: 0 5px 20px rgba(120, 119, 198, 0.5);
        }

        /* Analysis type explanation */
        .analysis-explanation {
            background: rgba(79, 172, 254, 0.1);
            border: 1px solid rgba(79, 172, 254, 0.3);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 25px;
            font-size: 15px;
            line-height: 1.6;
        }

        .analysis-explanation h4 {
            color: #64b5f6;
            margin-bottom: 10px;
        }

        .input-content {
            display: none;
        }

        .input-content.active {
            display: block;
        }

        .input-group {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }

        .url-input, .text-input {
            flex: 1;
            padding: 18px 24px;
            border: 2px solid rgba(255, 255, 255, 0.15);
            border-radius: 15px;
            background: rgba(255, 255, 255, 0.08);
            color: #ffffff;
            font-size: 16px;
            transition: all 0.3s;
            font-family: inherit;
        }

        .text-input {
            min-height: 200px;
            resize: vertical;
            width: 100%;
        }

        .url-input:focus, .text-input:focus {
            outline: none;
            border-color: rgba(120, 119, 198, 0.5);
            background: rgba(255, 255, 255, 0.1);
            box-shadow: 0 0 30px rgba(120, 119, 198, 0.3);
        }

        .url-input::placeholder, .text-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .analyze-btn {
            padding: 18px 40px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 50px;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 5px 20px rgba(120, 119, 198, 0.4);
        }

        .analyze-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(120, 119, 198, 0.6);
        }

        .analyze-btn:disabled {
            background: rgba(255, 255, 255, 0.1);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* Loading State - Fixed position at top */
        .loading {
            display: none;
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 90%;
            max-width: 800px;
            padding: 30px;
            background: rgba(30, 35, 50, 0.95);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            backdrop-filter: blur(10px);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            z-index: 1000;
        }

        .loading.active {
            display: block;
        }

        .checkpoint-progress {
            margin-bottom: 20px;
        }

        .checkpoints {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            position: relative;
        }

        .checkpoint {
            display: flex;
            flex-direction: column;
            align-items: center;
            z-index: 2;
            opacity: 0.5;
            transition: all 0.3s;
        }

        .checkpoint.active {
            opacity: 1;
        }

        .checkpoint.completed {
            opacity: 1;
        }

        .checkpoint-icon {
            width: 50px;
            height: 50px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            margin-bottom: 8px;
            transition: all 0.3s;
        }

        .checkpoint.active .checkpoint-icon {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-color: transparent;
            box-shadow: 0 0 20px rgba(120, 119, 198, 0.6);
        }

        .checkpoint.completed .checkpoint-icon {
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
            border-color: transparent;
        }

        .checkpoint-label {
            font-size: 12px;
            color: #b0bec5;
            text-align: center;
        }

        .progress-bar-container {
            position: absolute;
            top: 25px;
            left: 25px;
            right: 25px;
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            z-index: 1;
        }

        .progress-bar {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            transition: width 0.5s ease;
            box-shadow: 0 0 10px rgba(120, 119, 198, 0.6);
        }

        .loading-status {
            text-align: center;
            font-size: 16px;
            color: #b0bec5;
        }

        /* Results Section */
        .results {
            display: none;
        }

        .results.active {
            display: block;
        }

        /* Overall Summary - All in one box */
        .overall-summary {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 40px;
            backdrop-filter: blur(10px);
        }

        .summary-header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 30px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .trust-score-container {
            display: inline-block;
            position: relative;
            margin-bottom: 20px;
        }

        .trust-score {
            width: 200px;
            height: 200px;
            position: relative;
        }

        .trust-score svg {
            transform: rotate(-90deg);
        }

        .trust-score-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 48px;
            font-weight: bold;
        }

        .trust-label {
            font-size: 20px;
            font-weight: 600;
            margin-top: 10px;
        }

        .summary-sections {
            display: grid;
            gap: 25px;
        }

        .summary-section {
            padding: 25px;
            border-left: 4px solid rgba(79, 172, 254, 0.5);
        }

        .summary-section h3 {
            color: #64b5f6;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.3em;
        }

        /* Analysis Dropdowns - Full width with colored borders */
        .pro-section {
            margin-top: 40px;
        }

        .pro-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .pro-badge {
            display: inline-block;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 8px 20px;
            border-radius: 50px;
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 20px;
        }

        .analysis-dropdown {
            background: rgba(255, 255, 255, 0.08);
            border: 2px solid;
            border-radius: 15px;
            margin-bottom: 20px;
            overflow: hidden;
            transition: all 0.3s;
        }

        /* Different colors for each dropdown */
        .analysis-dropdown:nth-child(1) { border-color: #667eea; }
        .analysis-dropdown:nth-child(2) { border-color: #4facfe; }
        .analysis-dropdown:nth-child(3) { border-color: #f093fb; }
        .analysis-dropdown:nth-child(4) { border-color: #48bb78; }
        .analysis-dropdown:nth-child(5) { border-color: #fa709a; }
        .analysis-dropdown:nth-child(6) { border-color: #6a11cb; }
        .analysis-dropdown:nth-child(7) { border-color: #f56565; }
        .analysis-dropdown:nth-child(8) { border-color: #11998e; }

        .analysis-dropdown:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .analysis-dropdown.expanded {
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.4);
        }

        .dropdown-header {
            padding: 25px 30px;
            background: rgba(255, 255, 255, 0.05);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .dropdown-header:hover {
            background: rgba(255, 255, 255, 0.08);
        }

        .dropdown-icon-wrapper {
            display: flex;
            align-items: center;
            gap: 20px;
            flex: 1;
        }

        .dropdown-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--icon-color-1), var(--icon-color-2));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            flex-shrink: 0;
        }

        .dropdown-title-section {
            flex: 1;
        }

        .dropdown-title {
            font-size: 18px;
            font-weight: 700;
            color: #ffffff;
            margin-bottom: 5px;
        }

        .dropdown-preview {
            font-size: 14px;
            color: #b0bec5;
        }

        .expand-icon {
            font-size: 20px;
            color: #b0bec5;
            transition: transform 0.3s;
        }

        .analysis-dropdown.expanded .expand-icon {
            transform: rotate(180deg);
        }

        .dropdown-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-out;
        }

        .analysis-dropdown.expanded .dropdown-content {
            max-height: 2000px;
        }

        .dropdown-body {
            padding: 30px;
            background: rgba(0, 0, 0, 0.2);
        }

        .analysis-intro {
            background: rgba(79, 172, 254, 0.1);
            border-left: 4px solid #64b5f6;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
        }

        .analysis-intro h4 {
            color: #64b5f6;
            margin-bottom: 10px;
        }

        .analysis-details {
            margin-top: 25px;
        }

        .metric-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .metric-item:last-child {
            border-bottom: none;
        }

        .metric-label {
            font-weight: 600;
            color: #e2e8f0;
        }

        .metric-value {
            font-weight: 500;
            color: #64b5f6;
        }

        /* Visual indicators for metrics */
        .metric-visual {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .metric-bar {
            width: 100px;
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
        }

        .metric-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #48bb78 0%, #38a169 100%);
            transition: width 0.5s ease;
        }

        /* Bias Gauge */
        .bias-gauge {
            margin: 25px 0;
            padding: 25px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
        }

        .gauge-container {
            position: relative;
            height: 50px;
            background: linear-gradient(to right, #3b82f6 0%, #a78bfa 50%, #ef4444 100%);
            border-radius: 25px;
            margin: 20px 0;
        }

        .gauge-marker {
            position: absolute;
            top: 50%;
            transform: translate(-50%, -50%);
            width: 30px;
            height: 30px;
            background: #ffffff;
            border-radius: 50%;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        /* Claim Cards */
        .claim-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .claim-icon {
            font-size: 30px;
            flex-shrink: 0;
        }

        .claim-content {
            flex: 1;
        }

        .claim-text {
            font-weight: 600;
            margin-bottom: 10px;
            color: #e2e8f0;
        }

        .claim-verdict {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            margin-right: 10px;
        }

        .claim-verdict.true {
            background: rgba(72, 187, 120, 0.2);
            color: #48bb78;
        }

        .claim-verdict.false {
            background: rgba(245, 101, 101, 0.2);
            color: #f56565;
        }

        .claim-verdict.unverified {
            background: rgba(237, 137, 54, 0.2);
            color: #ed8936;
        }

        /* Key Findings with icons */
        .finding-item {
            padding: 20px;
            margin-bottom: 15px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            gap: 15px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.15);
        }

        .finding-icon {
            font-size: 30px;
            flex-shrink: 0;
        }

        .finding-text {
            flex: 1;
            line-height: 1.6;
        }

        /* Action Buttons */
        .action-section {
            text-align: center;
            margin-top: 40px;
        }

        .btn {
            display: inline-block;
            padding: 15px 35px;
            margin: 0 10px;
            border: none;
            border-radius: 50px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 5px 20px rgba(120, 119, 198, 0.4);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(120, 119, 198, 0.6);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        /* Messages */
        .message {
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            text-align: center;
            font-weight: 500;
        }

        .error {
            background: rgba(245, 101, 101, 0.1);
            border: 1px solid rgba(245, 101, 101, 0.3);
            color: #f56565;
        }

        .success {
            background: rgba(72, 187, 120, 0.1);
            border: 1px solid rgba(72, 187, 120, 0.3);
            color: #48bb78;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2.5em;
            }
            
            .input-group {
                flex-direction: column;
            }
            
            .analyze-btn {
                width: 100%;
            }
            
            .checkpoints {
                flex-wrap: wrap;
                gap: 20px;
            }
            
            .progress-bar-container {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>AI News Intelligence System</h1>
            <p>State-of-the-Art Neural Analysis Powered by GPT-4</p>
        </div>

        <!-- State of the Art Explanation -->
        <div class="tech-intro" onclick="toggleTechIntro()">
            <h3>🚀 Cutting-Edge AI Technology - Click to Learn More</h3>
            <div class="tech-intro-content">
                <p style="margin-bottom: 20px;">Our system leverages the most advanced AI technologies available to provide you with comprehensive news analysis:</p>
                <ul style="list-style: none; padding: 0;">
                    <li style="margin-bottom: 15px;">🧠 <strong>GPT-4 Language Model:</strong> OpenAI's most sophisticated AI for understanding context, detecting bias, and fact-checking with human-level comprehension</li>
                    <li style="margin-bottom: 15px;">📊 <strong>Multi-Source Verification:</strong> Cross-references claims against multiple databases and knowledge sources to ensure accuracy</li>
                    <li style="margin-bottom: 15px;">🔍 <strong>Deep Learning Analysis:</strong> Neural networks trained on millions of articles to detect manipulation patterns and writing techniques</li>
                    <li style="margin-bottom: 15px;">⚡ <strong>Real-Time Processing:</strong> Instant analysis with comprehensive results in seconds, providing immediate insights</li>
                    <li style="margin-bottom: 15px;">🎯 <strong>Bias Detection AI:</strong> Advanced algorithms to identify political lean, emotional manipulation, and perspective framing</li>
                    <li style="margin-bottom: 15px;">📈 <strong>Credibility Scoring:</strong> Proprietary algorithms combining source history, author credentials, content quality, and fact accuracy</li>
                </ul>
            </div>
        </div>

        <!-- Input Section -->
        <div class="input-section">
            <div class="input-tabs">
                <button class="input-tab active" onclick="switchInputType('url')">🔗 URL Analysis</button>
                <button class="input-tab" onclick="switchInputType('text')">📝 Text Analysis</button>
            </div>
            
            <!-- URL Input -->
            <div class="input-content active" id="urlInput">
                <div class="analysis-explanation">
                    <h4>🔗 URL Analysis - Recommended for Best Results</h4>
                    <p>URL analysis provides the most accurate results by accessing the full article context, including metadata, publication date, author information, and source credibility. Our system can extract all relevant information directly from the webpage, ensuring nothing is missed. This method also allows us to verify the source domain and check for any updates or corrections to the article.</p>
                </div>
                <div class="input-group">
                    <input type="url" 
                           id="articleUrl" 
                           placeholder="Enter news article URL for deep analysis..." 
                           class="url-input">
                </div>
            </div>
            
            <!-- Text Input -->
            <div class="input-content" id="textInput">
                <div class="analysis-explanation">
                    <h4>📝 Text Analysis - Alternative Method</h4>
                    <p>Text analysis is useful when you have article text but no URL, or when a website blocks automated access. While still highly accurate, this method may miss some context like publication date, author credentials, or source domain verification. For best results, include the complete article text including title, author name, publication date, and all content. The more complete the text, the more accurate our analysis will be.</p>
                </div>
                <textarea id="articleText" 
                          placeholder="Paste complete article text including title, author, date, and full content for most accurate analysis..."
                          class="text-input"></textarea>
            </div>
            
            <div style="text-align: center; margin-top: 30px;">
                <button class="analyze-btn" onclick="analyzeArticle()">
                    🤖 INITIATE AI ANALYSIS
                </button>
            </div>
        </div>

        <!-- Advanced Loading State - Fixed at top -->
        <div class="loading" id="loading">
            <div class="checkpoint-progress">
                <div class="checkpoints">
                    <div class="checkpoint" data-stage="0">
                        <div class="checkpoint-icon">📡</div>
                        <div class="checkpoint-label">Extracting</div>
                    </div>
                    <div class="checkpoint" data-stage="1">
                        <div class="checkpoint-icon">🧠</div>
                        <div class="checkpoint-label">AI Analysis</div>
                    </div>
                    <div class="checkpoint" data-stage="2">
                        <div class="checkpoint-icon">🔍</div>
                        <div class="checkpoint-label">Fact Check</div>
                    </div>
                    <div class="checkpoint" data-stage="3">
                        <div class="checkpoint-icon">⚖️</div>
                        <div class="checkpoint-label">Bias Scan</div>
                    </div>
                    <div class="checkpoint" data-stage="4">
                        <div class="checkpoint-icon">📊</div>
                        <div class="checkpoint-label">Finalizing</div>
                    </div>
                    <div class="progress-bar-container">
                        <div class="progress-bar" id="progressBar"></div>
                    </div>
                </div>
            </div>
            <div class="loading-status" id="loadingStatus">Initializing neural networks...</div>
        </div>

        <!-- Results -->
        <div class="results" id="results">
            <!-- Will be dynamically populated -->
        </div>
    </div>

    <script>
        // State management
        let currentInputType = 'url';
        let currentAnalysisData = null;
        let currentStage = 0;

        // Toggle functions
        window.toggleTechIntro = function() {
            document.querySelector('.tech-intro').classList.toggle('expanded');
        }

        window.switchInputType = function(type) {
            currentInputType = type;
            
            document.querySelectorAll('.input-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            document.querySelectorAll('.input-content').forEach(content => {
                content.classList.remove('active');
            });
            
            if (type === 'url') {
                document.getElementById('urlInput').classList.add('active');
            } else {
                document.getElementById('textInput').classList.add('active');
            }
        }

        // Main analysis function
        window.analyzeArticle = async function() {
            let content = '';
            let contentType = currentInputType;
            
            if (currentInputType === 'url') {
                content = document.getElementById('articleUrl').value.trim();
                if (!content) {
                    showMessage('Please enter a valid URL to analyze. The URL should be a complete web address starting with http:// or https://', 'error');
                    return;
                }
            } else {
                content = document.getElementById('articleText').value.trim();
                if (!content) {
                    showMessage('Please enter the article text to analyze. Include as much information as possible for accurate results.', 'error');
                    return;
                }
                contentType = 'text';
            }
            
            // Reset and show loading
            currentStage = 0;
            document.querySelector('.analyze-btn').disabled = true;
            document.querySelector('.analyze-btn').textContent = '⏳ ANALYZING...';
            document.getElementById('loading').classList.add('active');
            document.getElementById('results').classList.remove('active');
            
            // Reset checkpoints
            document.querySelectorAll('.checkpoint').forEach(cp => {
                cp.classList.remove('active', 'completed');
            });
            document.getElementById('progressBar').style.width = '0%';
            
            // Start checkpoint animation
            animateCheckpoints();
            
            try {
                const response = await fetch('/api/analyze-news', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        content: content,
                        type: contentType,
                        is_pro: true
                    })
                });
                
                const data = await response.json();
                
                if (!response.ok || !data.success) {
                    throw new Error(data.error || 'Analysis failed');
                }
                
                currentAnalysisData = data;
                
                // Complete remaining stages quickly
                while (currentStage < 5) {
                    await new Promise(resolve => setTimeout(resolve, 200));
                    updateCheckpoint(currentStage);
                    currentStage++;
                }
                
                // Display results
                setTimeout(() => {
                    displayResults(data);
                }, 500);
                
            } catch (error) {
                console.error('Analysis error:', error);
                let errorMessage = 'Analysis failed: ';
                
                if (error.message.includes('403') || error.message.includes('Forbidden')) {
                    errorMessage = '⚠️ This website blocks automated access for security reasons. Please use the Text Analysis option instead by copying and pasting the article content.';
                } else if (error.message.includes('Invalid URL')) {
                    errorMessage = '⚠️ The URL appears to be invalid. Please check that it\'s a complete web address starting with http:// or https://';
                } else {
                    errorMessage += error.message + '. Please try again or contact support if the issue persists.';
                }
                
                showMessage(errorMessage, 'error');
            } finally {
                document.querySelector('.analyze-btn').disabled = false;
                document.querySelector('.analyze-btn').textContent = '🤖 INITIATE AI ANALYSIS';
                document.getElementById('loading').classList.remove('active');
            }
        }

        // Checkpoint animation
        function animateCheckpoints() {
            const stages = [
                'Extracting article content and metadata from source...',
                'Running GPT-4 neural network analysis on content...',
                'Cross-referencing claims against fact-checking databases...',
                'Analyzing writing patterns for bias detection...',
                'Generating comprehensive intelligence report...'
            ];
            
            const interval = setInterval(() => {
                if (currentStage >= stages.length) {
                    clearInterval(interval);
                    return;
                }
                
                updateCheckpoint(currentStage);
                document.getElementById('loadingStatus').textContent = stages[currentStage];
                currentStage++;
            }, 1500);
        }

        function updateCheckpoint(stage) {
            const checkpoints = document.querySelectorAll('.checkpoint');
            const progressBar = document.getElementById('progressBar');
            
            if (stage > 0) {
                checkpoints[stage - 1].classList.remove('active');
                checkpoints[stage - 1].classList.add('completed');
            }
            
            if (stage < checkpoints.length) {
                checkpoints[stage].classList.add('active');
            }
            
            const progress = ((stage + 1) / checkpoints.length) * 100;
            progressBar.style.width = progress + '%';
        }

        // Display results
        function displayResults(data) {
            const results = data.results;
            const resultsDiv = document.getElementById('results');
            
            resultsDiv.classList.add('active');
            
            // Generate overall summary - all in one box
            const overallSummary = `
                <div class="overall-summary">
                    <div class="summary-header">
                        <div class="trust-score-container">
                            <div class="trust-score">
                                <svg width="200" height="200">
                                    <circle cx="100" cy="100" r="90" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="20"/>
                                    <circle id="trustCircle" cx="100" cy="100" r="90" fill="none" 
                                            stroke="${getTrustColor(results.credibility)}" 
                                            stroke-width="20" 
                                            stroke-dasharray="565.5" 
                                            stroke-dashoffset="565.5"
                                            style="filter: drop-shadow(0 0 20px ${getTrustColor(results.credibility)})"/>
                                </svg>
                                <div class="trust-score-text" style="color: ${getTrustColor(results.credibility)}">
                                    ${results.credibility || 0}%
                                </div>
                            </div>
                            <div class="trust-label" style="color: ${getTrustColor(results.credibility)}">
                                ${getTrustLabel(results.credibility)}
                            </div>
                        </div>
                    </div>
                    
                    <div class="summary-sections">
                        <!-- Source & Author -->
                        <div class="summary-section">
                            <h3>📰 Source & Author Information</h3>
                            <p><strong>News Source:</strong> ${results.sources?.name || 'Unknown'} 
                               ${results.sources?.domain && results.sources.domain !== 'Direct Input' ? `(${results.sources.domain})` : ''}</p>
                            <p><strong>Article Author:</strong> ${results.author && results.author !== 'Unknown' ? results.author : 'No author attribution found - this may indicate lower credibility'}</p>
                            ${results.sources?.credibility ? `<p><strong>Source Credibility Score:</strong> ${results.sources.credibility}% - ${getCredibilityDescription(results.sources.credibility)}</p>` : ''}
                        </div>
                        
                        <!-- What the Article is About -->
                        <div class="summary-section">
                            <h3>📋 Article Summary & Main Points</h3>
                            <p>${results.summary || 'The article content covers current events and news topics. Our AI system has analyzed the full content to provide detailed insights below.'}</p>
                        </div>
                        
                        <!-- Key Findings with graphics -->
                        <div class="summary-section">
                            <h3>🔍 Key Analysis Findings</h3>
                            ${generateKeyFindings(results)}
                        </div>
                    </div>
                </div>
            `;
            
            // Generate pro analysis dropdowns
            const proAnalysis = `
                <div class="pro-section">
                    <div class="pro-header">
                        <span class="pro-badge">PRO ANALYSIS</span>
                        <h2 style="color: #ffffff; font-size: 2em; margin-top: 10px;">Deep AI Intelligence Report</h2>
                        <p style="color: #b0bec5; margin-top: 10px;">Click on any section below to expand detailed analysis</p>
                    </div>
                    
                    <div class="analysis-list">
                        ${generateAnalysisDropdowns(results)}
                    </div>
                </div>
            `;
            
            // Action buttons
            const actions = `
                <div class="action-section">
                    <button class="btn btn-primary" onclick="shareResults()">
                        📤 Share Analysis Results
                    </button>
                    <button class="btn btn-secondary" onclick="resetAnalysis()">
                        🔄 Analyze Another Article
                    </button>
                </div>
            `;
            
            resultsDiv.innerHTML = overallSummary + proAnalysis + actions;
            
            // Animate trust score
            animateTrustScore(results.credibility || 0);
            
            // Add click handlers for dropdowns
            document.querySelectorAll('.dropdown-header').forEach(header => {
                header.addEventListener('click', function() {
                    const dropdown = this.closest('.analysis-dropdown');
                    dropdown.classList.toggle('expanded');
                });
            });
            
            // Animate metric bars
            setTimeout(() => {
                document.querySelectorAll('.metric-bar-fill').forEach(bar => {
                    const width = bar.getAttribute('data-width');
                    if (width) {
                        bar.style.width = width;
                    }
                });
            }, 100);
            
            resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        // Generate key findings with visual indicators
        function generateKeyFindings(results) {
            const findings = [];
            
            // Source credibility with icon
            if (results.sources?.credibility >= 80) {
                findings.push({ 
                    icon: '✅', 
                    text: `Highly credible and trustworthy news source: ${results.sources.name}. This source has a strong track record of accurate reporting and journalistic integrity.`, 
                    type: 'success' 
                });
            } else if (results.sources?.credibility >= 60) {
                findings.push({ 
                    icon: '⚠️', 
                    text: `Moderately credible source: ${results.sources.name}. This source generally provides reliable information but may have occasional accuracy issues or bias.`, 
                    type: 'warning' 
                });
            } else {
                findings.push({ 
                    icon: '❌', 
                    text: 'Low credibility or unverified source detected. Information from this source should be cross-referenced with other reliable sources before accepting as fact.', 
                    type: 'danger' 
                });
            }
            
            // Author information
            if (results.author && results.author !== 'Unknown') {
                findings.push({ 
                    icon: '👤', 
                    text: `Author properly identified as ${results.author}. Author attribution is a positive sign of accountability and transparency in journalism.`, 
                    type: 'success' 
                });
            } else {
                findings.push({ 
                    icon: '❓', 
                    text: 'No author attribution found in this article. Anonymous or unattributed articles may be less reliable as there is no accountability for the content.', 
                    type: 'warning' 
                });
            }
            
            // Bias detection
            if (results.bias?.objectivity >= 80) {
                findings.push({ 
                    icon: '⚖️', 
                    text: 'Highly objective and balanced reporting detected. The article presents facts without significant bias or emotional manipulation.', 
                    type: 'success' 
                });
            } else if (results.bias?.label) {
                findings.push({ 
                    icon: '📊', 
                    text: `${results.bias.label} perspective detected in the article. While bias doesn\'t necessarily mean inaccuracy, readers should be aware of the political or ideological framing.`, 
                    type: 'warning' 
                });
            }
            
            // Overall accuracy assessment
            if (results.overall_accuracy >= 80) {
                findings.push({ 
                    icon: '🎯', 
                    text: `High factual accuracy verified: ${results.overall_accuracy}% of claims are supported by evidence. This article appears to be well-researched and factually reliable.`, 
                    type: 'success' 
                });
            } else if (results.overall_accuracy >= 60) {
                findings.push({ 
                    icon: '📈', 
                    text: `Moderate factual accuracy: ${results.overall_accuracy}% of claims verified. Some statements may require additional verification from other sources.`, 
                    type: 'warning' 
                });
            }
            
            // Add GPT-4 specific findings
            if (results.key_findings?.length > 0) {
                results.key_findings.slice(0, 3).forEach(finding => {
                    findings.push({ 
                        icon: '🧠', 
                        text: finding, 
                        type: 'info' 
                    });
                });
            }
            
            return findings.map(f => `
                <div class="finding-item">
                    <span class="finding-icon">${f.icon}</span>
                    <span class="finding-text">${f.text}</span>
                </div>
            `).join('');
        }

        // Generate analysis dropdowns with colored borders
        function generateAnalysisDropdowns(results) {
            const dropdowns = [];
            
            // Author Credibility Analysis
            if (results.author || results.author === 'Unknown') {
                dropdowns.push({
                    icon: '👤',
                    title: 'Author Credibility & Background Analysis',
                    preview: results.author !== 'Unknown' ? `Author: ${results.author}` : 'No author attribution found',
                    iconColors: ['#667eea', '#764ba2'],
                    content: `
                        <div class="analysis-intro">
                            <h4>What this analysis reveals:</h4>
                            <p>Author credibility is a crucial factor in determining article reliability. We evaluate the author's professional background, expertise in the subject matter, track record of accurate reporting, and any potential conflicts of interest. Established journalists with relevant expertise and transparent affiliations typically produce more trustworthy content.</p>
                        </div>
                        <div class="analysis-details">
                            <div class="metric-item">
                                <span class="metric-label">Author Name:</span>
                                <span class="metric-value">${results.author !== 'Unknown' ? results.author : 'Not Provided'}</span>
                            </div>
                            <div class="metric-item">
                                <span class="metric-label">Attribution Status:</span>
                                <span class="metric-value">${results.author !== 'Unknown' ? 'Verified ✓' : 'Missing ✗'}</span>
                            </div>
                            <div class="metric-item">
                                <span class="metric-label">Credibility Impact:</span>
                                <div class="metric-visual">
                                    <span class="metric-value">${results.author !== 'Unknown' ? 'Positive' : 'Negative'}</span>
                                    <div class="metric-bar">
                                        <div class="metric-bar-fill" data-width="${results.author !== 'Unknown' ? '80%' : '20%'}" style="background: ${results.author !== 'Unknown' ? '#48bb78' : '#f56565'};"></div>
                                    </div>
                                </div>
                            </div>
                            <p style="margin-top: 20px; padding: 20px; background: rgba(255,255,255,0.05); border-radius: 10px;">
                                <strong>Why this matters:</strong> ${results.author !== 'Unknown' ? 
                                'Author attribution demonstrates accountability and allows readers to verify the writer\'s credentials and potential biases. This transparency is a hallmark of quality journalism.' : 
                                'The absence of author attribution is a red flag. Anonymous articles lack accountability and make it impossible to verify the writer\'s expertise or identify potential conflicts of interest.'}
                            </p>
                        </div>
                    `
                });
            }
            
            // Source Verification & History
            if (results.sources) {
                dropdowns.push({
                    icon: '🏛️',
                    title: 'News Source Verification & Credibility Assessment',
                    preview: `${results.sources.name} - ${results.sources.credibility || 'Unknown'}% credibility score`,
                    iconColors: ['#4facfe', '#00f2fe'],
                    content: `
                        <div class="analysis-intro">
                            <h4>What this analysis reveals:</h4>
                            <p>We verify news sources against our comprehensive database of thousands of media outlets worldwide. This analysis examines the source's historical accuracy, editorial standards, transparency policies, correction practices, ownership structure, and any known political affiliations. Sources with consistent track records of accurate reporting and transparent correction policies score higher.</p>
                        </div>
                        <div class="analysis-details">
                            <div class="metric-item">
                                <span class="metric-label">Source Name:</span>
                                <span class="metric-value">${results.sources.name}</span>
                            </div>
                            <div class="metric-item">
                                <span class="metric-label">Website Domain:</span>
                                <span class="metric-value">${results.sources.domain}</span>
                            </div>
                            <div class="metric-item">
                                <span class="metric-label">Credibility Score:</span>
                                <div class="metric-visual">
                                    <span class="metric-value">${results.sources.credibility || 'N/A'}%</span>
                                    <div class="metric-bar">
                                        <div class="metric-bar-fill" data-width="${results.sources.credibility || 0}%" style="background: ${getScoreColor(results.sources.credibility)};"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="metric-item">
                                <span class="metric-label">Known Political Bias:</span>
                                <span class="metric-value">${results.sources.bias || 'Not detected'}</span>
                            </div>
                            ${results.sources.assessment ? `
                            <p style="margin-top: 20px; padding: 20px; background: rgba(255,255,255,0.05); border-radius: 10px;">
                                <strong>AI Assessment:</strong> ${results.sources.assessment}
                            </p>` : ''}
                            <p style="margin-top: 20px; padding: 20px; background: rgba(79,172,254,0.1); border-radius: 10px;">
                                <strong>Credibility factors considered:</strong> Historical accuracy, editorial independence, transparency about funding and ownership, correction policies, journalistic standards adherence, and peer recognition in the media industry.
                            </p>
                        </div>
                    `
                });
            }
            
            // Bias & Objectivity Detection
            if (results.bias) {
                dropdowns.push({
                    icon: '⚖️',
                    title: 'Political Bias & Objectivity Analysis',
                    preview: `${results.bias.label} perspective - ${results.bias.objectivity}% objective reporting`,
                    iconColors: ['#f093fb', '#f5576c'],
                    content: `
                        <div class="analysis-intro">
                            <h4>What this analysis reveals:</h4>
                            <p>Our advanced AI examines linguistic patterns, word choices, source selection, story framing, and emotional language to detect political bias. We analyze whether all sides of an issue are presented fairly, if loaded language is used, and whether facts are cherry-picked to support a particular narrative. Remember: bias doesn't necessarily mean inaccuracy - it indicates perspective and framing.</p>
                        </div>
                        ${createBiasGauge(results.bias)}
                        <div class="analysis-details">
                            ${results.bias.reasoning ? `
                            <p style="margin-bottom: 20px; padding: 20px; background: rgba(255,255,255,0.05); border-radius: 10px;">
                                <strong>GPT-4 Detailed Analysis:</strong> ${results.bias.reasoning}
                            </p>` : ''}
                            <div class="metric-item">
                                <span class="metric-label">Political Lean Detected:</span>
                                <span class="metric-value">${results.bias.label}</span>
                            </div>
                            <div class="metric-item">
                                <span class="metric-label">Objectivity Score:</span>
                                <div class="metric-visual">
                                    <span class="metric-value">${results.bias.objectivity}%</span>
                                    <div class="metric-bar">
                                        <div class="metric-bar-fill" data-width="${results.bias.objectivity}%" style="background: ${getScoreColor(results.bias.objectivity)};"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="metric-item">
                                <span class="metric-label">Bias Intensity Score:</span>
                                <span class="metric-value">${results.bias.score > 0 ? '+' : ''}${results.bias.score} (${Math.abs(results.bias.score) <= 3 ? 'Mild' : Math.abs(results.bias.score) <= 6 ? 'Moderate' : 'Strong'})</span>
                            </div>
                            <p style="margin-top: 20px; padding: 20px; background: rgba(255,255,255,0.05); border-radius: 10px;">
                                <strong>Understanding bias scores:</strong> Negative scores indicate left-leaning bias, positive scores indicate right-leaning bias. The magnitude indicates intensity. Quality journalism can exist across the political spectrum - what matters is transparency about perspective and fair representation of facts.
                            </p>
                        </div>
                    `
                });
            }
            
            // Fact Verification Results
            if (results.claims && results.claims.length > 0) {
                dropdowns.push({
                    icon: '✓',
                    title: 'Fact-Checking & Claim Verification Results',
                    preview: `${results.claims.length} factual claims analyzed and verified`,
                    iconColors: ['#48bb78', '#38a169'],
                    content: `
                        <div class="analysis-intro">
                            <h4>What this analysis reveals:</h4>
                            <p>GPT-4 identifies specific factual claims made in the article and verifies them against its vast knowledge base trained on millions of reliable sources. Each claim is evaluated for accuracy, logical consistency, and supporting evidence. We also check for common misinformation patterns and logical fallacies. High confidence scores indicate strong evidence supporting the claim.</p>
                        </div>
                        <div class="analysis-details">
                            ${results.claims.map(claim => `
                                <div class="claim-card">
                                    <span class="claim-icon">${getClaimIcon(claim.status)}</span>
                                    <div class="claim-content">
                                        <div class="claim-text">"${claim.claim}"</div>
                                        <div>
                                            <span class="claim-verdict ${getClaimClass(claim.status)}">
                                                ${getClaimLabel(claim.status)}
                                            </span>
                                            <span style="color: #b0bec5;">AI Confidence: ${claim.confidence}%</span>
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                            ${results.overall_accuracy ? `
                            <div style="margin-top: 20px; padding: 20px; background: rgba(72,187,120,0.1); border-radius: 10px; text-align: center;">
                                <strong style="color: #48bb78; font-size: 1.2em;">Overall Factual Accuracy Score: ${results.overall_accuracy}%</strong>
                                <p style="margin-top: 10px; color: #b0bec5;">This score represents the percentage of verifiable claims that our AI confirmed as accurate based on available evidence.</p>
                            </div>` : ''}
                        </div>
                    `
                });
            }
            
            // Writing Quality & Journalistic Standards
            if (results.style) {
                dropdowns.push({
                    icon: '✍️',
                    title: 'Writing Quality & Journalistic Standards Analysis',
                    preview: `${results.style.tone || 'Unknown'} tone - ${results.style.balanced ? 'Balanced' : 'Unbalanced'} reporting`,
                    iconColors: ['#fa709a', '#fee140'],
                    content: `
                        <div class="analysis-intro">
                            <h4>What this analysis reveals:</h4>
                            <p>Quality journalism follows specific standards: multiple sources, verifiable data, balanced perspectives, and clear attribution. We analyze the article's use of direct quotes (indicating primary sourcing), statistical evidence (showing research depth), complexity of language (accessibility vs sophistication), and whether multiple viewpoints are presented fairly. High-quality articles typically include diverse sources and concrete evidence.</p>
                        </div>
                        <div class="analysis-details">
                            <div class="metric-item">
                                <span class="metric-label">Direct Quote Usage:</span>
                                <div class="metric-visual">
                                    <span class="metric-value">${results.style.quotes} quotes ${results.style.quotes >= 2 ? '✅' : '⚠️'}</span>
                                    <div class="metric-bar">
                                        <div class="metric-bar-fill" data-width="${Math.min(results.style.quotes * 20, 100)}%" style="background: ${results.style.quotes >= 2 ? '#48bb78' : '#ed8936'};"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="metric-item">
                                <span class="metric-label">Statistical Evidence:</span>
                                <div class="metric-visual">
                                    <span class="metric-value">${results.style.statistics} references ${results.style.statistics >= 2 ? '✅' : '⚠️'}</span>
                                    <div class="metric-bar">
                                        <div class="metric-bar-fill" data-width="${Math.min(results.style.statistics * 20, 100)}%" style="background: ${results.style.statistics >= 2 ? '#48bb78' : '#ed8936'};"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="metric-item">
                                <span class="metric-label">Reading Complexity:</span>
                                <span class="metric-value">Grade ${results.style.readingLevel} level (${results.style.readingLevel <= 8 ? 'Easy' : results.style.readingLevel <= 12 ? 'Moderate' : 'Advanced'})</span>
                            </div>
                            <div class="metric-item">
                                <span class="metric-label">Writing Tone:</span>
                                <span class="metric-value">${results.style.tone || 'Not analyzed'}</span>
                            </div>
                            <div class="metric-item">
                                <span class="metric-label">Balanced Perspective:</span>
                                <span class="metric-value">${results.style.balanced ? 'Yes ✅ - Multiple viewpoints presented' : 'No ❌ - Single perspective dominates'}</span>
                            </div>
                            <p style="margin-top: 20px; padding: 20px; background: rgba(255,255,255,0.05); border-radius: 10px;">
                                <strong>Quality indicators:</strong> High-quality journalism typically includes at least 2-3 direct quotes from relevant sources, statistical evidence to support claims, accessible language (8th-12th grade level), neutral tone, and balanced presentation of different perspectives on controversial topics.
                            </p>
                        </div>
                    `
                });
            }
            
            // AI Deep Insights & Pattern Recognition
            if (results.key_findings && results.key_findings.length > 0) {
                dropdowns.push({
                    icon: '🧠',
                    title: 'AI Deep Insights & Pattern Recognition',
                    preview: `${results.key_findings.length} advanced observations detected`,
                    iconColors: ['#6a11cb', '#2575fc'],
                    content: `
                        <div class="analysis-intro">
                            <h4>What this analysis reveals:</h4>
                            <p>GPT-4's advanced neural networks can identify subtle patterns, logical inconsistencies, missing context, and manipulation techniques that human readers might miss. This includes detecting cherry-picked data, false equivalencies, strawman arguments, emotional manipulation, missing crucial context, and coordinated messaging patterns. These insights help readers understand not just what is said, but what is left unsaid.</p>
                        </div>
                        <div class="analysis-details">
                            ${results.key_findings.map((finding, i) => `
                                <div style="margin-bottom: 15px; padding: 20px; background: rgba(255,255,255,0.05); border-radius: 10px; border-left: 4px solid #64b5f6;">
                                    <strong style="color: #64b5f6;">Key Insight ${i + 1}:</strong>
                                    <p style="margin-top: 10px; line-height: 1.6;">${finding}</p>
                                </div>
                            `).join('')}
                            <p style="margin-top: 20px; padding: 20px; background: rgba(106,17,203,0.1); border-radius: 10px;">
                                <strong>How AI helps:</strong> These insights are generated by analyzing thousands of linguistic patterns, comparing against known manipulation techniques, and identifying what information might be missing or misrepresented. This helps readers develop a more complete understanding of the topic.
                            </p>
                        </div>
                    `
                });
            }
            
            // Warning Signs & Red Flags
            if (results.red_flags && results.red_flags.length > 0) {
                dropdowns.push({
                    icon: '⚠️',
                    title: 'Warning Signs & Credibility Red Flags',
                    preview: `${results.red_flags.length} potential issues identified`,
                    iconColors: ['#f56565', '#ed8936'],
                    content: `
                        <div class="analysis-intro">
                            <h4>What this analysis reveals:</h4>
                            <p>Our system identifies specific warning signs that may indicate unreliable information, manipulation tactics, or poor journalistic practices. These include missing attribution, unverifiable claims, emotional manipulation, logical fallacies, selective fact presentation, and signs of coordinated disinformation. Each red flag doesn't necessarily mean the article is false, but readers should approach with extra scrutiny.</p>
                        </div>
                        <div class="analysis-details">
                            ${results.red_flags.map(flag => `
                                <div style="margin-bottom: 15px; padding: 20px; background: rgba(245,101,101,0.1); border-radius: 10px; border-left: 4px solid #f56565;">
                                    <strong style="color: #f56565;">⚠️ Warning:</strong>
                                    <p style="margin-top: 10px; line-height: 1.6;">${flag}</p>
                                </div>
                            `).join('')}
                            <p style="margin-top: 20px; padding: 20px; background: rgba(255,255,255,0.05); border-radius: 10px;">
                                <strong>What to do with red flags:</strong> When you see these warnings, take extra care to verify information from multiple independent sources. Look for original documents or primary sources, check if other reputable outlets are reporting the same information, and be aware of your own biases when evaluating controversial claims.
                            </p>
                        </div>
                    `
                });
            }
            
            // Cross-Reference & Multi-Source Analysis
            dropdowns.push({
                icon: '🔄',
                title: 'Cross-Reference & Multi-Source Verification',
                preview: 'Comparative analysis across multiple news sources',
                iconColors: ['#11998e', '#38ef7d'],
                content: `
                    <div class="analysis-intro">
                        <h4>What this analysis reveals:</h4>
                        <p>One of the most effective ways to verify news is to check if multiple independent, credible sources are reporting the same information. This analysis examines whether the key claims in this article appear in other reputable outlets, whether the facts align across sources, and if there are any significant discrepancies. Stories that appear only in one source or in a cluster of ideologically aligned sources may require extra scrutiny.</p>
                    </div>
                    <div class="analysis-details">
                        <div class="metric-item">
                            <span class="metric-label">Cross-Reference Status:</span>
                            <span class="metric-value">Analysis based on single source</span>
                        </div>
                        <p style="margin-top: 20px; padding: 20px; background: rgba(79,172,254,0.1); border-radius: 10px;">
                            <strong>💡 Pro tip for readers:</strong> Always verify important news by checking 2-3 additional sources with different political perspectives. Look for original documents, official statements, or primary sources referenced in articles. Be especially cautious of stories that seem designed to provoke strong emotional reactions.
                        </p>
                        <p style="margin-top: 20px; padding: 20px; background: rgba(255,255,255,0.05); border-radius: 10px;">
                            <strong>Signs of reliable multi-source verification:</strong>
                            <br>• Story appears in outlets across the political spectrum
                            <br>• Key facts remain consistent across sources
                            <br>• Original documents or recordings are available
                            <br>• Multiple independent witnesses or experts quoted
                            <br>• Timeline of events is clear and consistent
                        </p>
                    </div>
                `
            });
            
            return dropdowns.map((dropdown, index) => `
                <div class="analysis-dropdown" style="--icon-color-1: ${dropdown.iconColors[0]}; --icon-color-2: ${dropdown.iconColors[1]};">
                    <div class="dropdown-header">
                        <div class="dropdown-icon-wrapper">
                            <div class="dropdown-icon">
                                ${dropdown.icon}
                            </div>
                            <div class="dropdown-title-section">
                                <div class="dropdown-title">${dropdown.title}</div>
                                <div class="dropdown-preview">${dropdown.preview}</div>
                            </div>
                        </div>
                        <div class="expand-icon">▼</div>
                    </div>
                    <div class="dropdown-content">
                        <div class="dropdown-body">
                            ${dropdown.content}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Helper functions
        function getTrustColor(score) {
            if (score >= 80) return '#48bb78';
            if (score >= 60) return '#ed8936';
            return '#f56565';
        }

        function getTrustLabel(score) {
            if (score >= 80) return 'HIGHLY TRUSTWORTHY';
            if (score >= 60) return 'MODERATELY TRUSTWORTHY';
            if (score >= 40) return 'QUESTIONABLE RELIABILITY';
            return 'LOW TRUST - VERIFY CAREFULLY';
        }

        function getCredibilityDescription(score) {
            if (score >= 80) return 'This source has an excellent track record of accurate reporting';
            if (score >= 60) return 'This source is generally reliable but may have occasional issues';
            if (score >= 40) return 'This source has mixed credibility and should be cross-referenced';
            return 'This source has poor credibility or is unverified';
        }

        function getScoreColor(score) {
            if (score >= 80) return '#48bb78';
            if (score >= 60) return '#ed8936';
            return '#f56565';
        }

        function getClaimClass(status) {
            if (status.toLowerCase().includes('verif')) return 'true';
            if (status.toLowerCase().includes('false')) return 'false';
            return 'unverified';
        }

        function getClaimLabel(status) {
            if (status.toLowerCase().includes('verif')) return 'VERIFIED AS TRUE';
            if (status.toLowerCase().includes('false')) return 'FALSE OR MISLEADING';
            return 'CANNOT BE VERIFIED';
        }

        function getClaimIcon(status) {
            if (status.toLowerCase().includes('verif')) return '✅';
            if (status.toLowerCase().includes('false')) return '❌';
            return '❓';
        }

        function createBiasGauge(biasData) {
            const biasScore = biasData.score || 0;
            const position = 50 + (biasScore * 5);
            
            return `
                <div class="bias-gauge">
                    <h5 style="text-align: center; color: #e2e8f0; margin-bottom: 20px;">Political Bias Spectrum Visualization</h5>
                    <div class="gauge-container">
                        <div class="gauge-marker" style="left: ${position}%;"></div>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-top: 10px; font-size: 14px;">
                        <span style="color: #3b82f6;">← Far Left</span>
                        <span style="color: #3b82f6;">Left</span>
                        <span style="color: #a78bfa;">Center</span>
                        <span style="color: #ef4444;">Right</span>
                        <span style="color: #ef4444;">Far Right →</span>
                    </div>
                    <p style="text-align: center; margin-top: 20px; color: #b0bec5; font-size: 14px;">
                        Political bias indicates the ideological perspective from which news is presented. Quality journalism can exist across the political spectrum - what matters most is transparency about perspective, factual accuracy, and fair representation of different viewpoints.
                    </p>
                </div>
            `;
        }

        function animateTrustScore(score) {
            const circle = document.getElementById('trustCircle');
            const circumference = 2 * Math.PI * 90;
            const offset = circumference - (score / 100) * circumference;
            
            setTimeout(() => {
                circle.style.strokeDashoffset = offset;
                circle.style.transition = 'stroke-dashoffset 1.5s ease-in-out';
            }, 100);
        }

        // Action functions
        window.resetAnalysis = function() {
            document.getElementById('articleUrl').value = '';
            document.getElementById('articleText').value = '';
            document.getElementById('results').classList.remove('active');
            currentAnalysisData = null;
            switchInputType('url');
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        window.shareResults = function() {
            if (!currentAnalysisData) {
                showMessage('No analysis results to share. Please analyze an article first.', 'error');
                return;
            }
            
            const shareText = `I analyzed this article with AI News Intelligence System. Trust Score: ${currentAnalysisData.results.credibility || 0}%`;
            
            if (navigator.share) {
                navigator.share({
                    title: 'AI News Analysis Results',
                    text: shareText,
                    url: window.location.href
                }).catch(err => console.log('Share failed:', err));
            } else {
                // Fallback - copy to clipboard
                const textArea = document.createElement('textarea');
                textArea.value = shareText + '\n' + window.location.href;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                showMessage('Analysis link copied to clipboard! You can now share it.', 'success');
            }
        }

        function showMessage(text, type) {
            const existing = document.querySelector('.message');
            if (existing) existing.remove();
            
            const message = document.createElement('div');
            message.className = `message ${type}`;
            message.textContent = text;
            
            document.querySelector('.input-section').after(message);
            
            setTimeout(() => {
                if (message.parentNode) {
                    message.remove();
                }
            }, 5000);
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            console.log('AI News Intelligence System initialized successfully');
            
            document.getElementById('articleUrl').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') analyzeArticle();
            });
        });
    </script>
</body>
</html>
