<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NewsVerify Pro - Enterprise News Verification Platform v2.1-FIXED</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üõ°Ô∏è</text></svg>">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
        }

        .header h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            background: linear-gradient(45deg, #fff, #e0e7ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 20px;
        }

        .enterprise-badge {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            padding: 8px 20px;
            border-radius: 25px;
            display: inline-block;
            font-weight: 600;
            font-size: 0.9rem;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .nav-bar {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 40px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .nav-links {
            display: flex;
            justify-content: center;
            gap: 30px;
            flex-wrap: wrap;
        }

        .nav-links a {
            color: white;
            text-decoration: none;
            padding: 12px 24px;
            border-radius: 15px;
            transition: all 0.3s ease;
            font-weight: 500;
            position: relative;
            overflow: hidden;
        }

        .nav-links a:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .nav-links a.active {
            background: rgba(255, 255, 255, 0.3);
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .tool-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 50px;
            box-shadow: 
                0 25px 50px rgba(0, 0, 0, 0.1),
                0 0 0 1px rgba(255, 255, 255, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.3);
            position: relative;
            overflow: hidden;
        }

        .tool-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #667eea, #764ba2, #667eea);
            background-size: 200% 100%;
            animation: gradient-flow 3s ease-in-out infinite;
        }

        @keyframes gradient-flow {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .tool-header {
            text-align: center;
            margin-bottom: 40px;
            position: relative;
        }

        .tool-header h2 {
            font-size: 2.8rem;
            color: #4a5568;
            margin-bottom: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .tool-header p {
            font-size: 1.2rem;
            color: #718096;
            margin-bottom: 20px;
        }

        /* Backend Status Indicator */
        .backend-status {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(5, 150, 105, 0.05));
            border: 2px solid rgba(16, 185, 129, 0.2);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            text-align: center;
        }

        .backend-status.connected {
            border-color: rgba(16, 185, 129, 0.3);
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.15), rgba(5, 150, 105, 0.08));
        }

        .backend-status.disconnected {
            border-color: rgba(239, 68, 68, 0.3);
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(220, 38, 38, 0.05));
        }

        .status-icon {
            font-size: 2rem;
            margin-bottom: 10px;
            display: block;
        }

        .status-text {
            font-weight: 600;
            margin-bottom: 8px;
        }

        .status-details {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .tier-selector {
            display: flex;
            gap: 40px;
            justify-content: center;
            margin-bottom: 60px;
            flex-wrap: wrap;
            padding: 30px 40px;
        }

        .tier-btn {
            background: linear-gradient(145deg, #f8fafc, #e2e8f0);
            color: #4a5568;
            border: 3px solid #e2e8f0;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.4s ease;
            border-radius: 20px;
            padding: 20px 50px 20px 35px;
            font-size: 1.1rem;
            position: relative;
            overflow: visible;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            min-width: 220px;
            text-align: center;
            margin: 20px 15px;
        }

        .tier-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .tier-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-color: #667eea;
            color: white;
            box-shadow: 
                0 8px 25px rgba(102, 126, 234, 0.3),
                0 0 0 3px rgba(102, 126, 234, 0.1);
            transform: translateY(-3px);
        }

        .tier-badge {
            position: absolute;
            top: -12px;
            right: -12px;
            background: linear-gradient(45deg, #ff4444, #ff6b6b);
            color: white;
            font-size: 0.75rem;
            padding: 8px 12px;
            border-radius: 18px;
            font-weight: bold;
            box-shadow: 0 3px 12px rgba(255, 68, 68, 0.4);
            white-space: nowrap;
            z-index: 10;
            border: 2px solid white;
        }

        .expertise-showcase {
            background: linear-gradient(145deg, rgba(102, 126, 234, 0.05), rgba(118, 75, 162, 0.03));
            border: 2px solid rgba(102, 126, 234, 0.1);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .expertise-showcase::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #667eea, #764ba2, #667eea);
            background-size: 200% 100%;
            animation: gradient-flow 3s ease-in-out infinite;
        }

        .showcase-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .showcase-header h3 {
            color: #667eea;
            font-size: 1.3rem;
            font-weight: 700;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .expertise-badge {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 6px 15px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.8rem;
            box-shadow: 0 3px 10px rgba(102, 126, 234, 0.3);
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }

        .feature-item {
            background: white;
            padding: 15px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            border: 1px solid rgba(102, 126, 234, 0.1);
            transition: all 0.3s ease;
            text-align: center;
        }

        .feature-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.15);
            border-color: rgba(102, 126, 234, 0.2);
        }

        .feature-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 10px;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        .feature-icon i {
            font-size: 1.1rem;
            color: white;
        }

        .feature-content h4 {
            color: #4a5568;
            font-size: 0.95rem;
            font-weight: 600;
            margin-bottom: 5px;
            line-height: 1.2;
        }

        .feature-content p {
            color: #6b7280;
            font-size: 0.8rem;
            line-height: 1.3;
            margin: 0;
        }

        .input-section {
            margin-bottom: 40px;
        }

        .input-tabs {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
            border-bottom: 3px solid #e2e8f0;
            position: relative;
        }

        .input-tab {
            padding: 15px 30px;
            border: none;
            background: #f8fafc;
            color: #6b7280;
            font-weight: 600;
            cursor: pointer;
            border-radius: 15px 15px 0 0;
            transition: all 0.3s ease;
            font-size: 1rem;
            border-bottom: 3px solid transparent;
        }

        .input-tab:hover {
            background: #f1f5f9;
            color: #374151;
            transform: translateY(-2px);
        }

        .input-tab.active {
            background: white;
            color: #667eea;
            border-bottom-color: #667eea;
            box-shadow: 
                0 -4px 15px rgba(0, 0, 0, 0.1),
                0 0 0 2px rgba(102, 126, 234, 0.1);
            transform: translateY(-2px);
        }

        .input-content {
            display: none;
        }

        .input-content.active {
            display: block;
            animation: fadeInUp 0.4s ease;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .input-group {
            margin-bottom: 25px;
        }

        .input-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 700;
            color: #4a5568;
            font-size: 1.1rem;
        }

        .input-group input, .input-group textarea {
            width: 100%;
            padding: 18px;
            border: 3px solid #e2e8f0;
            border-radius: 15px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: white;
            font-family: inherit;
        }

        .input-group input:focus, .input-group textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 
                0 0 0 4px rgba(102, 126, 234, 0.1),
                0 5px 15px rgba(102, 126, 234, 0.2);
            transform: translateY(-2px);
        }

        .input-group textarea {
            min-height: 140px;
            resize: vertical;
            line-height: 1.6;
        }

        .sample-articles {
            margin-bottom: 20px;
            background: rgba(102, 126, 234, 0.05);
            padding: 15px;
            border-radius: 12px;
            border: 1px solid rgba(102, 126, 234, 0.1);
        }

        .sample-articles label {
            font-size: 0.95rem;
            margin-bottom: 10px;
            font-weight: 600;
            color: #4a5568;
            display: block;
        }

        .sample-btn {
            background: linear-gradient(145deg, rgba(102, 126, 234, 0.1), rgba(102, 126, 234, 0.2));
            border: 1px solid #667eea;
            color: #667eea;
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            margin: 4px;
            transition: all 0.3s ease;
        }

        .sample-btn:hover {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .char-counter {
            text-align: right;
            font-size: 0.95rem;
            color: #6b7280;
            margin-top: 8px;
            font-weight: 500;
        }

        .char-counter.warning {
            color: #f59e0b;
            font-weight: 600;
        }

        .char-counter.error {
            color: #ef4444;
            font-weight: 700;
        }

        .button-group {
            text-align: center;
            margin-bottom: 40px;
        }

        .analyze-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 20px 50px;
            border-radius: 20px;
            font-size: 1.3rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.4s ease;
            width: 100%;
            margin-bottom: 20px;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        .analyze-btn:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(102, 126, 234, 0.4);
        }

        .analyze-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .progress-container {
            display: none;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 25px 30px;
            border-radius: 15px;
            margin: 20px 0;
            box-shadow: 
                0 15px 30px rgba(102, 126, 234, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.1);
            color: white;
            overflow: hidden;
            position: relative;
        }

        .progress-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.15), transparent);
            animation: progress-shimmer 2.5s infinite;
        }

        @keyframes progress-shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .progress-text {
            text-align: center;
            font-weight: 700;
            color: white;
            margin-bottom: 15px;
            font-size: 1.1rem;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            position: relative;
            z-index: 2;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: rgba(0, 0, 0, 0.25);
            border-radius: 15px;
            overflow: hidden;
            margin-bottom: 15px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            position: relative;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3);
            z-index: 2;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, 
                #00ff88 0%, 
                #00cc44 20%, 
                #ffaa00 40%, 
                #ff6600 70%, 
                #ff0066 100%);
            border-radius: 15px;
            transition: width 1.5s cubic-bezier(0.4, 0, 0.2, 1);
            width: 0%;
            position: relative;
            box-shadow: 0 0 20px rgba(0, 255, 136, 0.6);
            overflow: hidden;
        }

        .progress-fill::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255,255,255,0.6), 
                transparent);
            animation: progress-wave 1.5s infinite;
        }

        @keyframes progress-wave {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .progress-details {
            text-align: center;
            font-size: 0.95rem;
            color: rgba(255, 255, 255, 0.9);
            font-weight: 500;
            position: relative;
            z-index: 2;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }

        .reset-btn {
            background: linear-gradient(145deg, #6b7280, #4b5563);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 15px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
            box-shadow: 0 4px 15px rgba(107, 114, 128, 0.2);
        }

        .reset-btn:hover {
            background: linear-gradient(145deg, #4b5563, #374151);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(107, 114, 128, 0.3);
        }

        .results {
            display: none;
            margin-top: 40px;
            animation: fadeInUp 0.6s ease;
        }

        .executive-summary {
            background: linear-gradient(145deg, #f8fafc, #ffffff);
            border-radius: 25px;
            padding: 40px;
            margin-bottom: 40px;
            border: 3px solid rgba(102, 126, 234, 0.1);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }

        .executive-summary::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: linear-gradient(90deg, #667eea, #764ba2, #667eea);
            background-size: 200% 100%;
            animation: gradient-flow 3s ease-in-out infinite;
        }

        .credibility-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 20px;
        }

        .credibility-score {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .score-circle {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            font-weight: 900;
            color: white;
            box-shadow: 
                0 8px 25px rgba(0, 0, 0, 0.2),
                inset 0 2px 0 rgba(255, 255, 255, 0.3);
            position: relative;
            overflow: hidden;
        }

        .assessment-text {
            font-size: 1.5rem;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 5px;
        }

        .grade-badge {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px 24px;
            border-radius: 30px;
            font-weight: 800;
            font-size: 1.2rem;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .expandable-section {
            margin-bottom: 30px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            border: 2px solid rgba(102, 126, 234, 0.1);
        }

        .section-header {
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .section-header:hover {
            background: linear-gradient(135deg, #667eea 5%, #764ba2 95%) !important;
        }

        .section-content {
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .detailed-explanation {
            background: rgba(102, 126, 234, 0.03);
            padding: 25px;
            margin: 20px 0;
            border-radius: 15px;
            border-left: 4px solid #667eea;
            line-height: 1.8;
            color: #374151;
        }

        .methodology-box {
            background: linear-gradient(145deg, #f8fafc, #ffffff);
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
            border: 2px solid #e2e8f0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        .error-message {
            background: linear-gradient(145deg, rgba(255, 68, 68, 0.1), rgba(255, 68, 68, 0.05));
            border: 2px solid rgba(255, 68, 68, 0.3);
            color: #ff4444;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            font-weight: 600;
            text-align: center;
        }

        .error-message i {
            font-size: 2rem;
            margin-bottom: 10px;
            display: block;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slideOut {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(100%);
                opacity: 0;
            }
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2.2rem;
            }

            .tool-header h2 {
                font-size: 2.2rem;
            }

            .nav-links {
                gap: 15px;
            }

            .nav-links a {
                padding: 10px 18px;
                font-size: 0.9rem;
            }

            .tool-container {
                padding: 30px;
            }

            .tier-selector {
                flex-direction: column;
                align-items: center;
                padding: 40px 20px;
            }

            .tier-btn {
                width: 100%;
                max-width: 300px;
                margin: 20px 0;
            }

            .features-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .feature-item {
                min-width: unset;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-shield-alt"></i> NewsVerify Pro</h1>
            <p>Enterprise News Verification Platform - Integrated Backend Analysis</p>
            <div class="enterprise-badge">
                <i class="fas fa-certificate"></i> Backend-Integrated Intelligence
            </div>
        </div>

        <nav class="nav-bar">
            <div class="nav-links">
                <a href="/"><i class="fas fa-home"></i> Home</a>
                <a href="/news" class="active"><i class="fas fa-newspaper"></i> News Verification</a>
                <a href="/unified"><i class="fas fa-search"></i> Content Authenticity</a>
                <a href="/imageanalysis"><i class="fas fa-image"></i> AI Image Analysis</a>
                <a href="#mission"><i class="fas fa-bullseye"></i> Our Mission</a>
                <a href="#pricing"><i class="fas fa-tags"></i> Pricing</a>
                <a href="#contact"><i class="fas fa-envelope"></i> Contact</a>
            </div>
        </nav>

        <div class="tool-container">
            <div class="tool-header">
                <h2><i class="fas fa-newspaper"></i> NewsVerify Pro - Backend Integrated</h2>
                <p>Real-time verification using your secure Flask backend with OpenAI GPT-4 integration</p>
            </div>

            <!-- Backend Status Indicator -->
            <div class="backend-status" id="backendStatus">
                <div class="status-icon" id="statusIcon">üîÑ</div>
                <div class="status-text" id="statusText">Checking backend connection...</div>
                <div class="status-details" id="statusDetails">Establishing secure connection to analysis server</div>
            </div>

            <!-- Expertise Showcase Panel -->
            <div class="expertise-showcase">
                <div class="showcase-header">
                    <h3><i class="fas fa-award"></i> Enterprise-Grade Backend Integration</h3>
                    <div class="expertise-badge">
                        <i class="fas fa-server"></i> Flask Backend
                    </div>
                </div>
                
                <div class="features-grid">
                    <div class="feature-item">
                        <div class="feature-icon">
                            <i class="fas fa-brain"></i>
                        </div>
                        <div class="feature-content">
                            <h4>Backend AI Analysis</h4>
                            <p>Secure server-side OpenAI integration</p>
                        </div>
                    </div>
                    
                    <div class="feature-item">
                        <div class="feature-icon">
                            <i class="fas fa-shield-alt"></i>
                        </div>
                        <div class="feature-content">
                            <h4>Secure Processing</h4>
                            <p>Enterprise-grade security protocols</p>
                        </div>
                    </div>
                    
                    <div class="feature-item">
                        <div class="feature-icon">
                            <i class="fas fa-cogs"></i>
                        </div>
                        <div class="feature-content">
                            <h4>Pattern Analysis</h4>
                            <p>Multi-tier verification algorithms</p>
                        </div>
                    </div>
                    
                    <div class="feature-item">
                        <div class="feature-icon">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <div class="feature-content">
                            <h4>Real-time Scoring</h4>
                            <p>Dynamic credibility assessment</p>
                        </div>
                    </div>
                    
                    <div class="feature-item">
                        <div class="feature-icon">
                            <i class="fas fa-database"></i>
                        </div>
                        <div class="feature-content">
                            <h4>Source Database</h4>
                            <p>500+ verified news sources</p>
                        </div>
                    </div>
                    
                    <div class="feature-item">
                        <div class="feature-icon">
                            <i class="fas fa-file-contract"></i>
                        </div>
                        <div class="feature-content">
                            <h4>Professional Reports</h4>
                            <p>Institutional documentation</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="tier-selector">
                <button class="tier-btn active" id="freeBtn" onclick="selectTier('free')">
                    üÜì Standard Analysis
                    <span class="tier-badge" id="freeBadge">Pattern-Based</span>
                </button>
                <button class="tier-btn" id="premiumBtn" onclick="selectTier('premium')">
                    ‚≠ê Premium Analysis
                    <span class="tier-badge" id="premiumBadge">OpenAI Enhanced</span>
                </button>
            </div>

            <div class="input-section">
                <div class="input-tabs">
                    <button class="input-tab active" onclick="switchInputType('text')">üìù Paste Content</button>
                    <button class="input-tab" onclick="switchInputType('url')">üîó Analyze URL</button>
                </div>
                
                <div class="sample-articles">
                    <label>üìö Demo Content Library - Test Backend Integration:</label>
                    <div>
                        <button class="sample-btn" onclick="loadSample('reliable')">üì∞ Verified News Source</button>
                        <button class="sample-btn" onclick="loadSample('biased')">‚öñÔ∏è Bias Analysis Example</button>
                        <button class="sample-btn" onclick="loadSample('fake')">‚ùå Misinformation Sample</button>
                        <button class="sample-btn" onclick="loadSample('mixed')">ü§î Mixed Credibility Case</button>
                    </div>
                </div>
                
                <div class="input-content active" id="textInput">
                    <div class="input-group">
                        <label for="news-text"><i class="fas fa-file-text"></i> News Article Content or Claim</label>
                        <textarea id="news-text" placeholder="Enter news article content, claims, or statements for comprehensive backend verification analysis. Our secure Flask server with OpenAI integration will assess credibility, detect bias patterns, verify sources, and provide professional-grade insights..." oninput="updateCharCount()"></textarea>
                        <div class="char-counter" id="charCounter">0 characters</div>
                    </div>
                </div>
                
                <div class="input-content" id="urlInput">
                    <div class="input-group">
                        <label for="news-url"><i class="fas fa-link"></i> News Article URL</label>
                        <input type="url" id="news-url" placeholder="https://example.com/news-article-to-verify">
                        <small style="color: #6b7280; margin-top: 8px; display: block; font-weight: 500;">
                            <i class="fas fa-info-circle"></i> Backend will extract and analyze content automatically
                        </small>
                    </div>
                </div>
            </div>

            <div class="button-group">
                <button class="analyze-btn" onclick="analyzeNewsWithBackend()" id="analyzeButton">
                    <i class="fas fa-search"></i> Start Backend Analysis
                </button>
                
                <div class="progress-container" id="progressContainer">
                    <div class="progress-text" id="progressText">Connecting to backend...</div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <div class="progress-details" id="progressDetails">Establishing secure connection...</div>
                </div>
                
                <button class="reset-btn" onclick="resetForm()">
                    <i class="fas fa-undo"></i> Reset Analysis
                </button>
            </div>

            <div class="results" id="results">
                <!-- Results will be populated here -->
            </div>
        </div>
    </div>

    <script>
        console.log('NewsVerify Pro v2.1 - Backend Integrated - FIXED');
        
        let currentInputType = 'text';
        let currentTier = 'free';
        let lastAnalysisData = null;
        let backendConnected = false;

        // Initialize and check backend connection
        document.addEventListener('DOMContentLoaded', function() {
            updateCharCount();
            checkBackendConnection();
        });

        // Check backend connection
        async function checkBackendConnection() {
            try {
                console.log('Checking backend connection...');
                const response = await fetch('/api/health');
                
                if (response.ok) {
                    const healthData = await response.json();
                    backendConnected = true;
                    updateBackendStatus('connected', healthData);
                } else {
                    throw new Error(`Backend returned ${response.status}`);
                }
            } catch (error) {
                console.error('Backend connection failed:', error);
                backendConnected = false;
                updateBackendStatus('disconnected', null);
            }
        }

        // Update backend status display
        function updateBackendStatus(status, healthData) {
            const statusElement = document.getElementById('backendStatus');
            const iconElement = document.getElementById('statusIcon');
            const textElement = document.getElementById('statusText');
            const detailsElement = document.getElementById('statusDetails');
            
            if (status === 'connected') {
                statusElement.className = 'backend-status connected';
                iconElement.textContent = '‚úÖ';
                textElement.textContent = 'Backend Connected & Ready';
                
                const openaiStatus = healthData?.openai_api ? 'OpenAI Available' : 'Pattern Analysis Only';
                const newsApiStatus = healthData?.newsapi ? 'News API Enabled' : 'Basic URL Processing';
                detailsElement.textContent = `${openaiStatus} | ${newsApiStatus} | Version: ${healthData?.version || 'Professional'}`;
                
                // Update tier availability
                updateTierAvailability(healthData?.openai_api === 'connected');
            } else {
                statusElement.className = 'backend-status disconnected';
                iconElement.textContent = '‚ùå';
                textElement.textContent = 'Backend Connection Failed';
                detailsElement.textContent = 'Please check that your Flask server is running on the correct port';
                
                // Disable premium tier if backend unavailable
                updateTierAvailability(false);
            }
        }

        // Update tier availability based on backend capabilities
        function updateTierAvailability(openaiAvailable) {
            const premiumBtn = document.getElementById('premiumBtn');
            const premiumBadge = document.getElementById('premiumBadge');
            
            if (openaiAvailable) {
                premiumBtn.style.opacity = '1';
                premiumBtn.style.cursor = 'pointer';
                premiumBadge.textContent = 'OpenAI Enhanced';
                premiumBadge.style.background = 'linear-gradient(45deg, #10b981, #059669)';
            } else {
                premiumBtn.style.opacity = '0.6';
                premiumBtn.style.cursor = 'not-allowed';
                premiumBadge.textContent = 'Requires API Key';
                premiumBadge.style.background = 'linear-gradient(45deg, #f59e0b, #d97706)';
            }
        }

        // FIXED: Main analysis function - calls your backend
        async function analyzeNewsWithBackend() {
            const newsText = document.getElementById('news-text').value.trim();
            const newsUrl = document.getElementById('news-url').value.trim();
            
            if (!newsText && !newsUrl) {
                alert('Please provide content or URL to analyze');
                return;
            }

            if (!backendConnected) {
                alert('Backend connection failed. Please ensure your Flask server is running.');
                return;
            }

            showProgress();
            document.getElementById('results').style.display = 'none';

            try {
                updateProgress(25, 'üîó Connecting to Backend...', 'Establishing secure connection...');
                await new Promise(resolve => setTimeout(resolve, 800));
                
                updateProgress(60, 'üéØ Backend Processing...', `Running ${currentTier} tier analysis...`);
                
                // Call your backend API
                const analysisResult = await callBackendAPI(newsText, newsUrl);
                
                updateProgress(90, 'üìä Finalizing Results...', 'Generating comprehensive report...');
                await new Promise(resolve => setTimeout(resolve, 500));

                updateProgress(100, '‚úÖ Analysis Complete!', 'Results ready...');
                
                lastAnalysisData = analysisResult;
                
                setTimeout(() => {
                    hideProgress();
                    displayEnhancedResults(analysisResult);
                }, 800);

            } catch (error) {
                console.error('Backend analysis failed:', error);
                hideProgress();
                showError(`Backend analysis failed: ${error.message}`);
            }
        }

        // FIXED: Call your backend API with proper error handling
        async function callBackendAPI(content, url) {
            try {
                const requestData = {
                    content: content,
                    url: url,
                    tier: currentTier
                };

                console.log('Calling backend with:', requestData);

                const response = await fetch('/api/analyze-news', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(requestData)
                });

                if (!response.ok) {
                    const errorText = await response.text();
                    console.error('Backend response error:', errorText);
                    throw new Error(`Backend API error: ${response.status} ${response.statusText}`);
                }

                // FIXED: Check if response has content before parsing JSON
                const responseText = await response.text();
                if (!responseText) {
                    throw new Error('Empty response from backend');
                }

                let data;
                try {
                    data = JSON.parse(responseText);
                } catch (parseError) {
                    console.error('JSON parse error:', parseError);
                    console.error('Response text:', responseText);
                    throw new Error('Invalid JSON response from backend');
                }

                console.log('Backend response:', data);
                return data;
            } catch (error) {
                console.error('Backend API call failed:', error);
                throw error;
            }
        }

        // Display enhanced results from your backend
        function displayEnhancedResults(analysisData) {
            const results = document.getElementById('results');
            results.style.display = 'block';

            // Extract data from your backend response format
            const credibilityScore = analysisData.credibility_score || 75;
            const grade = analysisData.credibility_grade || 'B+';
            const assessment = analysisData.credibility_assessment || 'Analysis completed';
            const analysisMethod = analysisData.analysis_method || 'backend_analysis';
            const tier = analysisData.tier || currentTier;
            
            // AI Detection data
            const aiData = analysisData.ai_detection || {};
            const aiProbability = aiData.ai_probability || 20;
            
            // Bias analysis data
            const biasData = analysisData.bias_analysis || {};
            const biasScore = biasData.bias_score || 0;
            const biasDirection = biasData.bias_direction || 'center';
            
            // Source analysis data
            const sourceData = analysisData.source_analysis || {};
            const sourceCredibility = sourceData.source_credibility || 70;
            
            // Fact checking data
            const factData = analysisData.fact_check || {};
            const factualAccuracy = factData.factual_accuracy || 75;
            
            // Final scoring
            const finalScoring = analysisData.final_scoring || {};
            const overallCredibility = finalScoring.overall_credibility || credibilityScore;
            const riskAssessment = finalScoring.risk_assessment || 'moderate';

            const scoreColor = credibilityScore >= 80 ? '#059669' : credibilityScore >= 60 ? '#f59e0b' : '#ef4444';

            results.innerHTML = `
                <div class="executive-summary">
                    <div class="credibility-header">
                        <div class="credibility-score">
                            <div class="score-circle" style="background: ${scoreColor};">
                                ${credibilityScore}
                            </div>
                            <div>
                                <div class="assessment-text" style="color: ${scoreColor};">
                                    ${assessment}
                                </div>
                                <div style="font-size: 1.1rem; opacity: 0.8; margin-top: 5px;">
                                    <strong>Grade: ${grade}</strong> | Method: ${analysisMethod.replace('_', ' ').toUpperCase()}
                                </div>
                            </div>
                        </div>
                        <div class="grade-badge">
                            ${tier === 'free' ? 'üÜì Standard Analysis' : '‚≠ê Premium Analysis'}
                            (Backend Integrated)
                        </div>
                    </div>
                    
                    <div style="background: linear-gradient(145deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.05)); padding: 25px; border-radius: 20px; margin: 25px 0; border: 2px solid rgba(102, 126, 234, 0.1);">
                        <h4 style="color: #667eea; margin-bottom: 15px; display: flex; align-items: center; gap: 10px;">
                            <i class="fas fa-server"></i> Backend Analysis Summary
                        </h4>
                        <p style="color: #374151; font-size: 1.15rem; line-height: 1.7; margin-bottom: 15px;">
                            ${analysisData.executive_summary?.summary_text || 
                                `Backend analysis completed using ${analysisMethod.replace('_', ' ')} with ${tier} tier verification. ` +
                                `Overall credibility score: ${overallCredibility}/100 with ${riskAssessment} risk assessment.`
                            }
                        </p>
                        
                        <div style="background: rgba(16, 185, 129, 0.1); padding: 15px; border-radius: 10px; border-left: 4px solid #10b981;">
                            <strong style="color: #10b981;">‚úÖ Real Backend Analysis Complete:</strong> 
                            ${analysisData.openai_analysis ? 'OpenAI GPT-4 enhanced analysis' : 'Pattern-based comprehensive verification'} 
                            with ${analysisData.api_configuration?.enhanced_features ? 'premium' : 'standard'} feature set.
                        </div>
                        
                        ${generateReportButtons()}
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 20px; margin-top: 25px;">
                        <div style="background: linear-gradient(145deg, rgba(102, 126, 234, 0.1), rgba(102, 126, 234, 0.05)); padding: 25px; border-radius: 20px; text-align: center; border: 2px solid rgba(102, 126, 234, 0.1);">
                            <div style="font-size: 2.5rem; font-weight: 900; color: ${scoreColor}; margin-bottom: 8px;">${credibilityScore}</div>
                            <div style="font-size: 0.95rem; opacity: 0.8; font-weight: 600;">Credibility Score</div>
                            <div style="font-size: 0.8rem; color: #6b7280; margin-top: 5px;">${grade} Grade</div>
                        </div>
                        <div style="background: linear-gradient(145deg, rgba(102, 126, 234, 0.1), rgba(102, 126, 234, 0.05)); padding: 25px; border-radius: 20px; text-align: center; border: 2px solid rgba(102, 126, 234, 0.1);">
                            <div style="font-size: 2.5rem; font-weight: 900; color: #667eea; margin-bottom: 8px;">${aiProbability}%</div>
                            <div style="font-size: 0.95rem; opacity: 0.8; font-weight: 600;">AI Probability</div>
                            <div style="font-size: 0.8rem; color: #6b7280; margin-top: 5px;">${aiProbability < 30 ? 'Likely Human' : aiProbability < 70 ? 'Mixed' : 'Likely AI'}</div>
                        </div>
                        <div style="background: linear-gradient(145deg, rgba(102, 126, 234, 0.1), rgba(102, 126, 234, 0.05)); padding: 25px; border-radius: 20px; text-align: center; border: 2px solid rgba(102, 126, 234, 0.1);">
                            <div style="font-size: 2.5rem; font-weight: 900; color: #764ba2; margin-bottom: 8px;">${Math.abs(biasScore)}</div>
                            <div style="font-size: 0.95rem; opacity: 0.8; font-weight: 600;">Bias Score</div>
                            <div style="font-size: 0.8rem; color: #6b7280; margin-top: 5px;">${biasDirection}</div>
                        </div>
                        <div style="background: linear-gradient(145deg, rgba(102, 126, 234, 0.1), rgba(102, 126, 234, 0.05)); padding: 25px; border-radius: 20px; text-align: center; border: 2px solid rgba(102, 126, 234, 0.1);">
                            <div style="font-size: 2.5rem; font-weight: 900; color: #059669; margin-bottom: 8px;">${factualAccuracy}</div>
                            <div style="font-size: 0.95rem; opacity: 0.8; font-weight: 600;">Fact Accuracy</div>
                            <div style="font-size: 0.8rem; color: #6b7280; margin-top: 5px;">${factualAccuracy > 80 ? 'High' : factualAccuracy > 60 ? 'Good' : 'Moderate'}</div>
                        </div>
                    </div>
                </div>

                <div class="expandable-sections">
                    ${generateAIAnalysisSection(analysisData)}
                    ${generateBiasAnalysisSection(analysisData)}
                    ${generateSourceAnalysisSection(analysisData)}
                    ${generateFactCheckSection(analysisData)}
                    ${generateBackendMethodologySection(analysisData)}
                </div>
            `;
        }

        function generateReportButtons() {
            return `
                <div style="background: linear-gradient(145deg, #f8fafc, #ffffff); padding: 20px; border-radius: 15px; margin-top: 15px; border: 2px solid #e2e8f0;">
                    <h4 style="color: #667eea; margin-bottom: 15px; display: flex; align-items: center; gap: 10px;">
                        <i class="fas fa-file-alt"></i> Professional Report Generation
                    </h4>
                    <p style="color: #4a5568; margin-bottom: 15px;">Generate comprehensive reports using backend analysis data for institutional use.</p>
                    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                        <button onclick="generateReport('executive')" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 10px 20px; border-radius: 10px; font-weight: 600; cursor: pointer; transition: all 0.3s ease;">
                            <i class="fas fa-chart-bar"></i> Executive Summary
                        </button>
                        <button onclick="generateReport('detailed')" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; border: none; padding: 10px 20px; border-radius: 10px; font-weight: 600; cursor: pointer; transition: all 0.3s ease;">
                            <i class="fas fa-file-pdf"></i> Technical Report
                        </button>
                        <button onclick="generateReport('compliance')" style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); color: white; border: none; padding: 10px 20px; border-radius: 10px; font-weight: 600; cursor: pointer; transition: all 0.3s ease;">
                            <i class="fas fa-shield-alt"></i> Compliance Report
                        </button>
                    </div>
                </div>
            `;
        }

        // Enhanced section generators using backend data
        function generateAIAnalysisSection(data) {
            const aiData = data.ai_detection || {};
            const aiProbability = aiData.ai_probability || 20;
            const aiConfidence = aiData.ai_confidence || 85;
            const aiExplanation = aiData.ai_explanation || 'Pattern-based analysis completed';
            
            return `
                <div class="expandable-section">
                    <div class="section-header" style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); color: white; padding: 20px; cursor: pointer;" onclick="toggleSection('ai')">
                        <h3 style="margin: 0; display: flex; align-items: center; justify-content: space-between;">
                            <span><i class="fas fa-robot"></i> AI Content Detection (Backend)</span>
                            <span id="ai-toggle" style="font-size: 1.2rem;">‚ñº</span>
                        </h3>
                    </div>
                    <div class="section-content" id="ai-content" style="padding: 30px; display: none;">
                        <div style="text-align: center; padding: 20px; background: rgba(245, 158, 11, 0.1); border-radius: 15px; margin-bottom: 25px;">
                            <div style="font-size: 2.5rem; font-weight: 900; color: #d97706; margin-bottom: 5px;">${aiProbability}%</div>
                            <div style="font-weight: 600; color: #4a5568; margin-bottom: 10px;">AI Generation Probability</div>
                            <div style="font-size: 1.1rem; font-weight: 600; color: ${aiProbability < 30 ? '#059669' : aiProbability < 70 ? '#f59e0b' : '#ef4444'};">
                                ${aiProbability < 30 ? '‚úÖ Likely Human-Generated' : aiProbability < 70 ? '‚ö†Ô∏è Mixed Signals' : 'ü§ñ Likely AI-Generated'}
                            </div>
                            <div style="margin-top: 10px; font-size: 0.9rem; color: #6b7280;">
                                Confidence: ${aiConfidence}% | Method: ${data.openai_analysis ? 'OpenAI Enhanced' : 'Pattern Analysis'}
                            </div>
                        </div>
                        <div class="detailed-explanation">
                            <p><strong>Backend Analysis:</strong> ${aiExplanation}</p>
                            <p><strong>Analysis Method:</strong> ${data.analysis_method ? data.analysis_method.replace('_', ' ').toUpperCase() : 'Backend Pattern Analysis'}</p>
                        </div>
                    </div>
                </div>
            `;
        }

        function generateBiasAnalysisSection(data) {
            const biasData = data.bias_analysis || {};
            const biasScore = biasData.bias_score || 0;
            const biasDirection = biasData.bias_direction || 'center';
            const biasConfidence = biasData.bias_confidence || 75;
            const biasExplanation = biasData.bias_explanation || 'Political bias analysis completed';
            
            return `
                <div class="expandable-section">
                    <div class="section-header" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; cursor: pointer;" onclick="toggleSection('bias')">
                        <h3 style="margin: 0; display: flex; align-items: center; justify-content: space-between;">
                            <span><i class="fas fa-balance-scale"></i> Political Bias Analysis (Backend)</span>
                            <span id="bias-toggle" style="font-size: 1.2rem;">‚ñº</span>
                        </h3>
                    </div>
                    <div class="section-content" id="bias-content" style="padding: 30px; display: none;">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 25px;">
                            <div style="text-align: center; padding: 20px; background: rgba(16, 185, 129, 0.1); border-radius: 15px;">
                                <div style="font-size: 2rem; font-weight: 900; color: #059669; margin-bottom: 5px;">${sourceCredibility}</div>
                                <div style="font-weight: 600; color: #4a5568;">Source Credibility</div>
                            </div>
                            <div style="text-align: center; padding: 20px; background: rgba(16, 185, 129, 0.1); border-radius: 15px;">
                                <div style="font-size: 2rem; font-weight: 900; color: #10b981; margin-bottom: 5px;">${editorialQuality}</div>
                                <div style="font-weight: 600; color: #4a5568;">Editorial Quality</div>
                            </div>
                            <div style="text-align: center; padding: 20px; background: rgba(16, 185, 129, 0.1); border-radius: 15px;">
                                <div style="font-size: 2rem; font-weight: 900; color: #059669; margin-bottom: 5px;">${professionalStandards}</div>
                                <div style="font-weight: 600; color: #4a5568;">Professional Standards</div>
                            </div>
                        </div>
                        <div class="detailed-explanation">
                            <p><strong>Backend Source Assessment:</strong> Comprehensive analysis of publication standards and editorial quality.</p>
                            <p><strong>Verification Status:</strong> ${data.source_verification?.status || 'Analysis completed'}</p>
                        </div>
                    </div>
                </div>
            `;
        }

        function generateFactCheckSection(data) {
            const factData = data.fact_check || {};
            const factualAccuracy = factData.factual_accuracy || 75;
            const verifiableClaims = factData.verifiable_claims || 2;
            const contradictionFlags = factData.contradiction_flags || 0;
            const factSummary = factData.fact_check_summary || 'Fact-checking analysis completed';
            
            return `
                <div class="expandable-section">
                    <div class="section-header" style="background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); color: white; padding: 20px; cursor: pointer;" onclick="toggleSection('fact')">
                        <h3 style="margin: 0; display: flex; align-items: center; justify-content: space-between;">
                            <span><i class="fas fa-search-plus"></i> Fact-Check Results (Backend)</span>
                            <span id="fact-toggle" style="font-size: 1.2rem;">‚ñº</span>
                        </h3>
                    </div>
                    <div class="section-content" id="fact-content" style="padding: 30px; display: none;">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 20px; margin-bottom: 25px;">
                            <div style="text-align: center; padding: 20px; background: rgba(239, 68, 68, 0.1); border-radius: 15px;">
                                <div style="font-size: 2.5rem; font-weight: 900; color: #dc2626; margin-bottom: 5px;">${factualAccuracy}</div>
                                <div style="font-weight: 600; color: #4a5568;">Accuracy Score</div>
                            </div>
                            <div style="text-align: center; padding: 20px; background: rgba(239, 68, 68, 0.1); border-radius: 15px;">
                                <div style="font-size: 2.5rem; font-weight: 900; color: #dc2626; margin-bottom: 5px;">${verifiableClaims}</div>
                                <div style="font-weight: 600; color: #4a5568;">Verified Claims</div>
                            </div>
                            <div style="text-align: center; padding: 20px; background: rgba(239, 68, 68, 0.1); border-radius: 15px;">
                                <div style="font-size: 2.5rem; font-weight: 900; color: #dc2626; margin-bottom: 5px;">${contradictionFlags}</div>
                                <div style="font-weight: 600; color: #4a5568;">Red Flags</div>
                            </div>
                        </div>
                        <div class="detailed-explanation">
                            <p><strong>Backend Fact-Check Summary:</strong> ${factSummary}</p>
                            <p><strong>Verification Status:</strong> ${contradictionFlags === 0 ? 'No contradictions detected' : `${contradictionFlags} potential issues identified`}</p>
                        </div>
                    </div>
                </div>
            `;
        }

        function generateBackendMethodologySection(data) {
            const analysisMethod = data.analysis_method || 'backend_analysis';
            const tier = data.tier || currentTier;
            const openaiAnalysis = data.openai_analysis || false;
            const confidence = data.confidence_metrics?.overall_confidence || 85;
            
            return `
                <div class="expandable-section">
                    <div class="section-header" style="background: linear-gradient(135deg, #6b7280 0%, #4b5563 100%); color: white; padding: 20px; cursor: pointer;" onclick="toggleSection('methodology')">
                        <h3 style="margin: 0; display: flex; align-items: center; justify-content: space-between;">
                            <span><i class="fas fa-server"></i> Backend Analysis Methodology</span>
                            <span id="methodology-toggle" style="font-size: 1.2rem;">‚ñº</span>
                        </h3>
                    </div>
                    <div class="section-content" id="methodology-content" style="padding: 30px; display: none;">
                        <div class="methodology-box">
                            <h4 style="color: #667eea; margin-bottom: 15px;"><i class="fas fa-flask"></i> Backend Framework</h4>
                            <p><strong>Analysis Method:</strong> ${analysisMethod.replace('_', ' ').toUpperCase()}</p>
                            <p><strong>Tier Level:</strong> ${tier === 'premium' ? 'Premium with OpenAI enhancement' : 'Standard pattern-based analysis'}</p>
                            <p><strong>OpenAI Integration:</strong> ${openaiAnalysis ? '‚úÖ GPT-4 Enhanced Analysis' : '‚ùå Pattern Analysis Only'}</p>
                            <p><strong>Backend Processing:</strong> Secure Flask server with real-time analysis</p>
                            <p><strong>Overall Confidence:</strong> ${confidence}%</p>
                        </div>
                        <div class="methodology-box">
                            <h4 style="color: #667eea; margin-bottom: 15px;"><i class="fas fa-chart-bar"></i> Backend Quality Assurance</h4>
                            <p><strong>API Configuration:</strong> ${data.api_configuration?.openai_available ? 'OpenAI Available' : 'Pattern Analysis Only'}</p>
                            <p><strong>Processing Pipeline:</strong> Multi-stage verification with error handling</p>
                            <p><strong>Data Security:</strong> Server-side processing with secure API key management</p>
                            <p><strong>Response Format:</strong> Structured JSON with comprehensive scoring</p>
                        </div>
                    </div>
                </div>
            `;
        }

        // Utility functions
        function selectTier(tier) {
            currentTier = tier;
            
            document.querySelectorAll('.tier-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            const selectedBtn = document.getElementById(tier === 'free' ? 'freeBtn' : 'premiumBtn');
            selectedBtn.classList.add('active');

            const analyzeBtn = document.getElementById('analyzeButton');
            if (currentTier === 'free') {
                analyzeBtn.innerHTML = '<i class="fas fa-search"></i> Start Standard Backend Analysis';
                analyzeBtn.style.background = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
            } else {
                analyzeBtn.innerHTML = '<i class="fas fa-star"></i> Start Premium Backend Analysis';
                analyzeBtn.style.background = 'linear-gradient(135deg, #ff6b6b 0%, #ff8e53 100%)';
            }
        }

        function switchInputType(type) {
            currentInputType = type;
            
            document.querySelectorAll('.input-tab').forEach((tab, index) => {
                tab.classList.remove('active');
                if ((type === 'text' && index === 0) || (type === 'url' && index === 1)) {
                    tab.classList.add('active');
                }
            });
            
            document.querySelectorAll('.input-content').forEach(content => {
                content.classList.remove('active');
            });
            
            const targetContent = document.getElementById(type + 'Input');
            if (targetContent) {
                setTimeout(() => {
                    targetContent.classList.add('active');
                }, 150);
            }
        }

        function loadSample(type) {
            const samples = {
                reliable: `WASHINGTON (Associated Press) ‚Äî The Federal Reserve raised its benchmark interest rate by 0.25 percentage points Wednesday, bringing it to a 22-year high of 5.25%-5.5% as the central bank continues its efforts to combat inflation. The decision was unanimous among voting members of the Federal Open Market Committee.

Fed Chair Jerome Powell indicated during his post-meeting press conference that future policy decisions will depend on incoming economic data. "We remain data-dependent and prepared to adjust our approach as conditions warrant," Powell stated, emphasizing the Fed's commitment to achieving price stability while supporting maximum employment.`,
                
                biased: `Federal Reserve's Latest Rate Hike Signals Continued Economic Pressure on American Families

The Federal Reserve announced another devastating quarter-point interest rate increase Wednesday, raising serious concerns among economists about the cumulative impact on household budgets and economic recovery. The shocking decision brings rates to their highest level since 2001, intensifying financial pressures on borrowers across multiple sectors.

This latest move particularly affects struggling middle-income families seeking homeownership, as mortgage rates have climbed above 7% for the first time in two decades.`,
                
                fake: `EXCLUSIVE: Federal Reserve Documents Reveal Coordinated Market Manipulation Strategy

Internal Federal Reserve communications obtained through Freedom of Information Act requests reveal concerning coordination between Fed officials and major Wall Street institutions ahead of recent interest rate decisions, according to financial transparency advocates.

The documents, reviewed by independent economists, suggest that select financial institutions received advance guidance on rate timing, potentially creating unfair trading advantages worth billions.`,
                
                mixed: `Fed Raises Rates to 22-Year High Amid Growing Economic Uncertainty

The Federal Reserve increased its benchmark interest rate by 0.25 percentage points yesterday, continuing its monetary tightening cycle despite mixed signals from economic indicators. The rate now sits at 5.25%-5.5%, representing the highest level since 2001.

Economic analysts remain divided on the effectiveness of the Fed's approach, with some questioning the timing of the move.`
            };
            
            const textarea = document.getElementById('news-text');
            textarea.value = samples[type];
            updateCharCount();
            
            if (currentInputType !== 'text') {
                switchInputType('text');
            }
        }

        function updateCharCount() {
            const textarea = document.getElementById('news-text');
            const counter = document.getElementById('charCounter');
            const length = textarea.value.length;
            
            counter.textContent = `${length.toLocaleString()} characters`;
            
            if (length > 5000) {
                counter.className = 'char-counter error';
                counter.textContent += ' (‚ö†Ô∏è Too long - may affect accuracy)';
            } else if (length > 3000) {
                counter.className = 'char-counter warning';
                counter.textContent += ' (‚ö° Optimal range: 500-3000 characters)';
            } else if (length > 100) {
                counter.className = 'char-counter';
                counter.textContent += ' (‚úÖ Good length for analysis)';
            } else if (length > 0) {
                counter.className = 'char-counter';
                counter.textContent += ' (üìù Keep typing...)';
            } else {
                counter.className = 'char-counter';
            }
        }

        function resetForm() {
            document.getElementById('news-text').value = '';
            document.getElementById('news-url').value = '';
            document.getElementById('results').style.display = 'none';
            hideProgress();

            updateCharCount();
            
            if (currentInputType !== 'text') {
                switchInputType('text');
            }
            
            const resetBtn = document.querySelector('.reset-btn');
            const originalText = resetBtn.innerHTML;
            resetBtn.innerHTML = '<i class="fas fa-check"></i> Reset Complete';
            resetBtn.style.background = 'linear-gradient(145deg, #10b981, #059669)';
            
            setTimeout(() => {
                resetBtn.innerHTML = originalText;
                resetBtn.style.background = 'linear-gradient(145deg, #6b7280, #4b5563)';
            }, 1500);
        }

        function updateProgress(percentage, text, detail = '') {
            const progressFill = document.getElementById('progressFill');
            const progressText = document.getElementById('progressText');
            const progressDetails = document.getElementById('progressDetails');
            
            progressFill.style.width = percentage + '%';
            progressText.textContent = text;
            progressDetails.textContent = detail;
        }

        function showProgress() {
            const progressContainer = document.getElementById('progressContainer');
            progressContainer.style.display = 'block';
            updateProgress(0, 'Initializing backend connection...', 'Preparing secure analysis...');
        }

        function hideProgress() {
            const progressContainer = document.getElementById('progressContainer');
            progressContainer.style.display = 'none';
        }

        function showError(message) {
            const results = document.getElementById('results');
            results.style.display = 'block';
            results.innerHTML = `
                <div class="error-message">
                    <i class="fas fa-exclamation-triangle"></i>
                    <h3>Backend Analysis Error</h3>
                    <p>${message}</p>
                    <p style="margin-top: 15px; font-size: 0.9rem; opacity: 0.8;">
                        Please ensure your Flask server is running and accessible.
                    </p>
                </div>
            `;
        }

        function toggleSection(sectionName) {
            const content = document.getElementById(sectionName + '-content');
            const toggle = document.getElementById(sectionName + '-toggle');
            
            if (content.style.display === 'none') {
                content.style.display = 'block';
                toggle.textContent = '‚ñ≤';
            } else {
                content.style.display = 'none';
                toggle.textContent = '‚ñº';
            }
        }

        // Report generation using backend data
        function generateReport(reportType) {
            if (!lastAnalysisData) {
                alert('Please run an analysis first before generating reports.');
                return;
            }

            const timestamp = new Date().toLocaleDateString();
            const analysisTime = new Date().toLocaleString();
            
            let reportContent = '';
            let fileName = '';
            
            const credibilityScore = lastAnalysisData.credibility_score || 75;
            const grade = lastAnalysisData.credibility_grade || 'B+';
            const assessment = lastAnalysisData.credibility_assessment || 'Analysis completed';
            const analysisMethod = lastAnalysisData.analysis_method || 'backend_analysis';
            const tier = lastAnalysisData.tier || currentTier;
            
            switch(reportType) {
                case 'executive':
                    fileName = `NewsVerify_Backend_Executive_${timestamp.replace(/\//g, '-')}.txt`;
                    reportContent = `
NEWSVERIFY PRO - BACKEND INTEGRATED EXECUTIVE SUMMARY
===================================================

Analysis Timestamp: ${analysisTime}
Analysis Method: ${analysisMethod.replace('_', ' ').toUpperCase()}
Tier Level: ${tier.toUpperCase()}
Backend Integration: ‚úÖ Flask Server
OpenAI Enhancement: ${lastAnalysisData.openai_analysis ? '‚úÖ Enabled' : '‚ùå Pattern Analysis Only'}

EXECUTIVE SUMMARY
=================
${lastAnalysisData.executive_summary?.summary_text || 
  `Backend analysis completed with ${credibilityScore}/100 credibility score (Grade: ${grade}). ${assessment} using ${analysisMethod.replace('_', ' ')} methodology.`}

KEY FINDINGS
============
‚Ä¢ Overall Credibility Score: ${credibilityScore}/100 (${assessment})
‚Ä¢ Quality Grade: ${grade}
‚Ä¢ AI Detection: ${lastAnalysisData.ai_detection?.ai_probability || 20}% probability
‚Ä¢ Political Bias: ${lastAnalysisData.bias_analysis?.bias_direction || 'Center'} (${Math.abs(lastAnalysisData.bias_analysis?.bias_score || 0)}% intensity)
‚Ä¢ Source Credibility: ${lastAnalysisData.source_analysis?.source_credibility || 70}/100
‚Ä¢ Factual Accuracy: ${lastAnalysisData.fact_check?.factual_accuracy || 75}/100

BACKEND ANALYSIS DETAILS
========================
‚Ä¢ Processing Method: ${analysisMethod.replace('_', ' ').toUpperCase()}
‚Ä¢ API Integration: ${lastAnalysisData.api_configuration?.openai_available ? 'OpenAI Available' : 'Pattern Analysis Only'}
‚Ä¢ Confidence Level: ${lastAnalysisData.confidence_metrics?.overall_confidence || 85}%
‚Ä¢ Analysis Depth: ${lastAnalysisData.confidence_metrics?.analysis_depth || 'Standard'}

RISK ASSESSMENT
===============
Overall Risk Level: ${lastAnalysisData.final_scoring?.risk_assessment?.toUpperCase() || 'MODERATE'}
Institutional Suitability: ${lastAnalysisData.final_scoring?.institutional_suitability?.replace('_', ' ').toUpperCase() || 'REVIEW REQUIRED'}

RECOMMENDATIONS
===============
${lastAnalysisData.executive_summary?.recommendation || 'Standard editorial review recommended before institutional use.'}

---
Report generated by NewsVerify Pro Backend Integration
Analysis ID: ${lastAnalysisData.analysis_id || 'NV-' + Date.now()}
Backend Server: Flask with Enhanced Analysis Pipeline`;
                    break;
                    
                case 'detailed':
                    fileName = `NewsVerify_Backend_Technical_${timestamp.replace(/\//g, '-')}.txt`;
                    reportContent = `
NEWSVERIFY PRO - BACKEND TECHNICAL ANALYSIS REPORT
==================================================

Generated: ${analysisTime}
Backend Framework: Flask Server with NewsVerify Pro Integration
Analysis Pipeline: ${analysisMethod.replace('_', ' ').toUpperCase()}
Processing Tier: ${tier.toUpperCase()}
API Integration Status: ${lastAnalysisData.api_configuration?.openai_available ? 'OpenAI GPT-4 Enhanced' : 'Pattern Analysis'}

[Full technical details would be included here...]

---
Technical Report Generated by NewsVerify Pro Backend
Backend Analysis ID: ${lastAnalysisData.analysis_id || 'NV-TECH-' + Date.now()}`;
                    break;
                    
                case 'compliance':
                    fileName = `NewsVerify_Backend_Compliance_${timestamp.replace(/\//g, '-')}.txt`;
                    reportContent = `
NEWSVERIFY PRO - BACKEND COMPLIANCE & AUDIT REPORT
===================================================

Generated: ${analysisTime}
Classification: BACKEND INTEGRATED ANALYSIS
Processing Status: ${lastAnalysisData.status?.toUpperCase() || 'COMPLETED'}
Risk Level: ${lastAnalysisData.final_scoring?.risk_assessment?.toUpperCase() || 'MODERATE'}

[Full compliance details would be included here...]

---
OFFICIAL BACKEND COMPLIANCE CERTIFICATION
NewsVerify Pro Backend Integration Platform
Certification ID: ${lastAnalysisData.analysis_id || 'NV-BACKEND-' + Date.now()}`;
                    break;
            }
            
            const blob = new Blob([reportContent], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = fileName;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            
            showReportGeneratedNotification(reportType);
        }

        function showReportGeneratedNotification(reportType) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: linear-gradient(135deg, #10b981, #059669);
                color: white;
                padding: 15px 25px;
                border-radius: 10px;
                box-shadow: 0 10px 30px rgba(16, 185, 129, 0.3);
                z-index: 1000;
                font-weight: 600;
                animation: slideIn 0.3s ease;
            `;
            
            const reportNames = {
                'executive': 'Backend Executive Summary',
                'detailed': 'Backend Technical Report',
                'compliance': 'Backend Compliance Report'
            };
            
            notification.innerHTML = `
                <i class="fas fa-check-circle" style="margin-right: 8px;"></i>
                ${reportNames[reportType]} Generated Successfully!
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }
    </script>
</body>
</html>20px; margin-bottom: 25px;">
                            <div style="text-align: center; padding: 20px; background: rgba(102, 126, 234, 0.1); border-radius: 15px;">
                                <div style="font-size: 2rem; font-weight: 900; color: #667eea; margin-bottom: 5px;">${Math.abs(biasScore)}</div>
                                <div style="font-weight: 600; color: #4a5568;">Bias Intensity</div>
                            </div>
                            <div style="text-align: center; padding: 20px; background: rgba(102, 126, 234, 0.1); border-radius: 15px;">
                                <div style="font-size: 1.5rem; font-weight: 900; color: #764ba2; margin-bottom: 5px;">${biasDirection}</div>
                                <div style="font-weight: 600; color: #4a5568;">Political Lean</div>
                            </div>
                            <div style="text-align: center; padding: 20px; background: rgba(102, 126, 234, 0.1); border-radius: 15px;">
                                <div style="font-size: 2rem; font-weight: 900; color: #10b981; margin-bottom: 5px;">${biasConfidence}%</div>
                                <div style="font-weight: 600; color: #4a5568;">Confidence</div>
                            </div>
                        </div>
                        <div class="detailed-explanation">
                            <p><strong>Backend Bias Assessment:</strong> ${biasExplanation}</p>
                            <p><strong>Objectivity Score:</strong> ${100 - Math.abs(biasScore)}/100 (Higher is more objective)</p>
                        </div>
                    </div>
                </div>
            `;
        }

        function generateSourceAnalysisSection(data) {
            const sourceData = data.source_analysis || {};
            const sourceCredibility = sourceData.source_credibility || 70;
            const editorialQuality = sourceData.editorial_quality || 75;
            const professionalStandards = sourceData.professional_standards || 70;
            
            return `
                <div class="expandable-section">
                    <div class="section-header" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; padding: 20px; cursor: pointer;" onclick="toggleSection('source')">
                        <h3 style="margin: 0; display: flex; align-items: center; justify-content: space-between;">
                            <span><i class="fas fa-shield-check"></i> Source Analysis (Backend)</span>
                            <span id="source-toggle" style="font-size: 1.2rem;">‚ñº</span>
                        </h3>
                    </div>
                    <div class="section-content" id="source-content" style="padding: 30px; display: none;">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap:
