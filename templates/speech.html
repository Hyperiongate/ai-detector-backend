{% extends "base.html" %}

{% block title %}Speech Fact-Checker - Facts & Fakes AI{% endblock %}
{% block description %}Advanced AI-powered speech analysis and fact-checking. Analyze political speeches, podcasts, and YouTube videos for misinformation.{% endblock %}
{% block keywords %}speech fact checking, political speech analysis, podcast verification, YouTube fact check, audio analysis AI{% endblock %}

{% block content %}
<div class="speech-analyzer-container">
    <!-- Beta Banner -->
    {% include 'partials/speech-beta-banner.html' %}
    
    <!-- Main Content -->
    <div class="analyzer-content">
        <div class="analyzer-header">
            <h1>Speech Fact-Checker</h1>
            <p class="header-subtitle">Analyze speeches, podcasts, and videos with advanced AI</p>
        </div>

        <!-- Input Section -->
        <div class="input-section">
            <div class="input-tabs">
                <button class="tab-button active" onclick="window.switchSpeechInputType('file')">
                    <i class="fas fa-upload"></i> Upload File
                </button>
                <button class="tab-button" onclick="window.switchSpeechInputType('youtube')">
                    <i class="fab fa-youtube"></i> YouTube URL
                </button>
            </div>

            <!-- File Upload -->
            <div id="fileInput" class="input-content active">
                <div class="upload-area" id="uploadArea">
                    <i class="fas fa-cloud-upload-alt upload-icon"></i>
                    <h3>Drop your audio or video file here</h3>
                    <p>or click to browse</p>
                    <input type="file" id="speechFile" accept="audio/*,video/*" style="display: none;">
                    <div class="supported-formats">
                        Supported: MP3, WAV, M4A, MP4, AVI, MOV (max 500MB)
                    </div>
                </div>
                <div id="fileInfo" class="file-info" style="display: none;">
                    <i class="fas fa-file-audio file-icon"></i>
                    <div class="file-details">
                        <span class="file-name"></span>
                        <span class="file-size"></span>
                    </div>
                    <button class="remove-file" onclick="window.removeSpeechFile()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>

            <!-- YouTube Input -->
            <div id="youtubeInput" class="input-content">
                <div class="youtube-input-wrapper">
                    <i class="fab fa-youtube youtube-icon"></i>
                    <input type="text" id="youtubeUrl" placeholder="https://www.youtube.com/watch?v=..." 
                           class="youtube-input">
                </div>
                <div class="youtube-preview" id="youtubePreview" style="display: none;">
                    <img id="youtubeThumbnail" alt="Video thumbnail">
                    <div class="preview-info">
                        <h4 id="youtubeTitle"></h4>
                        <p id="youtubeChannel"></p>
                    </div>
                </div>
            </div>

            <!-- Analyze Button -->
            <div class="analyze-section">
                <button id="analyzeSpeechBtn" class="analyze-button" onclick="window.analyzeSpeech()">
                    <i class="fas fa-microscope"></i>
                    <span>Analyze Speech</span>
                </button>
                <div class="tier-indicator">
                    <span class="tier-badge pro">PRO</span>
                    <span class="tier-text">Full Analysis Available</span>
                </div>
            </div>
        </div>

        <!-- Loading Animation -->
        <div id="loadingAnimation" class="loading-container" style="display: none;">
            <div class="loading-content">
                <div class="loading-spinner">
                    <div class="spinner-ring"></div>
                    <div class="spinner-ring"></div>
                    <div class="spinner-ring"></div>
                </div>
                <h3 class="loading-title">Analyzing Speech</h3>
                <div class="loading-progress">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <div class="progress-text" id="progressText">Initializing...</div>
                </div>
                <div class="loading-steps">
                    <div class="step" id="step1">
                        <i class="fas fa-microphone"></i>
                        <span>Transcribing Audio</span>
                    </div>
                    <div class="step" id="step2">
                        <i class="fas fa-quote-right"></i>
                        <span>Extracting Claims</span>
                    </div>
                    <div class="step" id="step3">
                        <i class="fas fa-search"></i>
                        <span>Fact-Checking Claims</span>
                    </div>
                    <div class="step" id="step4">
                        <i class="fas fa-user-check"></i>
                        <span>Analyzing Speaker</span>
                    </div>
                    <div class="step" id="step5">
                        <i class="fas fa-brain"></i>
                        <span>Detecting Manipulation</span>
                    </div>
                    <div class="step" id="step6">
                        <i class="fas fa-file-alt"></i>
                        <span>Finalizing Report</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Results Section -->
        <div id="resultsSection" class="results-section" style="display: none;">
            <!-- Results will be dynamically inserted here -->
        </div>

        <!-- Error Display -->
        <div id="errorDisplay" class="error-display" style="display: none;">
            <i class="fas fa-exclamation-triangle"></i>
            <h3>Analysis Error</h3>
            <p id="errorMessage"></p>
            <button onclick="window.resetSpeechAnalysis()" class="try-again-btn">
                <i class="fas fa-redo"></i> Try Again
            </button>
        </div>
    </div>

    <!-- Info Sections -->
    {% include 'partials/speech-info-sections.html' %}
</div>

<!-- Modals -->
{% include 'partials/speech-modals.html' %}
{% endblock %}

{% block styles %}
<style>
    /* Include all the Speech Analysis specific styles here */
    /* This is a placeholder - the actual styles should be comprehensive */
    .speech-analyzer-container {
        min-height: 100vh;
        background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        padding: 20px;
    }
    
    /* Add all other necessary styles for the speech analyzer */
</style>
{% endblock %}

{% block scripts %}
<!-- Speech Analysis Modular Scripts -->
<script src="/static/js/speech-helpers.js"></script>
<script src="/static/js/speech-ui.js"></script>
<script src="/static/js/speech-results.js"></script>
<script src="/static/js/speech-analysis.js"></script>
<script src="/static/js/speech-main.js"></script>

<!-- Initialize Speech Analyzer -->
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Initialize the speech analyzer when page loads
        if (window.SpeechApp && window.SpeechApp.main) {
            window.SpeechApp.main.initialize();
        }
    });
</script>
{% endblock %}
